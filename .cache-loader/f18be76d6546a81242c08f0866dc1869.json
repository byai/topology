{"remainingRequest":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js??ref--6-oneOf-1-1!/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js??ref--6-oneOf-1-2!/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js??ref--5-0!/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/node-wrapper/index.tsx","dependencies":[{"path":"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/node-wrapper/index.tsx","mtime":1686036806788},{"path":"/Users/zhangtengjin/Desktop/byai/topology/package.json","mtime":1685951404367},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/cache-loader/dist/cjs.js","mtime":1684841559863},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js","mtime":1684841570187},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js","mtime":1684835071408},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js","mtime":1684841566493}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/node-wrapper/index.tsx\",\n  _this3 = this;\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nimport React from 'react';\nimport { DragSource } from 'react-dnd';\nimport classnames from 'classnames';\nimport AnchorWrapper from '../anchor-wrapper';\nimport { Consumer } from '../context';\nimport { NodeTypes } from '../../declare';\nimport './index.less';\nimport { SelectMode } from '../../utils/selectNodes';\nimport { getRealNodeDom, isMatchKeyValue } from '../../utils';\nimport config from '../../config';\n\n// @ts-ignore\nvar NodeWrapper = /*#__PURE__*/function (_React$Component) {\n  _inherits(NodeWrapper, _React$Component);\n  var _super = _createSuper(NodeWrapper);\n  function NodeWrapper() {\n    var _this;\n    _classCallCheck(this, NodeWrapper);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    /** 锚点自增id */\n    _this.increaseAnchorId = 0;\n    _this.updateNumber = 0;\n    _this.computeStyle = function () {\n      var _this$props = _this.props,\n        data = _this$props.data,\n        isolated = _this$props.isolated;\n      if (!data) {\n        return undefined;\n      }\n      data.position = data.position || {\n        x: 0,\n        y: 0\n      };\n      return {\n        position: 'absolute',\n        left: data.position.x,\n        top: data.position.y,\n        transition: config.transition,\n        zIndex: isolated ? 999 : undefined\n      };\n    };\n    _this.anchorDecorator = function (options) {\n      var _this$props2 = _this.props,\n        id = _this$props2.id,\n        readOnly = _this$props2.readOnly;\n      var anchorId = options.anchorId || (_this.increaseAnchorId += 1);\n      return function (item) {\n        return /*#__PURE__*/React.createElement(AnchorWrapper, {\n          key: \"\".concat(id, \"-\").concat(anchorId),\n          id: \"\".concat(id, \"-\").concat(anchorId),\n          readOnly: readOnly,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 13\n          }\n        }, item);\n      };\n    };\n    _this.impactCheck = function () {\n      var _this$props3 = _this.props,\n        context = _this$props3.context,\n        data = _this$props3.data,\n        id = _this$props3.id;\n      var _ref = context,\n        activeLine = _ref.activeLine,\n        impactNode = _ref.impactNode;\n      if (!activeLine || !data || !id) {\n        return false;\n      }\n      return id === impactNode;\n    };\n    _this.handleClick = function (e) {\n      // 避免一些交互上的冲突,改为mousedown触发\n      var _this$props4 = _this.props,\n        data = _this$props4.data,\n        onSelect = _this$props4.onSelect,\n        closeBoxSelection = _this$props4.closeBoxSelection;\n      closeBoxSelection === null || closeBoxSelection === void 0 ? void 0 : closeBoxSelection();\n      if ((e.ctrlKey || e.metaKey) && e.shiftKey) {\n        onSelect(data, SelectMode.MULTI);\n        return;\n      }\n      if (e.ctrlKey || e.metaKey) {\n        onSelect(data, SelectMode.MUL_NORMAL);\n        return;\n      }\n      if (e.shiftKey && !e.ctrlKey && !e.metaKey) {\n        onSelect(data, SelectMode.BOX_SELECTION);\n        return;\n      }\n      onSelect(data, SelectMode.NORMAL);\n    };\n    _this.handleMouseDown = function (e) {\n      var _this$props5 = _this.props,\n        data = _this$props5.data,\n        onSelect = _this$props5.onSelect,\n        closeBoxSelection = _this$props5.closeBoxSelection;\n      if (e.button === 2) {\n        closeBoxSelection === null || closeBoxSelection === void 0 ? void 0 : closeBoxSelection();\n        e.preventDefault();\n        onSelect(data, SelectMode.RIGHT_NORMAL);\n      }\n      // const { data, onSelect, closeBoxSelection } = this.props;\n      // closeBoxSelection();\n      // if (e.button === 2) {\n      //     e.preventDefault();\n      //     onSelect(data, SelectMode.RIGHT_NORMAL);\n      //     return;\n      // }\n      // if ((e.ctrlKey || e.metaKey) && e.shiftKey) {\n      //     onSelect(data, SelectMode.MULTI);\n      //     return;\n      // }\n      // if (e.ctrlKey || e.metaKey) {\n      //     onSelect(data, SelectMode.MUL_NORMAL);\n      //     return;\n      // }\n      // if (e.shiftKey && !e.ctrlKey && !e.metaKey) {\n      //     onSelect(data, SelectMode.BOX_SELECTION);\n      //     return;\n      // }\n      // if (!isSelect) {\n      //     onSelect(data, SelectMode.NORMAL);\n      // }\n    };\n    _this.handleRightClick = function (e) {\n      e.preventDefault();\n    };\n    /**\n     * set preview Dom width height style\n     */\n    /* eslint-disable */\n    _this.getPreviewNodeStyle = function () {\n      var _this$props6 = _this.props,\n        data = _this$props6.data,\n        scaleNum = _this$props6.scaleNum,\n        id = _this$props6.id,\n        draggingId = _this$props6.draggingId;\n      var realNodeDom = document.getElementById(\"topology-node-\".concat(data && data.id));\n      if (!realNodeDom) return null;\n      var previewNodeWidth = scaleNum * realNodeDom.offsetWidth - 2; // border\n      var previewNodeHeight = scaleNum * realNodeDom.offsetHeight - 2;\n      var previewStyle = {};\n      // 放大模式下拖动中 previewNode 样式处理\n      if (scaleNum > 1 && draggingId === id) {\n        var draggingPreviewNode = document.querySelector(\"div[data-id='\".concat(draggingId, \"']\"));\n        if (!draggingPreviewNode) return null;\n        setTimeout(function () {\n          draggingPreviewNode.style.background = 'transparent';\n          draggingPreviewNode.style.border = 'none';\n        }, 0);\n      }\n      // 连线触发节点或者放大时对未拖动中 previewNode 样式处理\n      if (_this.impactCheck() || scaleNum > 1 && draggingId !== id) {\n        previewStyle = {\n          background: 'transparent',\n          border: 'none'\n        };\n      }\n      return _objectSpread({\n        width: previewNodeWidth,\n        height: previewNodeHeight\n      }, previewStyle);\n    };\n    return _this;\n  }\n  _createClass(NodeWrapper, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextprops) {\n      var nextData = nextprops.data,\n        _nextprops$context = nextprops.context,\n        nextSelectedData = _nextprops$context.selectedData,\n        nextImpactNode = _nextprops$context.impactNode,\n        isReduceRender = nextprops.isReduceRender;\n      var _this$props7 = this.props,\n        data = _this$props7.data,\n        _this$props7$context = _this$props7.context,\n        selectedData = _this$props7$context.selectedData,\n        impactNode = _this$props7$context.impactNode;\n      if (impactNode && impactNode === nextImpactNode) {\n        this.updateNumber += 1;\n      } else {\n        this.updateNumber = 0;\n      }\n      // 避免节点多次无用渲染\n      if (isReduceRender && !impactNode && nextData === data && nextSelectedData === selectedData) {\n        return false;\n      }\n      if (this.updateNumber >= 2) {\n        return false;\n      }\n      return true;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n      var _this$props8 = this.props,\n        connectDragSource = _this$props8.connectDragSource,\n        connectDragPreview = _this$props8.connectDragPreview,\n        children = _this$props8.children,\n        data = _this$props8.data,\n        context = _this$props8.context,\n        id = _this$props8.id,\n        _onMouseEnter = _this$props8.onMouseEnter,\n        _onMouseLeave = _this$props8.onMouseLeave;\n      var selectedData = context.selectedData,\n        activeLine = context.activeLine;\n      var isSelected = selectedData.nodes.find(function (item) {\n        return item.id === data.id;\n      }) !== undefined;\n      return connectDragSource( /*#__PURE__*/React.createElement(\"div\", {\n        id: data ? \"topology-node-\".concat(data.id) : \"\",\n        \"data-combine-id\": data === null || data === void 0 ? void 0 : data.combineId,\n        style: this.computeStyle(),\n        className: \"byai-topology-node-wrapper\",\n        onClick: this.handleClick,\n        onContextMenu: this.handleRightClick,\n        onMouseDown: function onMouseDown(e) {\n          // @ts-ignore\n          _this2.handleMouseDown(e, isSelected);\n        },\n        onMouseEnter: function onMouseEnter() {\n          _onMouseEnter(data);\n        },\n        onMouseLeave: function onMouseLeave() {\n          _onMouseLeave();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }\n      }, connectDragPreview( /*#__PURE__*/React.createElement(\"div\", {\n        \"data-id\": \"\".concat(id),\n        style: this.getPreviewNodeStyle(),\n        className: \"topology-node-preview\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: classnames({\n          \"topology-node-content\": true,\n          \"topology-node-selected\": isSelected,\n          \"topology-node-impact\": activeLine && this.impactCheck()\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 17\n        }\n      }, children({\n        anchorDecorator: this.anchorDecorator\n      }))));\n    }\n  }]);\n  return NodeWrapper;\n}(React.Component);\nvar WithContextNodeWrapper = function WithContextNodeWrapper(props) {\n  return /*#__PURE__*/React.createElement(Consumer, {\n    __self: _this3,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 5\n    }\n  }, function (context) {\n    return /*#__PURE__*/React.createElement(NodeWrapper, Object.assign({}, props, {\n      context: context,\n      __self: _this3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 21\n      }\n    }));\n  });\n};\nexport default DragSource(NodeTypes.NORMAL_NODE, {\n  canDrag: function canDrag(props) {\n    var canDragNode = props.canDrag === false || isMatchKeyValue(props, 'canDrag', false);\n    return canDragNode ? !canDragNode : props.readOnly ? !props.readOnly : !canDragNode;\n  },\n  beginDrag: function beginDrag(props) {\n    var id = props.data ? props.data.id : null;\n    var _props$prevNodeStyle = props.prevNodeStyle,\n      prevNodeStyle = _props$prevNodeStyle === void 0 ? {} : _props$prevNodeStyle,\n      closeBoxSelection = props.closeBoxSelection;\n    closeBoxSelection === null || closeBoxSelection === void 0 ? void 0 : closeBoxSelection();\n    props.setDraggingId(id);\n    // beginDrag 时机 处理预览节点样式问题\n    var draggingPreviewNode = document.querySelector(\"div[data-id='\".concat(id, \"']\"));\n    if (!draggingPreviewNode) return null;\n    var realNodeDom = getRealNodeDom(id);\n    if (!realNodeDom) return null;\n    var distanceX = 0;\n    var distanceY = 0;\n    var source;\n    if (!props.isSelected) {\n      source = props.onSelect(props.data, SelectMode.NORMAL);\n    }\n    var otherRealNodeDomList = (source ? source.nodes : props.selectedNodes).filter(function (item) {\n      return item.id !== id;\n    }).map(function (item) {\n      return getRealNodeDom(item.id);\n    });\n    var allRealNodeDomList = [].concat(_toConsumableArray(otherRealNodeDomList), [realNodeDom]);\n    var width = realNodeDom.offsetWidth;\n    var height = realNodeDom.offsetHeight;\n    if (otherRealNodeDomList.length > 0) {\n      var boxPosition = props.getBoundary(allRealNodeDomList);\n      var _realNodeDom$getBound = realNodeDom.getBoundingClientRect(),\n        x = _realNodeDom$getBound.x,\n        y = _realNodeDom$getBound.y;\n      distanceX = x - boxPosition.minX;\n      distanceY = y - boxPosition.minY;\n      width = boxPosition.maxX - boxPosition.minX;\n      height = boxPosition.maxY - boxPosition.minY;\n    }\n    var previewNodeWidth = width - 2; // border\n    var previewNodeHeight = height - 2;\n    draggingPreviewNode.style.background = prevNodeStyle.background || '#6f6fc7';\n    draggingPreviewNode.style.border = prevNodeStyle.border || '1px dashed #1F8CEC';\n    draggingPreviewNode.style.setProperty('--width', previewNodeWidth + 'px');\n    draggingPreviewNode.style.setProperty('--height', previewNodeHeight + 'px');\n    draggingPreviewNode.style.setProperty('--transformX', \"\".concat(-distanceX, \"px\"));\n    draggingPreviewNode.style.setProperty('--transformY', \"\".concat(-distanceY, \"px\"));\n    // 恢复\n    setTimeout(function () {\n      draggingPreviewNode.style.background = 'transparent';\n      draggingPreviewNode.style.border = 'none';\n    }, 0);\n    return {\n      id: id\n    };\n  },\n  endDrag: function endDrag(props) {\n    props.setDraggingId(null);\n    var id = props.data ? props.data.id : null;\n    props.showBoxSelection && props.showBoxSelection();\n    var draggingPreviewNode = document.querySelector(\"div[data-id='\".concat(id, \"']\"));\n    if (!draggingPreviewNode) return null;\n    draggingPreviewNode.style.setProperty('--width', '100%');\n    draggingPreviewNode.style.setProperty('--height', '100%');\n    draggingPreviewNode.style.setProperty('--transformX', '0px');\n    draggingPreviewNode.style.setProperty('--transformY', '0px');\n  }\n}, function (connect) {\n  return {\n    connectDragSource: connect.dragSource(),\n    connectDragPreview: connect.dragPreview()\n  };\n})(WithContextNodeWrapper);",{"version":3,"names":["React","DragSource","classnames","AnchorWrapper","Consumer","NodeTypes","SelectMode","getRealNodeDom","isMatchKeyValue","config","NodeWrapper","_React$Component","_inherits","_super","_createSuper","_this","_classCallCheck","_len","arguments","length","args","Array","_key","call","apply","concat","increaseAnchorId","updateNumber","computeStyle","_this$props","props","data","isolated","undefined","position","x","y","left","top","transition","zIndex","anchorDecorator","options","_this$props2","id","readOnly","anchorId","item","createElement","key","__self","_assertThisInitialized","__source","fileName","_jsxFileName","lineNumber","columnNumber","impactCheck","_this$props3","context","_ref","activeLine","impactNode","handleClick","e","_this$props4","onSelect","closeBoxSelection","ctrlKey","metaKey","shiftKey","MULTI","MUL_NORMAL","BOX_SELECTION","NORMAL","handleMouseDown","_this$props5","button","preventDefault","RIGHT_NORMAL","handleRightClick","getPreviewNodeStyle","_this$props6","scaleNum","draggingId","realNodeDom","document","getElementById","previewNodeWidth","offsetWidth","previewNodeHeight","offsetHeight","previewStyle","draggingPreviewNode","querySelector","setTimeout","style","background","border","_objectSpread","width","height","_createClass","value","shouldComponentUpdate","nextprops","nextData","_nextprops$context","nextSelectedData","selectedData","nextImpactNode","isReduceRender","_this$props7","_this$props7$context","render","_this2","_this$props8","connectDragSource","connectDragPreview","children","onMouseEnter","onMouseLeave","isSelected","nodes","find","combineId","className","onClick","onContextMenu","onMouseDown","Component","WithContextNodeWrapper","_this3","Object","assign","NORMAL_NODE","canDrag","canDragNode","beginDrag","_props$prevNodeStyle","prevNodeStyle","setDraggingId","distanceX","distanceY","source","otherRealNodeDomList","selectedNodes","filter","map","allRealNodeDomList","_toConsumableArray","boxPosition","getBoundary","_realNodeDom$getBound","getBoundingClientRect","minX","minY","maxX","maxY","setProperty","endDrag","showBoxSelection","connect","dragSource","dragPreview"],"sources":["/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/node-wrapper/index.tsx"],"sourcesContent":["import React from 'react';\nimport { DragSource, DragElementWrapper } from 'react-dnd';\nimport classnames from 'classnames';\nimport AnchorWrapper from '../anchor-wrapper';\nimport { Consumer } from '../context';\nimport {\n    NodeTypes,\n    ITopologyContext,\n    ITopologyNode,\n    IWrapperOptions,\n} from '../../declare';\nimport './index.less';\nimport { SelectMode } from '../../utils/selectNodes';\nimport {\n    getRealNodeDom,\n    isMatchKeyValue\n} from '../../utils';\nimport config from '../../config';\n\n// @ts-ignore\nexport interface INodeWrapperProps {\n    id?: string;\n    data?: ITopologyNode;\n    scaleNum?: number;\n    draggingId?: string;\n    context?: ITopologyContext;\n    setDraggingId?: (id: string) => void;\n    onSelect: (node: ITopologyNode, mode: SelectMode) => ITopologyNode;\n    children: (wrapperOptions: IWrapperOptions) => React.ReactNode;\n    onMouseEnter?: (node: ITopologyNode) => void;\n    onMouseLeave?: () => void;\n    readOnly?: boolean;\n    isReduceRender?: boolean;\n    isSelected?: boolean;\n    getBoundary: (elements: Element[]) => {\n        minX: number;\n        minY: number;\n        maxX: number;\n        maxY: number;\n    };\n    closeBoxSelection: () => void;\n    showBoxSelection?: () => void;\n    selectedNodes?: ITopologyNode[];\n    combineId?: string;\n    prevNodeStyle?: {\n        // 暂时支持这两个属性\n        border?: string;\n        background?: string;\n    };\n    canDrag?: boolean;\n    filterOverlap?: boolean;\n    /** 是否孤立节点 */\n    isolated?: boolean;\n    connectDragSource?: DragElementWrapper<React.ReactNode>;\n    connectDragPreview?: DragElementWrapper<React.ReactNode>;\n}\n\nclass NodeWrapper extends React.Component<INodeWrapperProps> {\n    /** 锚点自增id */\n    private increaseAnchorId: number = 0;\n\n    private updateNumber: number = 0;\n\n    shouldComponentUpdate(nextprops) {\n        const { data: nextData, context: { selectedData: nextSelectedData, impactNode: nextImpactNode }, isReduceRender } = nextprops;\n        const { data, context: { selectedData, impactNode } } = this.props;\n\n        if (impactNode && impactNode === nextImpactNode) {\n            this.updateNumber += 1;\n        } else {\n            this.updateNumber = 0;\n        }\n        // 避免节点多次无用渲染\n        if (isReduceRender && !impactNode && nextData === data && nextSelectedData === selectedData) {\n            return false;\n        }\n        if (this.updateNumber >= 2) {\n            return false;\n        }\n\n        return true;\n    }\n\n    computeStyle = () => {\n        const { data, isolated } = this.props;\n        if (!data) {\n            return undefined;\n        }\n        data.position = data.position || { x: 0, y: 0 };\n        return {\n            position: 'absolute',\n            left: data.position.x,\n            top: data.position.y,\n            transition: config.transition,\n            zIndex: isolated ? 999 : undefined,\n        } as React.CSSProperties;\n    };\n\n    anchorDecorator = (options: { anchorId?: string }) => {\n        const { id, readOnly } = this.props;\n        const anchorId = options.anchorId || (this.increaseAnchorId += 1);\n        return (item: React.ReactNode) => (\n            <AnchorWrapper\n                key={`${id}-${anchorId}`}\n                id={`${id}-${anchorId}`}\n                readOnly={readOnly}\n            >\n                {item}\n            </AnchorWrapper>\n        );\n    };\n\n    impactCheck = () => {\n        const { context, data, id } = this.props;\n        const { activeLine, impactNode } = context as ITopologyContext;\n        if (!activeLine || !data || !id) {\n            return false;\n        }\n        return id === impactNode;\n    };\n\n    handleClick = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        // 避免一些交互上的冲突,改为mousedown触发\n        const { data, onSelect, closeBoxSelection } = this.props;\n        closeBoxSelection?.();\n\n        if ((e.ctrlKey || e.metaKey) && e.shiftKey) {\n            onSelect(data, SelectMode.MULTI);\n            return;\n        }\n        if (e.ctrlKey || e.metaKey) {\n            onSelect(data, SelectMode.MUL_NORMAL);\n            return;\n        }\n        if (e.shiftKey && !e.ctrlKey && !e.metaKey) {\n            onSelect(data, SelectMode.BOX_SELECTION);\n            return;\n        }\n        onSelect(data, SelectMode.NORMAL);\n    };\n\n    handleMouseDown = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        const { data, onSelect, closeBoxSelection } = this.props;\n\n        if (e.button === 2) {\n            closeBoxSelection?.();\n            e.preventDefault();\n            onSelect(data, SelectMode.RIGHT_NORMAL);\n        }\n        // const { data, onSelect, closeBoxSelection } = this.props;\n        // closeBoxSelection();\n        // if (e.button === 2) {\n        //     e.preventDefault();\n        //     onSelect(data, SelectMode.RIGHT_NORMAL);\n        //     return;\n        // }\n        // if ((e.ctrlKey || e.metaKey) && e.shiftKey) {\n        //     onSelect(data, SelectMode.MULTI);\n        //     return;\n        // }\n        // if (e.ctrlKey || e.metaKey) {\n        //     onSelect(data, SelectMode.MUL_NORMAL);\n        //     return;\n        // }\n        // if (e.shiftKey && !e.ctrlKey && !e.metaKey) {\n        //     onSelect(data, SelectMode.BOX_SELECTION);\n        //     return;\n        // }\n        // if (!isSelect) {\n        //     onSelect(data, SelectMode.NORMAL);\n        // }\n    };\n\n    handleRightClick = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n        e.preventDefault();\n    };\n\n    /**\n     * set preview Dom width height style\n     */\n    /* eslint-disable */\n    getPreviewNodeStyle = () => {\n        const { data, scaleNum, id, draggingId } = this.props;\n        const realNodeDom = document.getElementById(`topology-node-${data && data.id}`);\n        if (!realNodeDom) return null\n        const previewNodeWidth = scaleNum * realNodeDom.offsetWidth - 2; // border\n        const previewNodeHeight = scaleNum * realNodeDom.offsetHeight - 2;\n        let previewStyle = {};\n        // 放大模式下拖动中 previewNode 样式处理\n        if (scaleNum > 1 && draggingId === id) {\n            const draggingPreviewNode: HTMLElement = document.querySelector(`div[data-id='${draggingId}']`);\n            if (!draggingPreviewNode) return null;\n            setTimeout(() => {\n                draggingPreviewNode.style.background = 'transparent';\n                draggingPreviewNode.style.border = 'none';\n            }, 0);\n        }\n        // 连线触发节点或者放大时对未拖动中 previewNode 样式处理\n        if(this.impactCheck() || (scaleNum > 1 && draggingId !== id)) {\n            previewStyle = {\n                background: 'transparent',\n                border: 'none'\n            }\n        }\n        return {\n            width: previewNodeWidth,\n            height: previewNodeHeight,\n            ...previewStyle\n        };\n    };\n\n\n    render() {\n        const {\n            connectDragSource,\n            connectDragPreview,\n            children,\n            data,\n            context,\n            id,\n            onMouseEnter,\n            onMouseLeave\n        } = this.props;\n        const { selectedData, activeLine } = context;\n        const isSelected =\n            selectedData.nodes.find(item => item.id === data.id) !== undefined;\n        return connectDragSource(\n            <div\n                id={data ? `topology-node-${data.id}` : \"\"}\n                data-combine-id={data?.combineId}\n                style={this.computeStyle()}\n                className=\"byai-topology-node-wrapper\"\n                onClick={this.handleClick}\n                onContextMenu={this.handleRightClick}\n                onMouseDown={(e) => {\n                    // @ts-ignore\n                    this.handleMouseDown(e, isSelected);\n                }}\n                onMouseEnter={() => { onMouseEnter(data) }}\n                onMouseLeave={() => { onMouseLeave() }}>\n                {connectDragPreview(\n                    <div\n                        data-id={`${id}`}\n                        style={this.getPreviewNodeStyle()}\n                        className=\"topology-node-preview\"\n                    />\n                )}\n                <div\n                    className={classnames({\n                        \"topology-node-content\": true,\n                        \"topology-node-selected\": isSelected,\n                        \"topology-node-impact\": activeLine && this.impactCheck()\n                    })}\n                >\n                    {children({ anchorDecorator: this.anchorDecorator })}\n                </div>\n            </div>\n        );\n    }\n}\n\nconst WithContextNodeWrapper = (props: INodeWrapperProps) => (\n    <Consumer>\n        {context => <NodeWrapper {...props} context={context} />}\n    </Consumer>\n);\n\nexport default DragSource(\n    NodeTypes.NORMAL_NODE,\n    {\n        canDrag(props: INodeWrapperProps) {\n            const canDragNode = props.canDrag === false || isMatchKeyValue(props, 'canDrag', false);\n            return canDragNode ? !canDragNode : (props.readOnly ? !props.readOnly: !canDragNode);\n        },\n        beginDrag(props: INodeWrapperProps) {\n            const id = props.data ? props.data.id : null;\n            const { prevNodeStyle = {}, closeBoxSelection } = props;\n            closeBoxSelection?.();\n            props.setDraggingId(id);\n            // beginDrag 时机 处理预览节点样式问题\n            const draggingPreviewNode: HTMLElement = document.querySelector(`div[data-id='${id}']`);\n            if (!draggingPreviewNode) return null;\n            const realNodeDom = getRealNodeDom(id);\n            if (!realNodeDom) return null;\n            let distanceX = 0;\n            let distanceY = 0;\n            let source: ITopologyNode;\n            if (!props.isSelected) {\n                source = props.onSelect(props.data, SelectMode.NORMAL);\n            }\n            const otherRealNodeDomList = (source ? source.nodes: props.selectedNodes).filter(item => item.id !== id).map(item => getRealNodeDom(item.id));\n            const allRealNodeDomList = [...otherRealNodeDomList, realNodeDom];\n            let width = realNodeDom.offsetWidth;\n            let height = realNodeDom.offsetHeight\n            if (otherRealNodeDomList.length > 0) {\n                const boxPosition = props.getBoundary(allRealNodeDomList);\n                const { x , y } = realNodeDom.getBoundingClientRect();\n                distanceX = x - boxPosition.minX;\n                distanceY = y - boxPosition.minY;\n                width = boxPosition.maxX - boxPosition.minX;\n                height = boxPosition.maxY - boxPosition.minY;\n            }\n            const previewNodeWidth =  width - 2; // border\n            const previewNodeHeight = height - 2;\n            draggingPreviewNode.style.background = prevNodeStyle.background || '#6f6fc7';\n            draggingPreviewNode.style.border = prevNodeStyle.border || '1px dashed #1F8CEC';\n            draggingPreviewNode.style.setProperty('--width', previewNodeWidth + 'px');\n            draggingPreviewNode.style.setProperty('--height', previewNodeHeight + 'px');\n            draggingPreviewNode.style.setProperty('--transformX', `${-distanceX}px`);\n            draggingPreviewNode.style.setProperty('--transformY', `${-distanceY}px`);\n            // 恢复\n            setTimeout(() => {\n                draggingPreviewNode.style.background = 'transparent';\n                draggingPreviewNode.style.border = 'none';\n            }, 0);\n            return { id };\n        },\n        endDrag(props: INodeWrapperProps) {\n            props.setDraggingId(null);\n            const id = props.data ? props.data.id : null;\n            props.showBoxSelection && props.showBoxSelection();\n            const draggingPreviewNode: HTMLElement = document.querySelector(`div[data-id='${id}']`);\n            if (!draggingPreviewNode) return null;\n            draggingPreviewNode.style.setProperty('--width', '100%');\n            draggingPreviewNode.style.setProperty('--height', '100%');\n            draggingPreviewNode.style.setProperty('--transformX', '0px');\n            draggingPreviewNode.style.setProperty('--transformY', '0px');\n        },\n    },\n    connect => ({\n        connectDragSource: connect.dragSource(),\n        connectDragPreview: connect.dragPreview(),\n    }),\n)(WithContextNodeWrapper);\n"],"mappings":"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"}]}