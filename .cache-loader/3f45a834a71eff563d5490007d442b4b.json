{"remainingRequest":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js??ref--6-oneOf-1-1!/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js??ref--6-oneOf-1-2!/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js??ref--5-0!/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/topology/index.tsx","dependencies":[{"path":"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/topology/index.tsx","mtime":1686036806790},{"path":"/Users/zhangtengjin/Desktop/byai/topology/package.json","mtime":1685951404367},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/cache-loader/dist/cjs.js","mtime":1684841559863},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js","mtime":1684841570187},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js","mtime":1684835071408},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js","mtime":1684841566493}],"contextDependencies":[],"result":["import _typeof from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/typeof\";\nimport _asyncToGenerator from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nvar _jsxFileName = \"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/topology/index.tsx\";\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function (_e) { function e(_x5) { return _e.apply(this, arguments); } e.toString = function () { return _e.toString(); }; return e; }(function (e) { throw e; }), f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function (_e2) { function e(_x6) { return _e2.apply(this, arguments); } e.toString = function () { return _e2.toString(); }; return e; }(function (e) { didErr = true; err = e; }), f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i]; return arr2; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var methodName = context.method, method = delegate.iterator[methodName]; if (undefined === method) return context.delegate = null, \"throw\" === methodName && delegate.iterator.return && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method) || \"return\" !== methodName && (context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a '\" + methodName + \"' method\")), ContinueSentinel; var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) keys.push(key); return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, catch: function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n/* eslint-disable */\nimport React from 'react';\nimport { renderToStaticMarkup } from 'react-dom/server';\nimport { DropTarget } from 'react-dnd';\nimport _ from 'lodash';\nimport classnames from 'classnames';\nimport html2canvas from 'html2canvas';\nimport selectNodes, { getLinesFromNode, SelectMode } from '../../utils/selectNodes';\nimport { Provider, defaultContext } from '../context';\nimport NodeWrapper from '../node-wrapper';\nimport Line from '../line';\nimport LineText from '../line/lineText';\nimport { KeyCode, NodeTypes\n\n// eslint-disable-next-line import/named\n, ChangeType, LineEditType } from '../../declare';\nimport { computeCanvasPo, impactCheck, computeAnchorPo, computeNodeInputPo, computeContentCenter, computeContentPostionY, createHashFromObjectArray, getNodeSize, shouldAutoLayout, getRealNodeDom, getMaxAndMinNodeId, isInViewPort, computeMaxAndMin, isMatchKeyValue } from '../../utils';\n// import layoutCalculation from '../../utils/layoutCalculation';\nimport computeLayout from '../../utils/computeLayout';\nimport deleteSelectedData from '../../utils/deleteSelectedData';\nimport config from '../../config';\nimport './index.less';\nimport Selection from '../selection';\nimport SnapLine from '../snapline';\nvar MAX_SCALE = 2;\nvar MIN_SCALE = 0.1;\nvar DRAG_CLASS = 'topology-canvas-drag';\nvar initialTopologyState = {\n  context: defaultContext,\n  scaleNum: 1,\n  draggingId: null,\n  loading: false,\n  alignmentLines: {}\n};\nvar Topology = /*#__PURE__*/function (_React$Component) {\n  _inherits(Topology, _React$Component);\n  var _super = _createSuper(Topology);\n  function Topology(_props) {\n    var _this;\n    _classCallCheck(this, Topology);\n    _this = _super.call(this, _props);\n    _this.$topology = void 0;\n    _this.$wrapper = void 0;\n    _this.$canvas = void 0;\n    _this.nodeSizeCache = {};\n    _this.state = initialTopologyState;\n    _this.dragCanvasPo = null;\n    _this.shouldAutoLayout = false;\n    _this.onChange = function (data, type) {\n      var onChange = _this.props.onChange;\n      if (!onChange) {\n        return;\n      }\n      onChange(data, type);\n    };\n    _this.defaultScaleNum = 1;\n    _this.scaleNum = 1;\n    _this.clearSelectedWhenClickOutside = function (e) {\n      if (_this.$topology.contains(e.target)) {\n        return;\n      }\n      _this.clearSelectData();\n    };\n    _this.zoomIn = function () {\n      _this.setState(function (prevState) {\n        var scaleNum = prevState.scaleNum > MIN_SCALE + 0.1 ? prevState.scaleNum - 0.1 : MIN_SCALE;\n        _this.scaleNum = scaleNum;\n        return {\n          scaleNum: scaleNum\n        };\n      });\n      _this.setDraggingId(null);\n    };\n    _this.zoomOut = function () {\n      _this.setState(function (prevState) {\n        var scaleNum = prevState.scaleNum < MAX_SCALE ? prevState.scaleNum + 0.1 : MAX_SCALE;\n        _this.scaleNum = scaleNum;\n        return {\n          scaleNum: scaleNum\n        };\n      });\n      _this.setDraggingId(null);\n    };\n    _this.resetScale = function () {\n      _this.setState(function () {\n        var _assertThisInitialize = _assertThisInitialized(_this),\n          defaultScaleNum = _assertThisInitialize.defaultScaleNum;\n        _this.scaleNum = defaultScaleNum;\n        return {\n          scaleNum: defaultScaleNum\n        };\n      });\n      _this.setDraggingId(null);\n    };\n    _this.scrollCanvasToCenter = function () {\n      if (!_this.$wrapper || !_this.$canvas) {\n        return;\n      }\n      _this.resetScale();\n      var canvasSize = getNodeSize(_this.$canvas);\n      var wrapperSize = getNodeSize(_this.$wrapper);\n      var contentCenter = computeContentCenter(_this.props.data.nodes);\n      var canvasCenter = {\n        x: canvasSize.width / 2,\n        y: canvasSize.height / 2\n      };\n      var defaultScrollTop = (canvasSize.height - wrapperSize.height) / 2;\n      var defaultScrollLeft = (canvasSize.width - wrapperSize.width) / 2;\n      if (!contentCenter) {\n        _this.$wrapper.scrollTop = defaultScrollTop;\n        _this.$wrapper.scrollLeft = defaultScrollLeft;\n      } else {\n        _this.$wrapper.scrollTop = defaultScrollTop + (contentCenter.y - canvasCenter.y);\n        _this.$wrapper.scrollLeft = defaultScrollLeft + (contentCenter.x - canvasCenter.x);\n      }\n    };\n    /**\n     *  定位至画布顶部距离\n     * @returns\n     */\n    _this.scrollCanvasToPositionY = function () {\n      if (!_this.$wrapper || !_this.$canvas) {\n        return;\n      }\n      _this.resetScale();\n      var canvasSize = getNodeSize(_this.$canvas);\n      var wrapperSize = getNodeSize(_this.$wrapper);\n      var contentPosition = computeContentPostionY(_this.props.data.nodes);\n      var canvasCenter = {\n        x: canvasSize.width / 2,\n        y: canvasSize.height / 2\n      };\n      var defaultScrollTop = (canvasSize.height - wrapperSize.height) / 2;\n      var defaultScrollLeft = (canvasSize.width - wrapperSize.width) / 2;\n      if (!contentPosition) {\n        _this.$wrapper.scrollTop = defaultScrollTop;\n        _this.$wrapper.scrollLeft = defaultScrollLeft;\n      } else {\n        _this.$wrapper.scrollTop = contentPosition.y - _this.props.customPostionHeight;\n        _this.$wrapper.scrollLeft = defaultScrollLeft + (contentPosition.x - canvasCenter.x);\n      }\n    };\n    _this.cacheNodeSize = function () {\n      var nodes = _this.props.data.nodes; // 已节点id为键值，缓存节点的宽和高，避免碰撞检测时频繁操作DOM\n      _this.nodeSizeCache = nodes.reduce(function (pre, cur) {\n        return _objectSpread({}, pre, _defineProperty({}, cur.id, getNodeSize(cur.id)));\n      }, {});\n    };\n    _this.impactCheck = function (endPo, startPo, id) {\n      var _this$props$data = _this.props.data,\n        nodes = _this$props$data.nodes,\n        lines = _this$props$data.lines;\n      var impactNode = nodes.find(function (item) {\n        if (!_this.nodeSizeCache[item.id]) {\n          _this.nodeSizeCache[item.id] = getNodeSize(item.id);\n        }\n        return _this.nodeSizeCache[item.id] && impactCheck(endPo, _this.nodeSizeCache[item.id], item.position);\n      });\n      // 起点和终点是同一节点\n      if (impactNode && impactCheck(startPo, _this.nodeSizeCache[impactNode.id], impactNode.position)) {\n        return null;\n      }\n\n      // 线已存在情况下\n      var hasExistSameLine = impactNode && lines.find(function (item) {\n        return item.start === id && item.end === impactNode.id;\n      });\n      if (hasExistSameLine) return null;\n\n      // 节点不可被连接\n      if (impactNode && impactNode.canConnect === false) return null;\n      return impactNode ? impactNode.id : null;\n    };\n    _this.clearSelectData = function () {\n      var _this$state$context$s = _this.state.context.selectedData,\n        nodes = _this$state$context$s.nodes,\n        lines = _this$state$context$s.lines;\n      if ((nodes === null || nodes === void 0 ? void 0 : nodes.length) === 0 && (lines === null || lines === void 0 ? void 0 : lines.length) === 0) return;\n      _this.setContext({\n        selectedData: {\n          nodes: [],\n          lines: []\n        }\n      }, function () {\n        var onSelect = _this.props.onSelect;\n        if (onSelect) {\n          onSelect(_this.state.context.selectedData);\n        }\n      });\n    };\n    _this.autoLayout = function () {\n      var _this$props = _this.props,\n        data = _this$props.data,\n        sortChildren = _this$props.sortChildren;\n      _this.resetScale();\n      _this.onChange(_objectSpread({}, data, {\n        nodes: computeLayout(data, {\n          sortChildren: sortChildren\n        })\n      }), ChangeType.LAYOUT);\n      _this.clearSelectData(); // refresh\n    };\n    _this.initDomEvents = function () {\n      window.addEventListener(\"keydown\", _this.handleKeydown);\n    };\n    _this.removeDomEvents = function () {\n      window.removeEventListener(\"keydown\", _this.handleKeydown);\n    };\n    _this.getBoundary = function (elements) {\n      var minX = Infinity;\n      var minY = Infinity;\n      var maxX = -Infinity;\n      var maxY = -Infinity;\n      elements.forEach(function (e) {\n        var _e$getBoundingClientR = e.getBoundingClientRect(),\n          x = _e$getBoundingClientR.x,\n          y = _e$getBoundingClientR.y,\n          height = _e$getBoundingClientR.height,\n          width = _e$getBoundingClientR.width;\n        minX = Math.min(x, minX);\n        minY = Math.min(y, minY);\n        maxX = Math.max(x + width, maxX);\n        maxY = Math.max(y + height, maxY);\n      });\n      return {\n        minX: minX,\n        minY: minY,\n        maxX: maxX,\n        maxY: maxY\n      };\n    };\n    _this.getRealNodeDomByIdList = function (ids) {\n      return ids.map(getRealNodeDom);\n    };\n    _this.generateBoxByRealSelectedNodeDom = function (elements) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 3;\n      var boundary = _this.getBoundary(elements || _this.state.realDragNodeDomList);\n      setTimeout(function () {\n        _this.generateBoxByBoundary(boundary, offset);\n      }, 0);\n    };\n    _this.generateBoxByBoundary = function (boundary) {\n      var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 3;\n      var minX = boundary.minX,\n        minY = boundary.minY,\n        maxX = boundary.maxX,\n        maxY = boundary.maxY;\n      _this.setState({\n        boxSelectionInfo: {\n          initX: minX - offset,\n          initY: minY - offset,\n          x: maxX + offset,\n          y: maxY + offset,\n          status: 'static'\n        }\n      });\n    };\n    _this.generateBoxBySelectedNode = function (nodes, offset) {\n      nodes = nodes || _this.state.context.selectedData.nodes;\n      offset = offset || 3;\n      if (nodes.length === 0) {\n        _this.setState({\n          boxSelectionInfo: null\n        });\n        return;\n      }\n      _this.generateBoxByRealSelectedNodeDom(_this.getRealNodeDomByIdList(nodes.map(function (n) {\n        return n.id;\n      })), offset);\n    };\n    _this.handleKeydown = function (e) {\n      // eslint-disable-next-line\n      var _ref = e.target,\n        _ref$classList = _ref.classList,\n        classList = _ref$classList === void 0 ? [] : _ref$classList; // 左侧的搜索输入框回删事件不触发话术更改\n      if (classList[0] === \"ant-input\") {\n        return;\n      }\n      switch (e.keyCode) {\n        case KeyCode.BACKSPACE:\n        case KeyCode.DELETE:\n          _this.deleteItem();\n          break;\n        default:\n          break;\n      }\n    };\n    _this.deleteItem = function () {\n      var data = _this.props.data;\n      var selectedData = _this.state.context.selectedData;\n      _this.onChange(deleteSelectedData(data, selectedData), ChangeType.DELETE);\n      _this.closeBoxSelection();\n    };\n    _this.setDraggingId = function (id) {\n      _this.setState({\n        draggingId: id\n      });\n    };\n    _this.setContext = function (values, callback) {\n      var context = _this.state.context;\n      _this.setState({\n        context: _objectSpread({}, context, values)\n      }, function () {\n        if (callback) {\n          callback();\n        }\n      });\n    };\n    _this.refreshSelectNode = function (data) {\n      var selectedData = _this.state.context.selectedData;\n      var onSelect = _this.props.onSelect;\n      var idSet = new Set(selectedData.nodes.map(function (item) {\n        return item.id;\n      }));\n      var newNodeInfo = data.nodes.filter(function (n) {\n        return idSet.has(n.id);\n      });\n      var newInfo = {\n        nodes: newNodeInfo,\n        lines: selectedData.lines\n      };\n      _this.setContext({\n        selectedData: newInfo\n      }, function () {\n        if (onSelect) {\n          onSelect(newInfo);\n        }\n      });\n    };\n    _this.selectNode = function (node, mode) {\n      var _this$props2 = _this.props,\n        data = _this$props2.data,\n        onSelect = _this$props2.onSelect;\n      var selectedData = _this.state.context.selectedData;\n      var selectNodesId = selectedData.nodes.map(function (item) {\n        return item.id;\n      });\n      if (mode === SelectMode.RIGHT_NORMAL && selectNodesId.indexOf(node.id) !== -1) {\n        onSelect(selectedData);\n        return selectedData;\n      }\n      var selectData = selectNodes({\n        data: data,\n        selectedData: selectedData\n      })({\n        node: node,\n        mode: mode\n      });\n      _this.setContext({\n        selectedData: selectData\n      }, function () {\n        if (mode === SelectMode.BOX_SELECTION) {\n          _this.generateBoxBySelectedNode(_this.state.context.selectedData.nodes);\n        }\n        if (onSelect) {\n          onSelect(_this.state.context.selectedData);\n        }\n      });\n      return selectData;\n    };\n    _this.selectNodesForSelection = function () {};\n    _this.selectLine = function (data) {\n      _this.setContext({\n        selectedData: data\n      }, function () {\n        var onSelect = _this.props.onSelect;\n        if (onSelect) {\n          onSelect(_this.state.context.selectedData);\n        }\n      });\n    };\n    _this.dragCanvas = function (clientX, clientY) {\n      if (!_this.$wrapper) {\n        return;\n      }\n      var dX = _this.dragCanvasPo.x - clientX;\n      var dY = _this.dragCanvasPo.y - clientY;\n      _this.dragCanvasPo = {\n        x: clientX,\n        y: clientY\n      };\n      _this.$wrapper.scrollTop = _this.$wrapper.scrollTop + dY;\n      _this.$wrapper.scrollLeft = _this.$wrapper.scrollLeft + dX;\n    };\n    _this.editLine = function (clientX, clientY) {\n      var activeLine = _this.state.context.activeLine;\n      if (!_this.$wrapper || !activeLine) {\n        return;\n      }\n      var clientPo = computeCanvasPo({\n        x: clientX,\n        y: clientY\n      }, _this.$wrapper);\n      var impactNode = _this.impactCheck(clientPo, activeLine[activeLine.type === LineEditType.EDIT_START ? \"end\" : \"start\"]);\n      _this.setContext({\n        impactNode: impactNode,\n        activeLine: _objectSpread({}, activeLine, _defineProperty({}, activeLine.type, clientPo))\n      });\n    };\n    _this.handleHoverCurrentNode = function (node) {\n      _this.setContext({\n        hoverCurrentNode: node\n      });\n    };\n    _this.isSelected = function (id) {\n      var selectedData = _this.state.context.selectedData;\n      return selectedData.nodes.some(function (item) {\n        return item.id === id;\n      });\n    };\n    _this.clearHoverCurrentNode = function () {\n      _this.setContext({\n        hoverCurrentNode: null\n      });\n    };\n    _this.handleMouseDown = function (e) {\n      if (e.button === 2) {\n        // 检查是否右键\n        _this.setState({\n          boxSelectionInfo: {\n            initX: e.clientX,\n            initY: e.clientY,\n            x: e.clientX,\n            y: e.clientY,\n            status: 'drag'\n          }\n        });\n        return;\n      }\n      // @ts-ignore\n      var itemType = e.target.getAttribute(\"data-type\");\n      // @ts-ignore\n      var className = e.target.className;\n      var getClickType = function getClickType() {\n        // @ts-ignore\n        if (\n        // @ts-ignore\n        [LineEditType.EDIT_START, LineEditType.EDIT_END].includes(itemType || \"\")) {\n          return \"CLICK_LINE_POINT\";\n        } else if (typeof className === \"string\" && className.includes(\"topology-canvas\")) {\n          return \"CLICK_CANVAS\";\n        }\n        return \"\";\n      };\n      switch (getClickType()) {\n        case \"CLICK_CANVAS\":\n          _this.dragCanvasPo = {\n            x: e.clientX,\n            y: e.clientY\n          };\n          // this.$topology\n          _this.$canvas.classList.add(DRAG_CLASS);\n          break;\n        case \"CLICK_LINE_POINT\":\n          if (_this.props.readOnly) {\n            break;\n          }\n          try {\n            // @ts-ignore\n            var jsonStr = e.target.getAttribute(\"data-json\");\n            if (typeof jsonStr !== \"string\" || !jsonStr) {\n              throw new Error(\"线段起点无数据\");\n            }\n            var _JSON$parse = JSON.parse(jsonStr),\n              origin = _JSON$parse.origin,\n              po = _JSON$parse.po;\n            _this.setContext({\n              linking: true,\n              activeLine: {\n                origin: origin,\n                start: po.start,\n                end: po.end,\n                type: itemType\n              }\n            });\n          } catch (err) {\n            // eslint-disable-next-line no-console\n            console.log(err);\n          }\n          break;\n        default:\n          break;\n      }\n    };\n    _this.handleMouseMove = function (e) {\n      e.persist();\n      if (!!_this.state.boxSelectionInfo && _this.state.boxSelectionInfo.status === 'drag') {\n        _this.setState(function (prev) {\n          return {\n            boxSelectionInfo: _objectSpread({}, prev.boxSelectionInfo, {\n              x: e.clientX,\n              y: e.clientY\n            })\n          };\n        });\n        return;\n      }\n      var activeLine = _this.state.context.activeLine; // @ts-ignore\n      var isEditingLine = activeLine\n      // @ts-ignore\n      && [LineEditType.EDIT_START, LineEditType.EDIT_END].includes(activeLine.type);\n      var isDraggingCanvas = _this.dragCanvasPo;\n      if (!isDraggingCanvas) {\n        _this.$canvas.classList.remove(DRAG_CLASS);\n      }\n      if (!isEditingLine && !isDraggingCanvas) {\n        return;\n      }\n      if (isDraggingCanvas) {\n        _this.dragCanvas(e.clientX, e.clientY);\n      }\n      if (isEditingLine && !_this.props.readOnly) {\n        _this.editLine(e.clientX, e.clientY);\n      }\n    };\n    _this.samePostionLinesLength = function (curLine) {\n      var lines = _this.props.data.lines;\n      return lines && lines.filter(function (item) {\n        return item.start.split('-')[0] === curLine.start.split('-')[0] && item.end === curLine.end;\n      }).length;\n    };\n    _this.getLineRepeatIndex = function (curLine) {\n      var startPointAnchorId = _this.props.startPointAnchorId; // 所有线条起始点与 startPointAnchorId 线条一致情况下，增加线条位置重复次数属性\n      var index = startPointAnchorId !== undefined && _this.samePostionLinesLength(curLine) ? {\n        index: _this.samePostionLinesLength(curLine)\n      } : {};\n      return index;\n    };\n    _this.inSelection = function (selectionPositionGroup, nodePositionGroup) {\n      var _selectionPositionGro = _slicedToArray(selectionPositionGroup, 2),\n        selectionLeftTopPosition = _selectionPositionGro[0],\n        selectionRightBottomPosition = _selectionPositionGro[1];\n      var _nodePositionGroup = _slicedToArray(nodePositionGroup, 2),\n        nodeLeftTopPosition = _nodePositionGroup[0],\n        nodeRightBottomPosition = _nodePositionGroup[1];\n      return nodeLeftTopPosition.x > selectionLeftTopPosition.x && nodeLeftTopPosition.y > selectionLeftTopPosition.y && nodeRightBottomPosition.x < selectionRightBottomPosition.x && nodeRightBottomPosition.y < selectionRightBottomPosition.y;\n    };\n    _this.getBoxPositionGroup = function () {\n      if (!_this.state.boxSelectionInfo) {\n        return undefined;\n      }\n      var _this$state$boxSelect = _this.state.boxSelectionInfo,\n        initX = _this$state$boxSelect.initX,\n        initY = _this$state$boxSelect.initY,\n        x = _this$state$boxSelect.x,\n        y = _this$state$boxSelect.y;\n      var selectionLeftTopPosition = {\n        x: Math.min(initX, x),\n        y: Math.min(initY, y)\n      };\n      var selectionRightBottomPosition = {\n        x: Math.max(initX, x),\n        y: Math.max(initY, y)\n      };\n      return [selectionLeftTopPosition, selectionRightBottomPosition];\n    };\n    _this.getNodeDomList = function () {\n      return _toConsumableArray(_this.$canvas.querySelectorAll('[id^=\"topology-node-\"]'));\n    };\n    _this.getCombineNode = function (combineId) {\n      if (!combineId) {\n        return [];\n      }\n      return _this.props.data.nodes.filter(function (item) {\n        return item.combineId === combineId;\n      });\n    };\n    // getShouldSelectedNodeList函数：获取框选中的节点列表\n    _this.getShouldSelectedNodeList = function () {\n      // Step 1: 获取box(矩形选择框)的位置信息(boxPositionGroup)和需要筛选的DOM列表(nodeList)\n      var boxPositionGroup = _this.getBoxPositionGroup();\n      var ret = {\n        nativeNodeList: [],\n        selectedNodeList: [],\n        boxPositionGroup: boxPositionGroup\n      };\n\n      // 如果没有筛选框的位置信息，则直接返回空；否则，获取框选中的节点列表进行下一步处理\n      if (!boxPositionGroup) {\n        return ret;\n      }\n      var nodeList = _this.getNodeDomList();\n\n      // Step 2: 筛选出所有与box相交的节点(nativeNodeList)，以及属于这些节点所属的整合组合的集合(combineIdSet)\n      var nativeNodeList = nodeList.filter(function (node) {\n        var info = node.getBoundingClientRect();\n        var nodePositionLeftTop = {\n          x: info.x,\n          y: info.y\n        };\n        var nodePositionRightBottom = {\n          x: info.x + info.width,\n          y: info.y + info.height\n        };\n        var nodePositionGroup = [nodePositionLeftTop, nodePositionRightBottom];\n        return _this.inSelection(boxPositionGroup, nodePositionGroup);\n      });\n      var combineIdSet = new Set(nativeNodeList.map(function (node) {\n        return node.dataset.combineId;\n      }).filter(function (id) {\n        return !!id;\n      })); // 把每个有'data-combine-id'属性的HTML节点转化为数组后，筛选出仅由combileId的(无重复)集合combineIdSet\n\n      // Step 3: 将筛选后的结果flat化、去重和拼接之后，以id形式存储在shouldSelectedNodeIdList中\n      var combineIdList = [];\n      combineIdSet.forEach(function (id) {\n        combineIdList.push(id);\n      });\n      var shouldSelectedNodeIdList = nativeNodeList.map(function (n) {\n        return n.firstChild;\n      }).map(function (node) {\n        return node.dataset.id;\n      }); // 把所有HTML节点的第一个子元素，即头部节点的'data-id'属性放进shouldSelectedNodeIdList中\n      _this.props.data.nodes.forEach(function (node) {\n        // 筛选出每个整合组合的'data-id', 拼接到shouldSelectedNodeIdList里面\n        if (combineIdSet.has(node.combineId)) {\n          shouldSelectedNodeIdList.push(node.id);\n        }\n      });\n\n      // Step 4: 把结果与props.data.nodes中的节点进行比较并存储下来(selectedNodeList是把筛选过的节点的详细信息添加到一个新对象(IWidgetNode)构成的列表里)\n      var idSet = new Set(shouldSelectedNodeIdList);\n      var selectedNodeList = [];\n\n      // 找到所有被选中的节点子节点\n      _this.props.data.nodes.forEach(function (node) {\n        if (idSet.has(node.id) && isMatchKeyValue(node, 'dragChild', true)) {\n          _this.props.data.lines.forEach(function (line) {\n            if (line.start.split('-')[0] === node.id) {\n              idSet.add(line.end);\n            }\n          });\n        }\n      });\n      _this.props.data.nodes.forEach(function (node) {\n        if (idSet.has(node.id)) {\n          selectedNodeList.push(node);\n        }\n      });\n\n      // Step 5: 返回所有需要返回的信息(nativeNodeList, selectedNodeList, boxPositionGroup)，其中nativeNodeList中是从nodeList-filter-domNodeList里面经过box筛选后得到的HTML节点，selectedNodeList则是把选中节点详细存储到一个对象构成的列表里\n      ret.nativeNodeList = nodeList.filter(function (node) {\n        return idSet.has(node.firstChild.dataset.id);\n      });\n      ret.selectedNodeList = selectedNodeList;\n      return ret;\n    };\n    _this.couldDispatchContextMenuEvent = function (e) {\n      if (e.button !== 2) {\n        return false;\n      }\n      if (_this.state.boxSelectionInfo && (Math.abs(_this.state.boxSelectionInfo.initX - e.clientX) > 3 || Math.abs(_this.state.boxSelectionInfo.initY - e.clientY) > 3)) {\n        return false;\n      }\n      return true;\n    };\n    _this.closeBoxSelection = function () {\n      _this.setState(_this.state.boxSelectionInfo ? {\n        boxVisibleFlag: true,\n        boxSelectionInfo: null\n      } : {\n        boxSelectionInfo: null\n      });\n    };\n    _this.showBoxSelection = function () {\n      if (_this.state.boxVisibleFlag) {\n        _this.setState({\n          boxVisibleFlag: false\n        });\n        _this.generateBoxBySelectedNode();\n      }\n    };\n    _this.handleMouseUp = function (e) {\n      var _this$props3 = _this.props,\n        lines = _this$props3.data.lines,\n        readOnly = _this$props3.readOnly;\n      var clientX = e.clientX,\n        clientY = e.clientY,\n        screenX = e.screenX,\n        screenY = e.screenY,\n        button = e.button,\n        buttons = e.buttons;\n      _this.$canvas.classList.remove(DRAG_CLASS);\n      var boxSelectionInfo = _this.state.boxSelectionInfo;\n      var shouldOpenContextMenuFlag = _this.couldDispatchContextMenuEvent(e);\n      var isMultiClick = e.ctrlKey || e.metaKey || e.shiftKey;\n      var isDragBox = boxSelectionInfo && boxSelectionInfo.status === 'drag' && !shouldOpenContextMenuFlag;\n      var isEmitByNodeWrapper = function isEmitByNodeWrapper() {\n        var target = e.target;\n        while (target.className !== e.currentTarget.className && target !== document.body) {\n          if (target.className.indexOf('topology-node-content') > -1) {\n            return true;\n          }\n          target = target.parentElement;\n        }\n        return false;\n      };\n\n      // 允许打开右键菜单\n      if (shouldOpenContextMenuFlag && !isEmitByNodeWrapper()) {\n        var mouseEvent = new MouseEvent('contextmenu', {\n          bubbles: true,\n          cancelable: true,\n          clientX: clientX,\n          clientY: clientY,\n          screenX: screenX,\n          screenY: screenY,\n          button: button,\n          buttons: buttons\n        });\n        _this.$wrapper.dispatchEvent(mouseEvent);\n      }\n      // 单击且没有按住ctrl/meta/shift键时，清空框选框\n      if (!isMultiClick) {\n        _this.setState({\n          boxSelectionInfo: undefined\n        });\n      }\n\n      // 拖动框选box结束时\n      if (isDragBox) {\n        var _this$getShouldSelect = _this.getShouldSelectedNodeList(),\n          nodeList = _this$getShouldSelect.selectedNodeList,\n          nativeNodeList = _this$getShouldSelect.nativeNodeList;\n        if (nodeList.length === 0) {\n          // 没有选中任何节点\n          _this.setState({\n            boxSelectionInfo: undefined\n          });\n          return;\n        } else {\n          _this.generateBoxByRealSelectedNodeDom(nativeNodeList);\n        }\n        var lineList = getLinesFromNode(lines, nodeList);\n        _this.setContext({\n          selectedData: {\n            nodes: nodeList,\n            lines: lineList\n          }\n        }, function () {\n          var onSelect = _this.props.onSelect;\n          if (onSelect) {\n            onSelect(_this.state.context.selectedData);\n          }\n        });\n        _this.setState({\n          boxSelectionInfo: _objectSpread({}, _this.state.boxSelectionInfo, {\n            status: 'none'\n          })\n        });\n        return;\n      }\n      var _this$state$context = _this.state.context,\n        activeLine = _this$state$context.activeLine,\n        impactNode = _this$state$context.impactNode;\n      var isLineEdit = activeLine && activeLine.type !== LineEditType.ADD;\n      if (isLineEdit && impactNode && !readOnly) {\n        var _ref2 = activeLine,\n          _type = _ref2.type,\n          origin = _ref2.origin;\n        if (_type === LineEditType.EDIT_END) {\n          var editLine = {\n            start: origin.start,\n            end: impactNode\n          };\n          var repeatIndex = _this.getLineRepeatIndex(editLine) || {};\n          var getNewline = function getNewline(item) {\n            if (!_this.samePostionLinesLength(editLine)) {\n              // eslint-disable-next-line no-param-reassign\n              delete item.index;\n            }\n            return _objectSpread({}, item, {\n              end: impactNode\n            }, repeatIndex);\n          };\n          _this.onChange(_objectSpread({}, _this.props.data, {\n            lines: lines.map(function (item) {\n              return _.isEqual(item, origin) ? getNewline(item) : item;\n            })\n          }), ChangeType.EDIT_LINE);\n        }\n      }\n      _this.clearMouseEventData();\n    };\n    _this.clearMouseEventData = function () {\n      _this.dragCanvasPo = null;\n      _this.setContext({\n        activeLine: null,\n        linking: false,\n        impactNode: null\n      });\n    };\n    _this.handleLineDraw = function (startId) {\n      var _this$props4 = _this.props,\n        data = _this$props4.data,\n        lineColor = _this$props4.lineColor;\n      var lines = _this.props.data.lines;\n      var impactNode = _this.state.context.impactNode;\n      if (impactNode) {\n        var newLine = {\n          start: startId,\n          end: impactNode\n        };\n        var alreadyExist = lines.find(function (item) {\n          return _.isEqual(item, newLine);\n        });\n        var anchor = startId.split(\"-\")[1] || \"\";\n        if (!alreadyExist) {\n          var colorMap = lineColor ? {\n            color: lineColor[anchor]\n          } : {};\n          var repeatIndex = _this.getLineRepeatIndex(newLine) || {};\n          _this.onChange(_objectSpread({}, data, {\n            lines: [].concat(_toConsumableArray(data.lines), [_objectSpread({}, newLine, colorMap, repeatIndex)])\n          }), ChangeType.ADD_LINE);\n        }\n      }\n      _this.clearMouseEventData();\n    };\n    _this.handleNodeDraw = function (nodeInfoList, childPosMap) {\n      var data = _this.props.data;\n      var posMaps = _objectSpread({}, nodeInfoList.reduce(function (prev, curr) {\n        var _curr = _slicedToArray(curr, 2),\n          nodeId = _curr[0],\n          position = _curr[1];\n        return _objectSpread({}, prev, _defineProperty({}, nodeId, position));\n      }, {}), childPosMap);\n      _this.onChange(_objectSpread({}, data, {\n        // @ts-ignore\n        nodes: data.nodes.map(function (item) {\n          return Object.keys(posMaps).includes(item.id) ? _objectSpread({}, item, {\n            position: posMaps[item.id]\n          }) : item;\n        })\n      }), ChangeType.LAYOUT);\n    };\n    _this.handleCanvasClick = function (e) {\n      // @ts-ignore\n      var className = e.target.className;\n      if (typeof className === \"string\" && className.includes(\"topology-canvas\")) {\n        // 当按住cmd或者ctrl的时候，左键点击背景图层的时候，不会清楚选中的数据。\n        if (e.ctrlKey || e.metaKey) {\n          return;\n        }\n        _this.clearSelectData();\n      }\n      _this.setDraggingId(null);\n    };\n    _this.renderNodes = function () {\n      var _this$props5 = _this.props,\n        _this$props5$data = _this$props5.data,\n        nodes = _this$props5$data.nodes,\n        lines = _this$props5$data.lines,\n        renderTreeNode = _this$props5.renderTreeNode,\n        readOnly = _this$props5.readOnly,\n        isReduceRender = _this$props5.isReduceRender,\n        prevNodeStyle = _this$props5.prevNodeStyle;\n      var context = _this.state.context;\n      var selectedNodes = context.selectedData.nodes || [];\n      var _this$state = _this.state,\n        scaleNum = _this$state.scaleNum,\n        draggingId = _this$state.draggingId;\n      if (!renderTreeNode) {\n        return null;\n      }\n      var lineHash = lines.reduce(function (pre, cur) {\n        var _objectSpread5;\n        var start = cur.start,\n          end = cur.end;\n        var _start$split = start.split(\"-\"),\n          _start$split2 = _slicedToArray(_start$split, 1),\n          parent = _start$split2[0];\n        return _objectSpread({}, pre, (_objectSpread5 = {}, _defineProperty(_objectSpread5, parent, true), _defineProperty(_objectSpread5, end, true), _objectSpread5));\n      }, {});\n      return nodes.map(function (item) {\n        return /*#__PURE__*/React.createElement(NodeWrapper, {\n          onMouseEnter: _this.handleHoverCurrentNode,\n          onMouseLeave: _this.clearHoverCurrentNode,\n          key: item.id,\n          id: \"\".concat(item.id),\n          data: item,\n          scaleNum: scaleNum,\n          draggingId: draggingId,\n          isSelected: _this.isSelected(item.id),\n          combineId: item.combineId,\n          getBoundary: _this.getBoundary,\n          selectedNodes: selectedNodes,\n          setDraggingId: _this.setDraggingId,\n          isReduceRender: isReduceRender,\n          closeBoxSelection: _this.closeBoxSelection,\n          readOnly: readOnly,\n          prevNodeStyle: prevNodeStyle,\n          isolated: !lineHash[item.id],\n          onSelect: _this.selectNode,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1139,\n            columnNumber: 13\n          }\n        }, function (wrapperOptions) {\n          return (/* eslint-disable */\n            renderTreeNode(item, wrapperOptions)\n          );\n        });\n      });\n    };\n    _this.renderDomMap = function () {\n      var props = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : _this.props;\n      var nodes = props.data.nodes,\n        renderTreeNode = props.renderTreeNode;\n      if (!renderTreeNode) {\n        return;\n      }\n      var domMap = document.querySelector(\"#topology-dom-map\");\n      if (!domMap) {\n        domMap = document.createElement(\"div\");\n        domMap.setAttribute(\"id\", \"topology-dom-map\");\n      }\n      domMap.innerHTML = renderToStaticMarkup( /*#__PURE__*/React.createElement(\"div\", {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1181,\n          columnNumber: 13\n        }\n      }, nodes.map(function (item) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: item.id,\n          id: \"dom-map-\".concat(item.id),\n          className: \"dom-map-wrapper\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1183,\n            columnNumber: 21\n          }\n        }, renderTreeNode(item, {\n          anchorDecorator: function anchorDecorator(_ref3) {\n            var anchorId = _ref3.anchorId;\n            return function (_item) {\n              return /*#__PURE__*/React.createElement(\"div\", {\n                id: \"dom-map-\".concat(item.id, \"-\").concat(anchorId),\n                key: anchorId,\n                className: \"dom-map-wrapper\",\n                __self: _assertThisInitialized(_this),\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 1192,\n                  columnNumber: 33\n                }\n              }, _item);\n            };\n          }\n        }));\n      })));\n      document.body.appendChild(domMap);\n      setTimeout(_this.cacheNodeSize, 1000);\n    };\n    _this.renderLines = function () {\n      var _this$props6 = _this.props,\n        _this$props6$data = _this$props6.data,\n        lines = _this$props6$data.lines,\n        nodes = _this$props6$data.nodes,\n        startPointAnchorId = _this$props6.startPointAnchorId,\n        lineTextMap = _this$props6.lineTextMap,\n        lineOffsetY = _this$props6.lineOffsetY,\n        readOnly = _this$props6.readOnly,\n        lineTextColor = _this$props6.lineTextColor,\n        lineLinkageHighlight = _this$props6.lineLinkageHighlight,\n        lineTextDecorator = _this$props6.lineTextDecorator,\n        showText = _this$props6.showText,\n        isReduceRender = _this$props6.isReduceRender;\n      var _this$state$context2 = _this.state.context,\n        activeLine = _this$state$context2.activeLine,\n        selectedData = _this$state$context2.selectedData,\n        hoverCurrentNode = _this$state$context2.hoverCurrentNode;\n      var nodeHash = createHashFromObjectArray(nodes, \"id\");\n      var isEditing = function isEditing(line) {\n        return activeLine && activeLine.origin && _.isEqual(line, activeLine.origin);\n      };\n      var isSelected = function isSelected(line) {\n        return isEditing(line) || _.some(selectedData.lines, line);\n      };\n\n      // @ts-ignore\n      var isHighLight = function isHighLight(line) {\n        if (!hoverCurrentNode || !lineLinkageHighlight) return false;\n        var id = hoverCurrentNode.id;\n        if (line.start.split(\"-\")[0] === id || line.end === id) return true;\n      };\n      var getLineStartPo = function getLineStartPo(line) {\n        if (isEditing(line) && activeLine.type === LineEditType.EDIT_START) {\n          return activeLine.start;\n        }\n\n        // 这里特殊处理下，目的是保持所有锚点的起始点位置与 startPointAnchorId 锚点位置一致\n        return computeAnchorPo( // `dom-map-${line.start}`,\n        \"dom-map-\".concat(startPointAnchorId === undefined ? line.start : \"\".concat(line.start.split(\"-\")[0], \"-\").concat(startPointAnchorId)), nodeHash[line.start.split(\"-\")[0]]);\n      };\n      var getLineEndPo = function getLineEndPo(line) {\n        if (isEditing(line) && activeLine.type === LineEditType.EDIT_END) {\n          return activeLine.end;\n        }\n        return computeNodeInputPo(nodeHash[line.end]);\n      };\n      return /*#__PURE__*/React.createElement(\"svg\", {\n        className: \"topology-svg\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1264,\n          columnNumber: 13\n        }\n      }, lines.map(function (line, index) {\n        var start = getLineStartPo(line);\n        var end = getLineEndPo(line);\n        if (!start || !end) {\n          return null;\n        }\n        var key = \"\".concat(line.start, \"-\").concat(line.end);\n        var anchorId = line.start.split(\"-\")[1];\n        var getTextXY = function getTextXY() {\n          var minX = Math.min(start.x, end.x);\n          var minY = Math.min(start.y, end.y);\n          var x = minX + Math.abs((start.x - end.x) / 2);\n          var y = minY + Math.abs((start.y - end.y) / 2);\n          return {\n            x: x,\n            y: y\n          };\n        };\n        var defaultTextEl = lineTextColor && /*#__PURE__*/React.createElement(\"text\", {\n          x: getTextXY().x,\n          y: getTextXY().y,\n          key: index,\n          style: {\n            fill: lineTextColor[anchorId]\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1286,\n            columnNumber: 25\n          }\n        }, anchorId === startPointAnchorId && !showText(line.start.split(\"-\")[0]) ? null : lineTextMap[anchorId]);\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Line, {\n          isReduceRender: isReduceRender,\n          scaleNum: _this.state.scaleNum,\n          key: key,\n          lineOffsetY: lineOffsetY,\n          data: line,\n          start: start,\n          end: end,\n          onSelect: _this.selectLine,\n          selected: isSelected(line),\n          highLight: isHighLight(line),\n          readOnly: readOnly,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1292,\n            columnNumber: 29\n          }\n        }), lineTextDecorator ? /*#__PURE__*/React.createElement(LineText, {\n          data: _this.props.data,\n          lineTextDecorator: lineTextDecorator,\n          position: getTextXY(),\n          line: line,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1306,\n            columnNumber: 53\n          }\n        }) : defaultTextEl);\n      }), activeLine && activeLine.type === LineEditType.ADD && /*#__PURE__*/React.createElement(Line, Object.assign({}, activeLine, {\n        scaleNum: _this.state.scaleNum,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1314,\n          columnNumber: 21\n        }\n      })));\n    };\n    // TODO：系统计算设置一个合适的 scale，使所有节点均在可视化区域内\n    _this.findScale = /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(clonegraph) {\n        var scaleNum, downloadScale, canvasEle, _getMaxAndMinNodeId, minXId, maxXId, minYId, maxYId, minYIdElement, isAllView, isViw, i;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              scaleNum = _this.state.scaleNum;\n              downloadScale = Number(scaleNum && scaleNum.toFixed(1));\n              canvasEle = clonegraph.querySelector('#topology-canvas');\n              canvasEle.style.transform = \"scale(\".concat(downloadScale, \")\");\n              _getMaxAndMinNodeId = getMaxAndMinNodeId(_this.props.data.nodes), minXId = _getMaxAndMinNodeId.minXId, maxXId = _getMaxAndMinNodeId.maxXId, minYId = _getMaxAndMinNodeId.minYId, maxYId = _getMaxAndMinNodeId.maxYId;\n              minYIdElement = clonegraph.querySelector(\"#topology-node-\".concat(minYId));\n              minYIdElement.scrollIntoView({\n                block: \"start\"\n              });\n              isAllView = function isAllView() {\n                var minxIdView = isInViewPort(minXId, document);\n                var maxxIdView = isInViewPort(maxXId, document);\n                var minYIdView = isInViewPort(minYId, document);\n                var maxYIdView = isInViewPort(maxYId, document);\n                return minxIdView && maxxIdView && minYIdView && maxYIdView;\n              };\n              isViw = isAllView();\n              if (!isViw) {\n                _context.next = 11;\n                break;\n              }\n              return _context.abrupt(\"return\", downloadScale);\n            case 11:\n              i = 1;\n            case 12:\n              if (!(i <= 10)) {\n                _context.next = 22;\n                break;\n              }\n              downloadScale = Number((downloadScale - 0.1).toFixed(1));\n              canvasEle.style.transform = \"scale(\".concat(downloadScale, \")\");\n              minYIdElement.scrollIntoView({\n                block: \"start\"\n              });\n              isViw = isAllView();\n              if (!(isViw || downloadScale === 0.1)) {\n                _context.next = 19;\n                break;\n              }\n              return _context.abrupt(\"break\", 22);\n            case 19:\n              i++;\n              _context.next = 12;\n              break;\n            case 22:\n              return _context.abrupt(\"return\", downloadScale);\n            case 23:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }));\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n    /**\n     * @param scopeType 下载区域类型（整个画布数据|选中的数据）\n     * @param openDownload 是否开启下载\n     * @param imgName 图片名称\n     * @returns\n     */\n    _this.downloadImg = /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(scopeType, openDownload, imgName) {\n        var _this$state2, selectedData, scaleNum, isGlobal, nodes, graphEl, imgBase64, _computeMaxAndMin, minX, maxX, minY, maxY, imgPadding, imgMinSize;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              // openDownload && this.setState({ loading: true, })\n              _this$state2 = _this.state, selectedData = _this$state2.context.selectedData, scaleNum = _this$state2.scaleNum;\n              isGlobal = scopeType === 'global';\n              nodes = isGlobal ? _this.props.data.nodes : selectedData && selectedData.nodes;\n              graphEl = document.querySelector(\".topology-canvas\");\n              imgBase64 = '';\n              _computeMaxAndMin = computeMaxAndMin(nodes), minX = _computeMaxAndMin.minX, maxX = _computeMaxAndMin.maxX, minY = _computeMaxAndMin.minY, maxY = _computeMaxAndMin.maxY;\n              imgPadding = isGlobal ? 50 : 0;\n              imgMinSize = 200;\n              return _context2.abrupt(\"return\", html2canvas(graphEl, {\n                onclone: function onclone(documentClone) {\n                  // 背景色置为透明色\n\n                  var nodeContentEls = documentClone.getElementsByClassName('topology-node-content');\n                  nodeContentEls && Array.from(nodeContentEls).forEach(function (node) {\n                    var childNode = node.childNodes && node.childNodes[0];\n                    var grandsonChildNode = childNode && childNode.childNodes[0];\n                    node.style.backgroundColor = 'transparent';\n                    node.style.border = '1px solid #fff';\n                    childNode.style.backgroundColor = 'white';\n                    grandsonChildNode.style.boxShadow = 'none';\n                  });\n                  var _getMaxAndMinNodeId2 = getMaxAndMinNodeId(nodes),\n                    minYId = _getMaxAndMinNodeId2.minYId; // 定位画布中最顶层的节点，让其滚动在浏览器顶部，尽可能的多展示其它节点\n                  var minYIdElement = documentClone.getElementById(\"topology-node-\".concat(minYId));\n                  minYIdElement.scrollIntoView({\n                    block: \"start\",\n                    inline: 'center'\n                  });\n                },\n                backgroundColor: 'white',\n                useCORS: true,\n                //支持图片跨域\n                scale: 1 / scaleNum,\n                x: (minX - imgPadding) * scaleNum,\n                y: (minY - imgPadding) * scaleNum,\n                width: maxX - minX + imgMinSize,\n                height: maxY - minY + imgMinSize\n              }).then(function (canvas) {\n                imgBase64 = canvas.toDataURL('image/png');\n                // 生成图片导出\n                if (openDownload) {\n                  var a = document.createElement('a');\n                  a.href = imgBase64;\n                  a.download = imgName || '图片';\n                  a.click();\n                }\n                _this.setState({\n                  loading: false\n                });\n                return Promise.resolve(imgBase64);\n              }));\n            case 9:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }));\n      return function (_x2, _x3, _x4) {\n        return _ref5.apply(this, arguments);\n      };\n    }();\n    /**\n     * 整个画布截图\n     */\n    _this.getImageBase64Url = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      var url;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return _this.downloadImg('global', false);\n          case 2:\n            url = _context3.sent;\n            return _context3.abrupt(\"return\", url);\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    /**\n     * 选中数据截图\n     */\n    _this.getImageBase64UrlWithSelectedData = /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n      var url;\n      return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n        while (1) switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _this.downloadImg('selected', false);\n          case 2:\n            url = _context4.sent;\n            return _context4.abrupt(\"return\", url);\n          case 4:\n          case \"end\":\n            return _context4.stop();\n        }\n      }, _callee4);\n    }));\n    // 定位节点\n    _this.locateNodeById = function (id) {\n      var nodes = _this.props.data.nodes;\n      var curNode = nodes && nodes.find(function (n) {\n        return n.id === id;\n      });\n      var ele = document.getElementById(\"topology-node-\".concat(id));\n      if (ele) {\n        // 如果已选中，则不做处理\n        _this.selectNode(curNode, SelectMode.SINGLE);\n        ele.scrollIntoView({\n          block: \"center\",\n          inline: 'center'\n        });\n      }\n    };\n    _this.renderToolBars = function () {\n      var _this$state3 = _this.state,\n        scaleNum = _this$state3.scaleNum,\n        loading = _this$state3.loading;\n      var _this$props7 = _this.props,\n        showCenter = _this$props7.showCenter,\n        showLayout = _this$props7.showLayout,\n        showDownload = _this$props7.showDownload,\n        downloadImg = _this$props7.downloadImg,\n        customToolboxList = _this$props7.customToolboxList;\n      /* eslint-disable */\n      // @ts-ignore\n      var zoomPercent = \"\".concat(parseInt(String((scaleNum ? scaleNum : 1).toFixed(1) * 100)), \"%\");\n      var exportStyle = loading ? {\n        backgroundColor: 'rgba(0,0,0,.04)',\n        cursor: 'not-allowed'\n      } : {};\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools\",\n        \"data-html2canvas-ignore\": false,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1466,\n          columnNumber: 13\n        }\n      }, showCenter !== false && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-btn\",\n        id: \"scroll-canvas-to-center\",\n        onClick: _this.props.customPostionHeight ? _this.scrollCanvasToPositionY : _this.scrollCanvasToCenter,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1467,\n          columnNumber: 42\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYwMzI3NjY4NDk5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExMzciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEzLjc5OTY0OSAyOTUuNzQyMjM4Yy0xMTguMTc2OTE5IDAtMjE0LjE1ODE3MiA5Ni4xODEyMTUtMjE0LjE1ODE3MyAyMTQuMTU4MTcyIDAgMTE4LjE3NjkxOSA5Ni4xODEyMTUgMjE0LjE1ODE3MiAyMTQuMTU4MTczIDIxNC4xNTgxNzIgMTE3Ljk3Njk1OCAwIDIxNC4xNTgxNzItOTUuNzgxMjkzIDIxNC4xNTgxNzItMjEzLjk1ODIxMXMtOTYuMTgxMjE1LTIxNC4zNTgxMzMtMjE0LjE1ODE3Mi0yMTQuMzU4MTMzeiBtMCAzNjcuMzI4MjU2Yy04NC4zODM1MTkgMC0xNTIuOTcwMTIzLTY4LjU4NjYwNC0xNTIuOTcwMTI0LTE1Mi45NzAxMjNzNjguNTg2NjA0LTE1Mi45NzAxMjMgMTUyLjk3MDEyNC0xNTIuOTcwMTIzIDE1Mi45NzAxMjMgNjguNTg2NjA0IDE1Mi45NzAxMjMgMTUyLjk3MDEyMy02OC41ODY2MDQgMTUyLjk3MDEyMy0xNTIuOTcwMTIzIDE1Mi45NzAxMjN6IiBmaWxsPSIjMzMzMzMzIiBwLWlkPSIxMTM4Ij48L3BhdGg+PHBhdGggZD0iTTk5MS4zMDYzODUgNDgwLjUwNjE1MUg5MTMuOTIxNWMtNy4xOTg1OTQtOTYuNTgxMTM2LTQ4LjE5MDU4OC0xODYuMzYzNjAxLTExNy4zNzcwNzUtMjU1LjU1MDA4OHMtMTU4Ljk2ODk1MS0xMTAuMTc4NDgxLTI1NS41NTAwODgtMTE3LjM3NzA3NVYzMC41OTQwMjVjMC0xNi43OTY3MTktMTMuNzk3MzA1LTMwLjU5NDAyNS0zMC41OTQwMjUtMzAuNTk0MDI1cy0zMC41OTQwMjUgMTMuNzk3MzA1LTMwLjU5NDAyNCAzMC41OTQwMjV2NzYuOTg0OTYzYy05Ni4zODExNzYgNy4xOTg1OTQtMTg2LjM2MzYwMSA0OC4xOTA1ODgtMjU1LjU1MDA4OCAxMTcuMzc3MDc1UzExNC4wNzc3MTkgMzgzLjcyNTA1NCAxMDYuODc5MTI1IDQ4MC41MDYxNTFIMzAuNjk0MDA1Yy0xNi43OTY3MTkgMC0zMC41OTQwMjUgMTMuNzk3MzA1LTMwLjU5NDAyNSAzMC41OTQwMjVzMTMuNzk3MzA1IDMwLjU5NDAyNSAzMC41OTQwMjUgMzAuNTk0MDI0aDc2LjE4NTEyYzcuMTk4NTk0IDk2LjU4MTEzNiA0OC4xOTA1ODggMTg2LjM2MzYwMSAxMTcuMzc3MDc1IDI1NS41NTAwODhzMTU4Ljk2ODk1MSAxMTAuMTc4NDgxIDI1NS41NTAwODggMTE3LjM3NzA3NXY3OC43ODQ2MTJjMCAxNi43OTY3MTkgMTMuNzk3MzA1IDMwLjU5NDAyNSAzMC41OTQwMjQgMzAuNTk0MDI1czMwLjU5NDAyNS0xMy43OTczMDUgMzAuNTk0MDI1LTMwLjU5NDAyNXYtNzguNzg0NjEyYzk2LjM4MTE3Ni03LjE5ODU5NCAxODYuMzYzNjAxLTQ4LjE5MDU4OCAyNTUuNTUwMDg4LTExNy4zNzcwNzVzMTEwLjE3ODQ4MS0xNTguOTY4OTUxIDExNy4zNzcwNzUtMjU1LjU1MDA4OGg3Ny4zODQ4ODVjMTYuNzk2NzE5IDAgMzAuNTk0MDI1LTEzLjc5NzMwNSAzMC41OTQwMjUtMzAuNTk0MDI0IDAtMTYuOTk2NjgtMTMuNzk3MzA1LTMwLjU5NDAyNS0zMC41OTQwMjUtMzAuNTk0MDI1ek03NTMuMTUyOSA3NTMuODUyNzYzYy02NC43ODczNDYgNjQuNzg3MzQ2LTE1MS4xNzA0NzUgMTAwLjU4MDM1NS0yNDIuNzUyNTg4IDEwMC41ODAzNTYtOTEuNzgyMDc0IDAtMTc3Ljk2NTI0MS0zNS43OTMwMDktMjQyLjc1MjU4Ny0xMDAuNTgwMzU2LTY0Ljc4NzM0Ni02NC43ODczNDYtMTAwLjU4MDM1NS0xNTEuMTcwNDc1LTEwMC41ODAzNTUtMjQyLjc1MjU4N3MzNS43OTMwMDktMTc3Ljk2NTI0MSAxMDAuNTgwMzU1LTI0Mi43NTI1ODhjNjQuNzg3MzQ2LTY0Ljc4NzM0NiAxNTEuMTcwNDc1LTEwMC41ODAzNTUgMjQyLjc1MjU4Ny0xMDAuNTgwMzU1IDkxLjc4MjA3NCAwIDE3Ny45NjUyNDEgMzUuNzkzMDA5IDI0Mi43NTI1ODggMTAwLjU4MDM1NSA2NC43ODczNDYgNjQuNzg3MzQ2IDEwMC41ODAzNTUgMTUxLjE3MDQ3NSAxMDAuNTgwMzU1IDI0Mi43NTI1ODhzLTM1LjU5MzA0OCAxNzcuOTY1MjQxLTEwMC41ODAzNTUgMjQyLjc1MjU4N3oiIGZpbGw9IiMzMzMzMzMiIHAtaWQ9IjExMzkiPjwvcGF0aD48L3N2Zz4=\",\n        alt: \"\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1472,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tooltip\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1476,\n          columnNumber: 21\n        }\n      }, \"\\u5B9A\\u4F4D\\u4E2D\\u5FC3\")), showLayout !== false && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-btn\",\n        id: \"auto-layout\",\n        onClick: _this.autoLayout,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1479,\n          columnNumber: 42\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYwMzI3NjU0MDc4IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwMjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODg1LjkyNzYxNyA2NzQuMzAwMTMyVjQ5Ny42NDYxMTNINTQwLjc3MTIyVjM1My44Mjk5MjRoMzQ1LjE1NzQyMVYxMjMuNjk3MDA2SDEzOC4wNzAzMzZ2MjMwLjEzMjkxOGgzNDUuMTU3NDIxdjE0My44MTYxODlIMTM4LjA3MDMzNnYxNzYuNjU0MDE5Yy00OS40Nzc3NzkgMTIuODYyOTMzLTg2LjI4ODA3NiA1Ny40OTc0MTQtODYuMjg4MDc2IDExMC45NTA3MjkgMCA2My40NTMwNDQgNTEuNTk4MDY1IDExNS4wNTIxMzMgMTE1LjA1NDE3OSAxMTUuMDUyMTMzIDYzLjQ1MjAyMSAwIDExNS4wNTAwODYtNTEuNTk5MDg5IDExNS4wNTAwODYtMTE1LjA1MjEzMyAwLTUzLjQ1MzMxNi0zNi44MTAyOTctOTguMDg3Nzk2LTg2LjI4ODA3Ni0xMTAuOTUwNzI5VjU1NS4xNDQ1NWgyODcuNjMwMzMxdjExOS4xNTQ1NTljLTQ5LjQ5MTA4MiAxMi44NjI5MzMtODYuMjg4MDc2IDU3LjQ5NzQxNC04Ni4yODgwNzYgMTEwLjk1MDcyOSAwIDYzLjQ1MzA0NCA1MS41OTkwODkgMTE1LjA1MjEzMyAxMTUuMDY2NDU5IDExNS4wNTIxMzMgNjMuNDI1NDE1IDAgMTE1LjA1NDE3OS01MS41OTkwODkgMTE1LjA1NDE3OS0xMTUuMDUyMTMzIDAtNTMuNDUzMzE2LTM2Ljc5ODAxNy05OC4wODc3OTYtODYuMjg5MDk5LTExMC45NTA3MjlWNTU1LjE0NDU1aDI4Ny42MzAzMzF2MTE5LjE1NDU1OWMtNDkuNDkzMTI5IDEyLjg2MjkzMy04Ni4yODcwNTMgNTcuNDk3NDE0LTg2LjI4NzA1MyAxMTAuOTUwNzI5IDAgNjMuNDUzMDQ0IDUxLjU2OTQxMyAxMTUuMDUyMTMzIDExNS4wNTExMSAxMTUuMDUyMTMzIDYzLjQyNDM5MSAwIDExNS4wNTMxNTYtNTEuNTk5MDg5IDExNS4wNTMxNTYtMTE1LjA1MjEzMy0wLjAwMjA0Ny01My40NTMzMTYtMzYuODAwMDY0LTk4LjA4Njc3My04Ni4yOTIxNy0xMTAuOTQ5NzA2ek0xOTUuNTk3NDI2IDE4MS4yMjQwOTZoNjMyLjgwNDEyNXYxMTUuMDUyMTMySDE5NS41OTc0MjZWMTgxLjIyNDA5NnogbTI4Ljc2NDA1NiA2MDQuMDI2NzY1YzAgMzEuNzEyMTk2LTI1LjgxNDg5NCA1Ny41NTQ3MTktNTcuNTI2MDY2IDU3LjU1NDcxOS0zMS43MTQyNDIgMC01Ny41MjcwOS0yNS44NDI1MjMtNTcuNTI3MDktNTcuNTU0NzE5IDAtMzEuNzE0MjQyIDI1LjgxMjg0Ny01Ny40OTg0MzcgNTcuNTI3MDktNTcuNDk4NDM3IDMxLjcxMjE5Ni0wLjAwMTAyMyA1Ny41MjYwNjYgMjUuNzgzMTcxIDU3LjUyNjA2NiA1Ny40OTg0Mzd6IG0zNDUuMTcxNzQ3IDBjMCAzMS43MTIxOTYtMjUuODQxNSA1Ny41NTQ3MTktNTcuNTI3MDg5IDU3LjU1NDcxOS0zMS43MjQ0NzUgMC01Ny41MzkzNjktMjUuODQyNTIzLTU3LjUzOTM2OS01Ny41NTQ3MTkgMC0zMS43MTQyNDIgMjUuODE1OTE3LTU3LjQ5ODQzNyA1Ny41MzkzNjktNTcuNDk4NDM3IDMxLjY4NTU5LTAuMDAxMDIzIDU3LjUyNzA5IDI1Ljc4MzE3MSA1Ny41MjcwODkgNTcuNDk4NDM3eiBtMjg3LjYzMTM1NSA1Ny41NTQ3MTljLTMxLjc0MTg3MiAwLTU3LjUyODExMy0yNS44NDI1MjMtNTcuNTI4MTEzLTU3LjU1NDcxOSAwLTMxLjcxNDI0MiAyNS43ODYyNDEtNTcuNDk4NDM3IDU3LjUyODExMy01Ny40OTg0MzcgMzEuNjg1NTkgMCA1Ny41MjcwOSAyNS43ODQxOTUgNTcuNTI3MDkgNTcuNDk4NDM3IDAgMzEuNzEyMTk2LTI1Ljg0MTUgNTcuNTU0NzE5LTU3LjUyNzA5IDU3LjU1NDcxOXoiIGZpbGw9IiMyYzJjMmMiIHAtaWQ9IjEwMjMiPjwvcGF0aD48L3N2Zz4=\",\n        alt: \"\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1484,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tooltip\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1488,\n          columnNumber: 21\n        }\n      }, \"\\u81EA\\u52A8\\u5E03\\u5C40\")), showDownload && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-btn\",\n        id: \"export-img\",\n        style: exportStyle,\n        onClick: /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n          return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n            while (1) switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!loading) {\n                  _context5.next = 2;\n                  break;\n                }\n                return _context5.abrupt(\"return\");\n              case 2:\n                // 截图之前需要重置 scaleNum 为 1，避免坐标错位\n                _this.setState({\n                  scaleNum: 1,\n                  loading: true\n                }, function () {\n                  downloadImg ? downloadImg() : _this.downloadImg('global', true);\n                });\n              case 3:\n              case \"end\":\n                return _context5.stop();\n            }\n          }, _callee5);\n        })),\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1491,\n          columnNumber: 34\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        alt: \"\",\n        src: \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9IiM2MTYxNjEiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik01MTIgNjJsNS42LjRDNTM5LjggNjUuMSA1NTcgODQuMSA1NTcgMTA3YzAgMjQuOS0yMC4xIDQ1LTQ1IDQ1SDE3NC41bC00LjUuNWMtMTAuMyAyLjEtMTggMTEuMi0xOCAyMnY0OTcuOWwxNzIuOC0xNTguM2MyNy41LTI1LjIgNjguNy0yNy41IDk4LjYtNi4zbDUuOCA0LjUgMTUxLjkgMTMwLjIgMTA0LjQtMTA0LjNjMjYtMjYgNjYuMi0zMC4zIDk2LjktMTEuNGw2IDQuMSA4My41IDYyLjZWNTEyaDkwdjMzNy41bC0uMyA4LjRDOTU3LjQgOTE2LjEgOTA4LjggOTYyIDg0OS41IDk2MmgtNjc1bC04LjQtLjNDMTA3LjkgOTU3LjQgNjIgOTA4LjggNjIgODQ5LjV2LTY3NWwuMy04LjRDNjYuNiAxMDcuOSAxMTUuMiA2MiAxNzQuNSA2Mkg1MTJ6TTM3My4xIDU2MmwtMi43IDEuOUwxNTIgNzY0djg1LjVsLjUgNC41YzIuMSAxMC4zIDExLjIgMTggMjIgMThoNjc1YzEyLjQgMCAyMi41LTEwLjEgMjIuNS0yMi41VjY3Ny45bC0xMjQtOTNjLTMuNi0yLjctOC4zLTIuOS0xMi4xLS45bC0yLjYgMi0xMDAuNyAxMDAuNiA4MS40IDY5LjhjMTQuMiAxMi4xIDE1LjggMzMuNCAzLjcgNDcuNi0xMSAxMi45LTI5LjYgMTUuNC00My42IDYuNmwtNC0zLTI4NC43LTI0NGMtMy41LTMtOC4zLTMuNS0xMi4zLTEuNnpNOTE3IDQ2N2MyNC45IDAgNDUgMjAuMSA0NSA0NWgtOTBjMC0yNC45IDIwLjEtNDUgNDUtNDV6TTgwNC41IDczLjJjMTcuMSAwIDMxLjIgMTIuNyAzMy40IDI5LjJsLjMgNC42djE4OC41bDU0LjktNTQuOWMxMi0xMiAzMC43LTEzLjEgNDMuOS0zLjNsMy44IDMuM2MxMiAxMiAxMy4xIDMwLjcgMy4zIDQzLjlsLTMuMyAzLjgtMTEyLjQgMTEyLjYtMS44IDEuNi0uMy4yLS43LjctLjMuMi0uNS41LjQtLjQtMi42IDEuOWMtLjkuNi0xLjkgMS4xLTIuOSAxLjYtLjMuMS0uNi4zLS44LjQtMS4zLjYtMi42IDEuMS00IDEuNS0uNi4yLTEuMS4zLTEuNi41LTEuMS4zLTIuMy42LTMuNS43bC0uOS4xYy0xLjQuMi0yLjguMy00LjIuM2wtMi4zLS4xYy0yLjgtLjItNS42LS43LTguMi0xLjYtMS0uMy0xLjctLjYtMi4zLS45LTIuNS0xLTQuOS0yLjQtNy4yLTQuMS0uNy0uNS0xLjMtMS0xLjgtMS40bC0yLTEuOC0xMTIuOC0xMTIuNGMtMTMuMi0xMy4yLTEzLjItMzQuNSAwLTQ3LjcgMTItMTIgMzAuNy0xMy4xIDQzLjktMy4zbDMuOCAzLjMgNTQuOSA1NC45VjEwNy4xYy4xLTE4LjcgMTUuMi0zMy45IDMzLjgtMzMuOXoiLz48L3N2Zz4=\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1507,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"tooltip\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1508,\n          columnNumber: 21\n        }\n      }, loading ? '导出中...' : '导出图片')), Array.isArray(customToolboxList) && customToolboxList.map(function (_ref9) {\n        var _ref9$wrapperProps = _ref9.wrapperProps,\n          wrapperProps = _ref9$wrapperProps === void 0 ? {} : _ref9$wrapperProps,\n          content = _ref9.content,\n          tooltip = _ref9.tooltip;\n        return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n          className: \"topology-tools-btn\"\n        }, wrapperProps, {\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1513,\n            columnNumber: 29\n          }\n        }), content, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"tooltip\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 1519,\n            columnNumber: 33\n          }\n        }, tooltip));\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-zoom\",\n        onClick: _this.zoomIn,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1524,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxOTIzNzE5OTI0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwOTIwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjEyOCIgaGVpZ2h0PSIxMjgiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMi42MTY5NDIgNjQuMTg2NjczYzYxLjcyMDU1MyAwIDExOS43OTA3ODIgMTEuNzc5ODEzIDE3NC4yMTEwODUgMzUuMzM5NDRzMTAxLjcwNjA0MyA1NS40MTU0MjggMTQxLjg1NzQyMSA5NS41Njc0MDVjNDAuMTUxMzc3IDQwLjE1MTk3NyA3Mi4wMDcxNzkgODcuMjcxODMgOTUuNTY3NDA1IDE0MS4zNTk3NTggMjMuNTYwMjI2IDU0LjA4NzcyOSAzNS4zNDAwMzkgMTExLjk5MjI2OSAzNS4zMzk0NCAxNzMuNzEzNDIyLTAuMDAwNiA2MS43MjA5NTMtMTEuNzgwMjEzIDExOS43OTEzODEtMzUuMzM5NDQgMTc0LjIxMTA4NS0yMy41NTkwMjcgNTQuNDE5NzAzLTU1LjQxNTAyOSAxMDEuNzA1NDQ0LTk1LjU2NzQwNSAxNDEuODU3NDIxLTQwLjE1MjU3NyA0MC4xNTE5NzctODcuNDM4MzE3IDcyLjAwNzc3OS0xNDEuODU3NDIxIDk1LjU2NzQwNS01NC40MTkxMDQgMjMuNTU5NjI3LTExMi40ODkzMzIgMzUuMzM5NDQtMTc0LjIxMTA4NSAzNS4zMzk0NHMtMTE5LjYyNjA5NC0xMS43Nzk4MTMtMTczLjcxMzQyMi0zNS4zMzk0NGMtNTQuMDg3MzI5LTIzLjU1OTYyNy0xMDEuMjA3MTgyLTU1LjQxNTQyOC0xNDEuMzU5NzU4LTk1LjU2NzQwNS00MC4xNTI1NzctNDAuMTUxOTc3LTcyLjAwODM3OC04Ny40Mzc3MTctOTUuNTY3NDA1LTE0MS44NTc0MjFzLTM1LjMzODg0LTExMi40ODk5MzItMzUuMzM5NDQtMTc0LjIxMTA4NWMtMC4wMDA2LTYxLjcyMTE1MyAxMS43NzkyMTQtMTE5LjYyNTQ5NCAzNS4zMzk0NC0xNzMuNzEzNDIyczU1LjQxNjAyOC0xMDEuMjA3NzgxIDk1LjU2NzQwNS0xNDEuMzU5NzU4IDg3LjI3MTIzLTcyLjAwNzc3OSAxNDEuMzU5NzU4LTk1LjU2NzQwNVM0NTAuODk2NTg4IDY0LjE4Njg3MyA1MTIuNjE2OTQyIDY0LjE4NjY3M3pNNzM0LjYxMDgzIDU3MC44OTEzMjhjMTkuOTA5NzAxIDAgMzcuODI4NTUyLTUuMTQzMzEzIDUzLjc1NjE1My0xNS40Mjk5MzkgMTUuOTI3NjAxLTEwLjI4NjYyNiAyMy44OTE0MDItMjUuNzE2NTY0IDIzLjg5MTQwMi00Ni4yODk4MTYgMC0xOS45MDk3MDEtNy45NjM4MDEtMzQuNjc2Mjg5LTIzLjg5MTQwMi00NC4yOTkzNjUtMTUuOTI3NjAxLTkuNjIzMDc2LTMzLjg0NjI1Mi0xNC40MzQ2MTMtNTMuNzU2MTUzLTE0LjQzNDgxM0wyOTQuNjA0MTU0IDQ1MC40MzczOTVjLTE5LjkwOTcwMSAwLTM4LjE2MDUyNyA0LjgxMTUzOC01NC43NTIyNzggMTQuNDM0ODEzLTE2LjU5MTc1MSA5LjYyMzA3Ni0yNC44ODc1MjYgMjQuMzg5NjY0LTI0Ljg4NzUyNiA0NC4yOTkzNjUgMCAyMC41NzMyNTEgOC4yOTU3NzUgMzYuMDAzMTkgMjQuODg3NTI2IDQ2LjI4OTgxNiAxNi41OTE3NTEgMTAuMjg2NjI2IDM0Ljg0MjM3NyAxNS40Mjk5MzkgNTQuNzUyMjc4IDE1LjQyOTkzOUw3MzQuNjEwODMgNTcwLjg5MTMyOCA3MzQuNjEwODMgNTcwLjg5MTMyOHoiIHAtaWQ9IjEwOTIxIiBmaWxsPSIjOUZBMkE4Ij48L3BhdGg+PC9zdmc+\",\n        alt: \"\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1525,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-percent\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1531,\n          columnNumber: 17\n        }\n      }, zoomPercent), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"topology-tools-zoom\",\n        onClick: _this.zoomOut,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1532,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxOTIzNDA4MzQyIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjgwNSIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC43NzgxMDY5LjAuaTIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTE3LjEyIDQzLjkxOTM2Yy0yNTguNzM0MDggMC00NjguNDggMjA5Ljc0NTkyLTQ2OC40OCA0NjguNDhzMjA5Ljc0NTkyIDQ2OC40OCA0NjguNDggNDY4LjQ4IDQ2OC40OC0yMDkuNzQ1OTIgNDY4LjQ4LTQ2OC40OC0yMDkuNzQ1OTItNDY4LjQ4LTQ2OC40OC00NjguNDh6TTc0Mi4yMzg3MiA1NjUuNzZINTcwLjg4djE3MS43OTkwNGMwIDI5LjU2OC0yNC4xOTIgNTMuNzYtNTMuNzYgNTMuNzZzLTUzLjc2LTI0LjE5Mi01My43Ni01My43NlY1NjUuNzZoLTE3MS40MzgwOGMtMjkuNTY4IDAtNTMuNzYtMjQuMTkyLTUzLjc2LTUzLjc2czI0LjE5Mi01My43NiA1My43Ni01My43Nkg0NjMuMzZ2LTE3MC45OTc3NmMwLTI5LjU2OCAyNC4xOTItNTMuNzYgNTMuNzYtNTMuNzZzNTMuNzYgMjQuMTkyIDUzLjc2IDUzLjc2VjQ1OC4yNGgxNzEuMzU4NzJjMjkuNTY4IDAgNTMuNzYgMjQuMTkyIDUzLjc2IDUzLjc2cy0yNC4xOTIgNTMuNzYtNTMuNzYgNTMuNzZ6IiBwLWlkPSI4MDYiIGZpbGw9IiM5RkEyQTgiPjwvcGF0aD48L3N2Zz4=\",\n        alt: \"\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1533,\n          columnNumber: 21\n        }\n      })));\n    };\n    _this.handleSelectAll = function () {\n      var _this$props8 = _this.props,\n        data = _this$props8.data,\n        onSelect = _this$props8.onSelect;\n      _this.setContext({\n        selectedData: data\n      }, function () {\n        if (onSelect) {\n          onSelect(_this.state.context.selectedData);\n        }\n      });\n    };\n    _this.handleDeselectAll = function () {\n      var onSelect = _this.props.onSelect;\n      _this.setContext({\n        selectedData: {\n          nodes: [],\n          lines: []\n        }\n      }, function () {\n        if (onSelect) {\n          onSelect(_this.state.context.selectedData);\n        }\n      });\n    };\n    /**\n     * Check whether the drag node overlaps\n     * @param nodeInfo [string, IPosition][]\n     * @returns\n     */\n    _this.validateIsOverlap = function (nodeInfo) {\n      var _this$props9 = _this.props,\n        nodes = _this$props9.data.nodes,\n        overlap = _this$props9.overlap,\n        _this$props9$overlapO = _this$props9.overlapOffset,\n        overlapOffset = _this$props9$overlapO === void 0 ? {} : _this$props9$overlapO;\n      if (!overlap) return false;\n      var nodePosMap = new Map();\n      nodeInfo.forEach(function (_ref10) {\n        var _ref11 = _slicedToArray(_ref10, 2),\n          id = _ref11[0],\n          pos = _ref11[1];\n        nodePosMap.set(id, pos);\n      });\n      var getNodeOffsetPos = function getNodeOffsetPos(position, id) {\n        return {\n          x: position.x + getNodeSize(id).width + overlapOffset.offsetX || 0,\n          y: position.y + getNodeSize(id).height + overlapOffset.offsetY || 0\n        };\n      };\n      var posMap = nodes && nodes.filter(function (n) {\n        return !nodePosMap.has(n.id) && !n.filterOverlap;\n      }).map(function (n) {\n        // const pos = nodePosMap.get(n.id);\n\n        return {\n          T1: {\n            x: n.position.x,\n            y: n.position.y\n          },\n          T2: getNodeOffsetPos(n.position, n.id)\n        };\n      });\n      var isOverlap = Array.from(nodePosMap).some(function (_ref12) {\n        var _ref13 = _slicedToArray(_ref12, 2),\n          id = _ref13[0],\n          pos = _ref13[1];\n        var S1 = {\n          x: pos.x,\n          y: pos.y\n        };\n        var S2 = getNodeOffsetPos(pos, id);\n        return posMap.some(function (p) {\n          return !(S2.y < p.T1.y || S1.y > p.T2.y || S2.x < p.T1.x || S1.x > p.T2.x) === true;\n        });\n      });\n      return isOverlap;\n    };\n    _this.multiValidateIsOverlap = function (drawId, pos) {\n      return false;\n    };\n    _this.setRealDragNodeDomList = function (element) {\n      _this.setState({\n        realDragNodeDomList: element\n      });\n    };\n    _this.setAlignmentLines = function (alignmentLines) {\n      _this.setState({\n        alignmentLines: alignmentLines\n      });\n    };\n    // 获取 drag 时节点坐标\n    _this.getNodePosition = function (monitor, nodeDom, isChild) {\n      if (!monitor) return {};\n      var scaleNum = _this.state.scaleNum;\n      var clientOffset = monitor.getDifferenceFromInitialOffset() || {};\n      var nodePosition = {\n        top: nodeDom.style.top,\n        left: nodeDom.style.left\n      };\n      var scalePosition = {\n        x: Number(nodePosition.left.replace(/[px]+/g, \"\")) + clientOffset.x / scaleNum || 0,\n        y: Number(nodePosition.top.replace(/[px]+/g, \"\")) + clientOffset.y / scaleNum || 0\n      };\n      var scrollPosition = computeCanvasPo(monitor.getSourceClientOffset() || {}, _this.$wrapper);\n      /**\n       * TODO： scaleNum 缩放与窗口滚动时有冲突, isChild 为子节点联动时使用 scalePosition 定位\n       */\n      var position = scaleNum === 1 ? isChild ? scalePosition : scrollPosition : scalePosition;\n      return position;\n    };\n    _this.shouldAutoLayout = shouldAutoLayout(_props.data.nodes);\n    return _this;\n  }\n  _createClass(Topology, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.renderDomMap();\n      var autoClearSelectedFn = this.getAutoClearSelectedFn();\n      if (autoClearSelectedFn) {\n        document.body.removeEventListener('click', autoClearSelectedFn);\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      var _this$props10 = this.props,\n        getInstance = _this$props10.getInstance,\n        readOnly = _this$props10.readOnly,\n        customPostionHeight = _this$props10.customPostionHeight,\n        scaleNum = _this$props10.scaleNum;\n      this.editLine = _.throttle(this.editLine, 40);\n      if (!readOnly) {\n        this.initDomEvents();\n      }\n      if (this.$wrapper) {\n        // 自定义节点距离画布顶部高度\n        if (customPostionHeight) {\n          this.scrollCanvasToPositionY();\n        } else {\n          this.scrollCanvasToCenter();\n        }\n        var autoClearSelectedFn = this.getAutoClearSelectedFn();\n        if (autoClearSelectedFn) {\n          document.body.addEventListener('click', autoClearSelectedFn);\n        }\n      }\n      if (this.shouldAutoLayout) {\n        this.shouldAutoLayout = false;\n        this.autoLayout();\n      }\n      if (getInstance) {\n        getInstance(this);\n      }\n      this.setState(function () {\n        _this2.scaleNum = scaleNum === undefined ? 1 : scaleNum;\n        // 记录默认缩放的值，resetScale 时候用\n        _this2.defaultScaleNum = _this2.scaleNum;\n        return {\n          scaleNum: scaleNum\n        };\n      });\n    }\n  }, {\n    key: \"getAutoClearSelectedFn\",\n    value: function getAutoClearSelectedFn() {\n      // eslint-disable-next-line react/destructuring-assignment\n      if (!this.props.autoRemoveSelected) {\n        return undefined;\n      }\n      // eslint-disable-next-line react/destructuring-assignment\n      return typeof this.props.autoRemoveSelected === 'function' ? this.props.autoRemoveSelected : this.clearSelectedWhenClickOutside;\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      var readOnly = this.props.readOnly;\n      var nextReadOnly = nextProps.readOnly;\n      this.renderDomMap(nextProps);\n      this.shouldAutoLayout = shouldAutoLayout(nextProps.data.nodes);\n      if (readOnly && !nextReadOnly) {\n        this.initDomEvents();\n      }\n      if (!readOnly && nextReadOnly) {\n        this.removeDomEvents();\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      if (this.shouldAutoLayout) {\n        this.shouldAutoLayout = false;\n        this.autoLayout();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // @ts-ignore\n      if (typeof this.editLine.cancel === \"function\") {\n        // @ts-ignore\n        this.editLine.cancel();\n      }\n      this.removeDomEvents();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      var _this$props11 = this.props,\n        connectDropTarget = _this$props11.connectDropTarget,\n        showBar = _this$props11.showBar,\n        snapline = _this$props11.snapline;\n      var _this$state4 = this.state,\n        context = _this$state4.context,\n        scaleNum = _this$state4.scaleNum,\n        boxSelectionInfo = _this$state4.boxSelectionInfo,\n        alignmentLines = _this$state4.alignmentLines;\n      var xPos = boxSelectionInfo ? \"\".concat(boxSelectionInfo.x, \",\").concat(boxSelectionInfo.initX) : '';\n      var yPos = boxSelectionInfo ? \"\".concat(boxSelectionInfo.y, \",\").concat(boxSelectionInfo.initY) : '';\n      return connectDropTarget( /*#__PURE__*/React.createElement(\"div\", {\n        className: \"byai-topology\",\n        ref: function ref(r) {\n          _this3.$topology = r;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1672,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        ref: function ref(r) {\n          _this3.$wrapper = r;\n        },\n        className: classnames({\n          \"topology-wrapper\": true,\n          \"topology-linking\": context.linking\n        }),\n        onContextMenu: function onContextMenu(e) {\n          if (e.isTrusted) {\n            e.stopPropagation();\n            e.preventDefault();\n          }\n        },\n        onMouseDown: this.handleMouseDown,\n        onMouseMove: this.handleMouseMove,\n        onMouseUp: this.handleMouseUp,\n        onMouseLeave: this.clearMouseEventData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1677,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        ref: function ref(r) {\n          _this3.$canvas = r;\n        },\n        id: \"topology-canvas\",\n        className: \"topology-canvas topology-zoom\"\n        // @ts-ignore\n        ,\n        style: {\n          width: config.canvas.width,\n          height: config.canvas.height,\n          // @ts-ignore\n          \"--scaleNum\": scaleNum\n        },\n        onClick: this.handleCanvasClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1696,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(Provider, {\n        value: context,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1711,\n          columnNumber: 25\n        }\n      }, this.renderNodes(), this.renderLines(), /*#__PURE__*/React.createElement(Selection, {\n        onClick: function onClick(e) {\n          e.stopPropagation();\n          _this3.setState({\n            boxSelectionInfo: null\n          });\n        },\n        renderTool: typeof this.props.renderBoxSelectionTool === 'function' ? this.props.renderBoxSelectionTool : undefined,\n        toolVisible: this.state.boxSelectionInfo && this.state.boxSelectionInfo.status === 'static',\n        xPos: xPos,\n        yPos: yPos,\n        wrapper: this.$wrapper,\n        visible: !!boxSelectionInfo,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1714,\n          columnNumber: 29\n        }\n      }), snapline !== false && /*#__PURE__*/React.createElement(SnapLine, {\n        alignmentLines: alignmentLines,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 1720,\n          columnNumber: 52\n        }\n      })))), showBar !== false && this.renderToolBars()));\n    }\n  }]);\n  return Topology;\n}(React.Component);\nfunction hover(props, monitor, component) {\n  if (!monitor.getItem()) {\n    return;\n  }\n  var context = component.state.context;\n  var clientOffset = monitor.getClientOffset();\n  var _monitor$getItem = monitor.getItem(),\n    id = _monitor$getItem.id;\n  var type = monitor.getItemType();\n  switch (type) {\n    case NodeTypes.ANCHOR:\n      if (clientOffset) {\n        var nodeId = id.split('-')[0];\n        var parentNode = props.data.nodes.find(function (item) {\n          return item.id === nodeId;\n        });\n        var hasAnchorExistLine = !props.canConnectMultiLines && props.data.lines.find(function (item) {\n          return item.start === id;\n        });\n        if (hasAnchorExistLine || !parentNode || !component.$wrapper) {\n          return;\n        }\n        var startPo = context.activeLine ? context.activeLine.start : computeAnchorPo(\"dom-map-\".concat(id), parentNode);\n        var endPo = computeCanvasPo(clientOffset, component.$wrapper);\n        if (!startPo || !endPo) {\n          return;\n        }\n        var impactNode = component.impactCheck(endPo, startPo, id);\n        component.setContext({\n          impactNode: impactNode,\n          linking: true,\n          activeLine: {\n            type: LineEditType.ADD,\n            origin: null,\n            start: startPo,\n            end: endPo\n          }\n        });\n      }\n      break;\n    case NodeTypes.TEMPLATE_NODE:\n    case NodeTypes.NORMAL_NODE:\n      {\n        var _nodes$filter;\n        var nodes = props.data.nodes;\n        var nodeDom = document.getElementById(\"topology-node-\".concat(id));\n        var ALIGNMENT_THRESHOLD = 2;\n\n        // 计算两个节点之间的距离\n        var getDistance = function getDistance(node1, node2) {\n          var dx = Math.abs(node1.position.x - node2.position.x);\n          var dy = Math.abs(node1.position.y - node2.position.y);\n          return {\n            dx: dx,\n            dy: dy\n          };\n        };\n\n        // 根据两个节点之间的距离信息，判断它们是否在水平或垂直方向上对齐\n        var getAlignment = function getAlignment(node1, node2) {\n          var distance = getDistance(node1, node2);\n          if (distance.dx < ALIGNMENT_THRESHOLD) {\n            return {\n              vertical: true,\n              x: node2.position.x\n            };\n          }\n          if (distance.dy < ALIGNMENT_THRESHOLD) {\n            return {\n              horizontal: true,\n              y: node2.position.y\n            };\n          }\n          return null;\n        };\n        var position = type === NodeTypes.TEMPLATE_NODE ? computeCanvasPo(monitor.getSourceClientOffset(), component.$wrapper) : component.getNodePosition(monitor, nodeDom);\n        var draggedNode = {\n          id: id,\n          position: position\n        };\n\n        // 计算所有节点之间的对齐关系，并更新对齐线的位置信息\n        var newAlignmentLines = {};\n        // 过滤掉当前拖动的节点\n        nodes === null || nodes === void 0 ? void 0 : (_nodes$filter = nodes.filter(function (n) {\n          return n.id !== id;\n        })) === null || _nodes$filter === void 0 ? void 0 : _nodes$filter.forEach(function (node) {\n          var alignment = getAlignment(draggedNode, node);\n          if (alignment) {\n            // 过滤掉因为设置了 ALIGNMENT_THRESHOLD，而重复的辅助线\n            if (alignment.vertical && !Object.keys(newAlignmentLines).some(function (key) {\n              return key.includes(\"line-vertical\");\n            })) {\n              // 垂直线\n              newAlignmentLines[\"line-vertical-\".concat(node.id)] = {\n                left: alignment.x,\n                top: 0,\n                height: \"100%\"\n              };\n            }\n\n            // 水平线\n            if (alignment.horizontal && !Object.keys(newAlignmentLines).some(function (key) {\n              return key.includes(\"line-horizontal\");\n            })) {\n              newAlignmentLines[\"line-horizontal-\".concat(node.id)] = {\n                left: 0,\n                top: alignment.y,\n                width: \"100%\"\n              };\n            }\n          }\n        });\n        component.setAlignmentLines(newAlignmentLines);\n        component.setContext({\n          dragging: true\n        });\n        break;\n      }\n    default:\n      break;\n  }\n}\nexport default DropTarget([NodeTypes.NORMAL_NODE, NodeTypes.TEMPLATE_NODE, NodeTypes.ANCHOR], {\n  canDrop: function canDrop(props) {\n    return !props.readOnly;\n  },\n  hover: _.throttle(hover, 40),\n  drop: function drop(props, monitor, component) {\n    if (monitor.didDrop() || !component.$wrapper) {\n      return;\n    }\n    var item = monitor.getItem();\n    var type = monitor.getItemType();\n    var clientOffset = monitor.getDifferenceFromInitialOffset();\n    if (!clientOffset) {\n      return;\n    }\n\n    /**\n     * Get the mapping relationship between the id and position of all child nodes of the current dragging node\n     * @returns\n     */\n    var getChildPosMap = function getChildPosMap(idList) {\n      var _props$data = props.data,\n        lines = _props$data.lines,\n        nodes = _props$data.nodes;\n      var curNodeList = nodes.filter(function (n) {\n        return idList.indexOf(n.id) > -1;\n      });\n      var childPosMap = {};\n      curNodeList.forEach(function (curNode) {\n        var dragChild = curNode.dragChild || isMatchKeyValue(curNode, 'dragChild', true);\n        if (!dragChild) return null;\n        var childIds = lines.filter(function (n) {\n          return n.start.split('-')[0] === curNode.id;\n        }).map(function (n) {\n          return n.end;\n        });\n        var _iterator = _createForOfIteratorHelper(childIds),\n          _step;\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var childId = _step.value;\n            var childNodeDom = document.getElementById(\"topology-node-\".concat(childId));\n            if (!childNodeDom) return null;\n            childPosMap[childId] = component.getNodePosition(monitor, childNodeDom, true);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n      });\n      return childPosMap;\n    };\n    var position;\n    var nodeDom = document.getElementById(\"topology-node-\".concat(item.id));\n    if (nodeDom) {\n      position = component.getNodePosition(monitor, nodeDom);\n    } else {\n      position = computeCanvasPo(monitor.getSourceClientOffset(), component.$wrapper);\n    }\n    var nodeProps = [[item.id || item && item.data && item.data.id, position]];\n    var isOverlap = function isOverlap(nodeInfo) {\n      return component.validateIsOverlap(nodeInfo);\n    };\n    switch (type) {\n      case NodeTypes.TEMPLATE_NODE:\n        if (!item.data) {\n          return;\n        }\n        var isMultiInfo = item.data.nodes && Array.isArray(item.data.nodes) && item.data.lines && Array.isArray(item.data.lines);\n        /**\n         * TODO：Here first render the newly added node, if it overlaps, delete the node\n         * The main reason is that there is currently no good unified method to get the default width and height of the newly added nodes in the upper layer.\n         */\n        if (isMultiInfo) {\n          nodeProps = [];\n          var minX = Math.min.apply(Math, _toConsumableArray(item.data.nodes.map(function (n) {\n            return n.position.x;\n          })));\n          var minY = Math.min.apply(Math, _toConsumableArray(item.data.nodes.map(function (n) {\n            return n.position.y;\n          })));\n          var offset = {\n            x: position.x - minX,\n            y: position.y - minY\n          };\n          var selectedPositionList = [];\n          item.data.nodes.forEach(function (n) {\n            var newPosition = {\n              x: n.position.x + offset.x,\n              y: n.position.y + offset.y\n            };\n            selectedPositionList.push([n.id, newPosition]);\n          });\n          nodeProps = [].concat(selectedPositionList, _toConsumableArray(nodeProps));\n          var positionMap = new Map(nodeProps);\n          component.onChange(_objectSpread({}, props.data, {\n            nodes: [].concat(_toConsumableArray(props.data.nodes), _toConsumableArray(item.data.nodes.map(function (n) {\n              var newPosition = positionMap.get(n.id);\n              var p = newPosition ? newPosition : n.position;\n              return _objectSpread({}, n, {\n                position: p\n              });\n            }))),\n            lines: [].concat(_toConsumableArray(props.data.lines), _toConsumableArray(item.data.lines))\n          }), ChangeType.ADD_NODE);\n        } else {\n          component.onChange(_objectSpread({}, props.data, {\n            nodes: [].concat(_toConsumableArray(props.data.nodes), [_objectSpread({}, item.data, {\n              position: position\n            })])\n          }), ChangeType.ADD_NODE);\n        }\n        if (isOverlap(nodeProps)) {\n          component.onChange(_objectSpread({}, props.data, {\n            nodes: _toConsumableArray(props.data.nodes),\n            lines: _toConsumableArray(props.data.lines)\n          }), ChangeType.ADD_NODE);\n          props.overlapCallback && props.overlapCallback();\n        }\n        ;\n        component.setAlignmentLines({});\n        component.setContext({\n          dragging: false\n        });\n        break;\n      case NodeTypes.NORMAL_NODE:\n        var targetNodeInfo = props.data.nodes.find(function (node) {\n          return node.id === item.id;\n        });\n        var targetPosition = targetNodeInfo ? targetNodeInfo.position : null;\n        if (targetPosition) {\n          var _offset = {\n            x: position.x - targetPosition.x,\n            y: position.y - targetPosition.y\n          };\n          var selectedIdSet = new Set(component.state.context.selectedData.nodes.map(function (n) {\n            return n.id;\n          }));\n          var _selectedPositionList = [];\n          props.data.nodes.forEach(function (n) {\n            if (selectedIdSet.has(n.id)) {\n              var newPosition = {\n                x: n.position.x + _offset.x,\n                y: n.position.y + _offset.y\n              };\n              _selectedPositionList.push([n.id, newPosition]);\n            }\n          });\n          nodeProps = [].concat(_selectedPositionList, _toConsumableArray(nodeProps));\n        }\n        if (isOverlap(nodeProps)) {\n          props.overlapCallback && props.overlapCallback();\n          component.showBoxSelection();\n          return;\n        }\n        ;\n        component.handleNodeDraw(nodeProps, getChildPosMap(nodeProps.map(function (n) {\n          return n[0];\n        })));\n        component.setAlignmentLines({});\n        component.setContext({\n          dragging: false\n        });\n        // 存在移动动画时间\n        setTimeout(function () {\n          component.showBoxSelection();\n        }, 210);\n        break;\n      case NodeTypes.ANCHOR:\n        component.handleLineDraw(item.id);\n        break;\n      default:\n        break;\n    }\n  }\n}, function (connect) {\n  return {\n    connectDropTarget: connect.dropTarget()\n  };\n})(Topology);",{"version":3,"names":["_regeneratorRuntime","exports","Op","Object","prototype","hasOwn","hasOwnProperty","defineProperty","obj","key","desc","value","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","define","enumerable","configurable","writable","err","wrap","innerFn","outerFn","self","tryLocsList","protoGenerator","Generator","generator","create","context","Context","makeInvokeMethod","tryCatch","fn","arg","type","call","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","_invoke","AsyncIterator","PromiseImpl","invoke","resolve","reject","record","result","_typeof","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","methodName","undefined","return","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","length","i","displayName","isGeneratorFunction","genFun","ctor","constructor","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","iter","keys","val","object","reverse","pop","skipTempReset","prev","charAt","slice","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","_catch","thrown","delegateYield","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","NewTarget","Reflect","construct","arguments","apply","_possibleConstructorReturn","sham","Proxy","Boolean","valueOf","e","React","renderToStaticMarkup","DropTarget","_","classnames","html2canvas","selectNodes","getLinesFromNode","SelectMode","Provider","defaultContext","NodeWrapper","Line","LineText","KeyCode","NodeTypes","ChangeType","LineEditType","computeCanvasPo","impactCheck","computeAnchorPo","computeNodeInputPo","computeContentCenter","computeContentPostionY","createHashFromObjectArray","getNodeSize","shouldAutoLayout","getRealNodeDom","getMaxAndMinNodeId","isInViewPort","computeMaxAndMin","isMatchKeyValue","computeLayout","deleteSelectedData","config","Selection","SnapLine","MAX_SCALE","MIN_SCALE","DRAG_CLASS","initialTopologyState","scaleNum","draggingId","loading","alignmentLines","Topology","_React$Component","_inherits","_super","props","_this","_classCallCheck","$topology","$wrapper","$canvas","nodeSizeCache","dragCanvasPo","onChange","data","defaultScaleNum","clearSelectedWhenClickOutside","contains","target","clearSelectData","zoomIn","setState","prevState","setDraggingId","zoomOut","resetScale","_assertThisInitialize","_assertThisInitialized","scrollCanvasToCenter","canvasSize","wrapperSize","contentCenter","nodes","canvasCenter","x","width","y","height","defaultScrollTop","defaultScrollLeft","scrollTop","scrollLeft","scrollCanvasToPositionY","contentPosition","customPostionHeight","cacheNodeSize","reduce","pre","cur","_objectSpread","_defineProperty","id","endPo","startPo","_this$props$data","lines","impactNode","find","item","position","hasExistSameLine","start","end","canConnect","_this$state$context$s","selectedData","setContext","onSelect","autoLayout","_this$props","sortChildren","LAYOUT","initDomEvents","window","addEventListener","handleKeydown","removeDomEvents","removeEventListener","getBoundary","elements","minX","Infinity","minY","maxX","maxY","_e$getBoundingClientR","getBoundingClientRect","Math","min","max","getRealNodeDomByIdList","ids","map","generateBoxByRealSelectedNodeDom","offset","boundary","realDragNodeDomList","setTimeout","generateBoxByBoundary","boxSelectionInfo","initX","initY","status","generateBoxBySelectedNode","n","_ref","_ref$classList","classList","keyCode","BACKSPACE","DELETE","deleteItem","closeBoxSelection","callback","refreshSelectNode","idSet","Set","newNodeInfo","filter","has","newInfo","selectNode","node","mode","_this$props2","selectNodesId","RIGHT_NORMAL","indexOf","selectData","BOX_SELECTION","selectNodesForSelection","selectLine","dragCanvas","clientX","clientY","dX","dY","editLine","activeLine","clientPo","EDIT_START","handleHoverCurrentNode","hoverCurrentNode","isSelected","some","clearHoverCurrentNode","handleMouseDown","button","itemType","getAttribute","className","getClickType","EDIT_END","includes","add","readOnly","jsonStr","_JSON$parse","JSON","parse","origin","po","linking","console","log","handleMouseMove","persist","isEditingLine","isDraggingCanvas","remove","samePostionLinesLength","curLine","split","getLineRepeatIndex","startPointAnchorId","index","inSelection","selectionPositionGroup","nodePositionGroup","_selectionPositionGro","_slicedToArray","selectionLeftTopPosition","selectionRightBottomPosition","_nodePositionGroup","nodeLeftTopPosition","nodeRightBottomPosition","getBoxPositionGroup","_this$state$boxSelect","getNodeDomList","_toConsumableArray","querySelectorAll","getCombineNode","combineId","getShouldSelectedNodeList","boxPositionGroup","ret","nativeNodeList","selectedNodeList","nodeList","nodePositionLeftTop","nodePositionRightBottom","combineIdSet","dataset","combineIdList","shouldSelectedNodeIdList","firstChild","line","couldDispatchContextMenuEvent","abs","boxVisibleFlag","showBoxSelection","handleMouseUp","_this$props3","screenX","screenY","buttons","shouldOpenContextMenuFlag","isMultiClick","ctrlKey","metaKey","shiftKey","isDragBox","isEmitByNodeWrapper","currentTarget","document","body","parentElement","mouseEvent","MouseEvent","bubbles","cancelable","dispatchEvent","_this$getShouldSelect","lineList","_this$state$context","isLineEdit","ADD","_ref2","repeatIndex","getNewline","isEqual","EDIT_LINE","clearMouseEventData","handleLineDraw","startId","_this$props4","lineColor","newLine","alreadyExist","anchor","colorMap","color","concat","ADD_LINE","handleNodeDraw","nodeInfoList","childPosMap","posMaps","curr","_curr","nodeId","handleCanvasClick","renderNodes","_this$props5","_this$props5$data","renderTreeNode","isReduceRender","prevNodeStyle","selectedNodes","_this$state","lineHash","_objectSpread5","_start$split","_start$split2","parent","createElement","onMouseEnter","onMouseLeave","isolated","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","wrapperOptions","renderDomMap","domMap","querySelector","setAttribute","innerHTML","anchorDecorator","_ref3","anchorId","_item","appendChild","renderLines","_this$props6","_this$props6$data","lineTextMap","lineOffsetY","lineTextColor","lineLinkageHighlight","lineTextDecorator","showText","_this$state$context2","nodeHash","isEditing","isHighLight","getLineStartPo","getLineEndPo","getTextXY","defaultTextEl","style","fill","Fragment","selected","highLight","assign","findScale","_ref4","_asyncToGenerator","_callee","clonegraph","downloadScale","canvasEle","_getMaxAndMinNodeId","minXId","maxXId","minYId","maxYId","minYIdElement","isAllView","isViw","_callee$","_context","Number","toFixed","transform","scrollIntoView","block","minxIdView","maxxIdView","minYIdView","maxYIdView","_x","downloadImg","_ref5","_callee2","scopeType","openDownload","imgName","_this$state2","isGlobal","graphEl","imgBase64","_computeMaxAndMin","imgPadding","imgMinSize","_callee2$","_context2","onclone","documentClone","nodeContentEls","getElementsByClassName","Array","from","childNode","childNodes","grandsonChildNode","backgroundColor","border","boxShadow","_getMaxAndMinNodeId2","getElementById","inline","useCORS","scale","canvas","toDataURL","a","href","download","click","_x2","_x3","_x4","getImageBase64Url","_callee3","url","_callee3$","_context3","getImageBase64UrlWithSelectedData","_callee4","_callee4$","_context4","locateNodeById","curNode","ele","SINGLE","renderToolBars","_this$state3","_this$props7","showCenter","showLayout","showDownload","customToolboxList","zoomPercent","parseInt","String","exportStyle","cursor","onClick","src","alt","_callee5","_callee5$","_context5","isArray","_ref9","_ref9$wrapperProps","wrapperProps","content","tooltip","handleSelectAll","_this$props8","handleDeselectAll","validateIsOverlap","nodeInfo","_this$props9","overlap","_this$props9$overlapO","overlapOffset","nodePosMap","Map","_ref10","_ref11","pos","set","getNodeOffsetPos","offsetX","offsetY","posMap","filterOverlap","T1","T2","isOverlap","_ref12","_ref13","S1","S2","p","multiValidateIsOverlap","drawId","setRealDragNodeDomList","element","setAlignmentLines","getNodePosition","monitor","nodeDom","isChild","clientOffset","getDifferenceFromInitialOffset","nodePosition","top","left","scalePosition","replace","scrollPosition","getSourceClientOffset","_createClass","componentWillMount","autoClearSelectedFn","getAutoClearSelectedFn","componentDidMount","_this2","_this$props10","getInstance","throttle","autoRemoveSelected","componentWillReceiveProps","nextProps","nextReadOnly","componentDidUpdate","componentWillUnmount","cancel","render","_this3","_this$props11","connectDropTarget","showBar","snapline","_this$state4","xPos","yPos","ref","r","onContextMenu","isTrusted","stopPropagation","preventDefault","onMouseDown","onMouseMove","onMouseUp","renderTool","renderBoxSelectionTool","toolVisible","wrapper","visible","Component","hover","component","getItem","getClientOffset","_monitor$getItem","getItemType","ANCHOR","parentNode","hasAnchorExistLine","canConnectMultiLines","TEMPLATE_NODE","NORMAL_NODE","_nodes$filter","ALIGNMENT_THRESHOLD","getDistance","node1","node2","dx","dy","getAlignment","distance","vertical","horizontal","draggedNode","newAlignmentLines","alignment","dragging","canDrop","drop","didDrop","getChildPosMap","idList","_props$data","curNodeList","dragChild","childIds","_iterator","_createForOfIteratorHelper","_step","s","childId","childNodeDom","f","nodeProps","isMultiInfo","selectedPositionList","newPosition","positionMap","get","ADD_NODE","overlapCallback","targetNodeInfo","targetPosition","selectedIdSet","connect","dropTarget"],"sources":["/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/topology/index.tsx"],"sourcesContent":["/* eslint-disable */\nimport React, { HTMLAttributes } from 'react';\nimport { renderToStaticMarkup } from 'react-dom/server';\nimport { DropTarget, ConnectDropTarget } from 'react-dnd';\nimport _ from 'lodash';\nimport classnames from 'classnames';\nimport html2canvas from 'html2canvas';\nimport selectNodes, { getLinesFromNode, SelectMode } from '../../utils/selectNodes';\nimport { Provider, defaultContext } from '../context';\nimport NodeWrapper from '../node-wrapper';\nimport Line from '../line';\nimport LineText from '../line/lineText';\n\nimport {\n    KeyCode,\n    NodeTypes,\n    IPosition,\n    ITopologyNode,\n    ITopologyLine,\n    IWrapperOptions,\n    ITopologyData,\n    ITopologyContext,\n    // eslint-disable-next-line import/named\n    ValuesOf,\n    ChangeType,\n    LineEditType,\n} from '../../declare';\nimport {\n    computeCanvasPo,\n    impactCheck,\n    computeAnchorPo,\n    computeNodeInputPo,\n    computeContentCenter,\n    computeContentPostionY,\n    createHashFromObjectArray,\n    getNodeSize,\n    shouldAutoLayout,\n    getRealNodeDom,\n    getMaxAndMinNodeId,\n    isInViewPort,\n    computeMaxAndMin,\n    isMatchKeyValue,\n} from '../../utils';\n// import layoutCalculation from '../../utils/layoutCalculation';\nimport computeLayout from '../../utils/computeLayout';\nimport deleteSelectedData from '../../utils/deleteSelectedData';\nimport config from '../../config';\nimport './index.less';\nimport Selection from '../selection';\nimport SnapLine from '../snapline';\n\nexport interface ITopologyProps {\n    data: ITopologyData; // 数据 { nodes: []; lines: [] }\n    readOnly?: boolean; // 只读模式，为true时不可编辑\n    snapline?: boolean; // 是否显示辅助对齐线，默认现实\n    showBar?: boolean; // 是否显示工具栏\n    showCenter?: boolean; // 是否显示工具栏中的定位中心\n    showLayout?: boolean; // 是否显示工具栏中的自动布局\n    showDownload?: boolean; // 是否显示工具栏中的下载图片\n    downloadImg?: (scopeType?: 'global' | 'selected', download?: boolean, name?: string) => void;\n    canConnectMultiLines?: boolean; // 控制一个锚点是否可以连接多条线\n    overlap?: boolean; // 是否允许节点覆盖，默认允许，设置 true 时不允许\n    overlapCallback?: () => void; // overlap 回调\n    overlapOffset?: {\n        offsetX?: number;\n        offsetY?: number;\n    };\n    prevNodeStyle?: {\n        // 暂时支持这两个属性\n        border?: string;\n        background?: string;\n    };\n    isReduceRender?: boolean;\n    autoLayout?: boolean; // 自动布局，当数据中没有position属性时将自动计算布局。\n    customPostionHeight?: number; // 当设置 customPostionHeight 时，画布距离顶部 customPostionHeight\n    lineLinkageHighlight?: boolean; // hover 节点线条是否联动高亮\n    lineColor?: {\n        [x: string]: string;\n    }; // 线条颜色映射对象 eg: {'锚点1': '#82BEFF', '锚点2': '#FFA39E'}\n    lineTextColor?: {\n        [x: string]: string;\n    }; // 线条上文字颜色映射对象 eg: {'锚点1': '#82BEFF', '锚点2': '#FFA39E'}\n    lineOffsetY?: number; // 线条起始点向上偏移量\n    startPointAnchorId?: string; // 保持所有线条起始点与 startPointAnchorId 线条一致\n    lineTextMap?: {\n        [x: string]: string; // 线条上文字与 anchorId 映射对象 eg: {'anchorId1': '锚点1', 'anchorId2': '锚点2'}\n    };\n    scaleNum: number;\n    showText?: (start: string) => boolean;\n    lineTextDecorator?: (text: {\n        x: number;\n        y: number;\n    }, line: ITopologyLine) => React.ReactNode;\n    onChange?: (data: ITopologyData, type: ChangeType) => void;\n    onSelect?: (data: ITopologyData) => void;\n    getInstance?: (instance: Topology) => void; // 返回组件实例，用于调用组件内部的方法。\n    renderTreeNode?: (data: ITopologyNode, wrappers: IWrapperOptions) => React.ReactNode;\n    sortChildren?: (parent: ITopologyNode, children: ITopologyNode[]) => ITopologyNode[];\n    connectDropTarget?: ConnectDropTarget;\n    /** 组合节点 */\n    hasCombineNode?: boolean;\n    combineIdSet?: Set<string>;\n    cancelCombine?: (id: string) => void;\n    combineNode?: (ids: string[]) => string;\n    onShowMenu?: () => void;\n    renderBoxSelectionTool?: () => React.ReactNode;\n    autoRemoveSelected?: boolean | ((e: MouseEvent) => void);\n    customToolboxList?: { wrapperProps?: HTMLAttributes<HTMLDivElement>; content: React.ReactNode; tooltip: string; }[];\n}\n\nexport interface ITopologyState {\n    context: ITopologyContext;\n    scaleNum: number;\n    boxSelectionInfo: {\n        initX: number;\n        initY: number;\n        x: number;\n        y: number;\n        status?: 'drag' | 'static' | 'none';\n    } | undefined;\n    draggingId: string;\n    realDragNodeDomList?: Element[] | null;\n    boxVisibleFlag?: boolean;\n    loading: boolean;\n    alignmentLines: any;\n}\n\ninterface NodeSizeCache {\n    [id: string]: { width: number; height: number };\n}\n\ninterface IPosMap {\n    T1: {\n        x: number;\n        y: number;\n    };\n    T2: {\n        x: number;\n        y: number;\n    };\n}\n\nconst MAX_SCALE = 2;\nconst MIN_SCALE = 0.1;\nconst DRAG_CLASS = 'topology-canvas-drag';\nconst initialTopologyState = {\n    context: defaultContext,\n    scaleNum: 1,\n    draggingId: null,\n    loading: false,\n    alignmentLines: {}\n} as ITopologyState;\n\nclass Topology extends React.Component<ITopologyProps, ITopologyState> {\n    $topology: HTMLDivElement | null;\n\n    $wrapper: HTMLDivElement | null;\n\n    $canvas: HTMLDivElement | null;\n\n    nodeSizeCache: NodeSizeCache = {};\n\n    state: ITopologyState = initialTopologyState;\n\n    dragCanvasPo: IPosition | null = null;\n\n    shouldAutoLayout: boolean = false;\n\n\n    constructor(props: ITopologyProps) {\n        super(props);\n        this.shouldAutoLayout = shouldAutoLayout(props.data.nodes);\n    }\n\n    componentWillMount() {\n        this.renderDomMap();\n        const autoClearSelectedFn = this.getAutoClearSelectedFn();\n        if (autoClearSelectedFn) {\n            document.body.removeEventListener('click', autoClearSelectedFn);\n        }\n    }\n\n    componentDidMount() {\n        const {\n            getInstance, readOnly, customPostionHeight, scaleNum\n        } = this.props;\n        this.editLine = _.throttle(this.editLine, 40);\n        if (!readOnly) {\n            this.initDomEvents();\n        }\n\n        if (this.$wrapper) {\n            // 自定义节点距离画布顶部高度\n            if (customPostionHeight) {\n                this.scrollCanvasToPositionY();\n            } else {\n                this.scrollCanvasToCenter();\n            }\n            const autoClearSelectedFn = this.getAutoClearSelectedFn();\n            if (autoClearSelectedFn) {\n                document.body.addEventListener('click', autoClearSelectedFn);\n            }\n        }\n\n        if (this.shouldAutoLayout) {\n            this.shouldAutoLayout = false;\n            this.autoLayout();\n        }\n\n        if (getInstance) {\n            getInstance(this);\n        }\n\n        this.setState(() => {\n            this.scaleNum = scaleNum === undefined ? 1 : scaleNum;\n            // 记录默认缩放的值，resetScale 时候用\n            this.defaultScaleNum = this.scaleNum;\n            return { scaleNum };\n        });\n    }\n\n    getAutoClearSelectedFn() {\n        // eslint-disable-next-line react/destructuring-assignment\n        if (!this.props.autoRemoveSelected) {\n            return undefined;\n        }\n        // eslint-disable-next-line react/destructuring-assignment\n        return typeof this.props.autoRemoveSelected === 'function' ? this.props.autoRemoveSelected : this.clearSelectedWhenClickOutside;\n    }\n\n    componentWillReceiveProps(nextProps: ITopologyProps) {\n        const { readOnly } = this.props;\n        const { readOnly: nextReadOnly } = nextProps;\n        this.renderDomMap(nextProps);\n        this.shouldAutoLayout = shouldAutoLayout(nextProps.data.nodes);\n        if (readOnly && !nextReadOnly) {\n            this.initDomEvents();\n        }\n        if (!readOnly && nextReadOnly) {\n            this.removeDomEvents();\n        }\n    }\n\n    componentDidUpdate() {\n        if (this.shouldAutoLayout) {\n            this.shouldAutoLayout = false;\n            this.autoLayout();\n        }\n    }\n\n    componentWillUnmount() {\n        // @ts-ignore\n        if (typeof this.editLine.cancel === \"function\") {\n            // @ts-ignore\n            this.editLine.cancel();\n        }\n\n        this.removeDomEvents();\n    }\n\n    onChange = (data: ITopologyData, type: ChangeType) => {\n        const { onChange } = this.props;\n        if (!onChange) {\n            return;\n        }\n        onChange(data, type);\n    };\n\n    defaultScaleNum = 1;\n\n    scaleNum = 1;\n\n    clearSelectedWhenClickOutside = (e: MouseEvent) => {\n        if (this.$topology.contains(e.target as Node)) {\n            return;\n        }\n        this.clearSelectData();\n    }\n\n    zoomIn = () => {\n        this.setState((prevState: ITopologyState) => {\n            const scaleNum = prevState.scaleNum > MIN_SCALE + 0.1 ? prevState.scaleNum - 0.1 : MIN_SCALE;\n            this.scaleNum = scaleNum;\n            return { scaleNum };\n        });\n        this.setDraggingId(null);\n    };\n\n    zoomOut = () => {\n        this.setState((prevState: ITopologyState) => {\n            const scaleNum = prevState.scaleNum < MAX_SCALE ? prevState.scaleNum + 0.1 : MAX_SCALE;\n            this.scaleNum = scaleNum;\n            return { scaleNum };\n        });\n        this.setDraggingId(null);\n    };\n\n    resetScale = () => {\n        this.setState(() => {\n            const { defaultScaleNum } = this;\n            this.scaleNum = defaultScaleNum;\n            return { scaleNum: defaultScaleNum };\n        });\n        this.setDraggingId(null);\n    }\n\n    scrollCanvasToCenter = () => {\n        if (!this.$wrapper || !this.$canvas) {\n            return;\n        }\n        this.resetScale();\n        const canvasSize = getNodeSize(this.$canvas);\n        const wrapperSize = getNodeSize(this.$wrapper);\n        const contentCenter = computeContentCenter(this.props.data.nodes);\n        const canvasCenter = {\n            x: canvasSize.width / 2,\n            y: canvasSize.height / 2\n        };\n        const defaultScrollTop = (canvasSize.height - wrapperSize.height) / 2;\n        const defaultScrollLeft = (canvasSize.width - wrapperSize.width) / 2;\n        if (!contentCenter) {\n            this.$wrapper.scrollTop = defaultScrollTop;\n            this.$wrapper.scrollLeft = defaultScrollLeft;\n        } else {\n            this.$wrapper.scrollTop = defaultScrollTop + (contentCenter.y - canvasCenter.y);\n            this.$wrapper.scrollLeft = defaultScrollLeft + (contentCenter.x - canvasCenter.x);\n        }\n    };\n\n    /**\n     *  定位至画布顶部距离\n     * @returns\n     */\n    scrollCanvasToPositionY = () => {\n        if (!this.$wrapper || !this.$canvas) {\n            return;\n        }\n        this.resetScale();\n        const canvasSize = getNodeSize(this.$canvas);\n        const wrapperSize = getNodeSize(this.$wrapper);\n        const contentPosition = computeContentPostionY(this.props.data.nodes);\n        const canvasCenter = {\n            x: canvasSize.width / 2,\n            y: canvasSize.height / 2\n        };\n        const defaultScrollTop = (canvasSize.height - wrapperSize.height) / 2;\n        const defaultScrollLeft = (canvasSize.width - wrapperSize.width) / 2;\n        if (!contentPosition) {\n            this.$wrapper.scrollTop = defaultScrollTop;\n            this.$wrapper.scrollLeft = defaultScrollLeft;\n        } else {\n            this.$wrapper.scrollTop = contentPosition.y - this.props.customPostionHeight;\n            this.$wrapper.scrollLeft = defaultScrollLeft + (contentPosition.x - canvasCenter.x);\n        }\n    };\n\n    cacheNodeSize = () => {\n        const {\n            data: { nodes }\n        } = this.props;\n        // 已节点id为键值，缓存节点的宽和高，避免碰撞检测时频繁操作DOM\n        this.nodeSizeCache = nodes.reduce(\n            (pre: NodeSizeCache, cur: ITopologyNode) => ({\n                ...pre,\n                [cur.id]: getNodeSize(cur.id)\n            }),\n            {}\n        );\n    };\n\n    impactCheck = (endPo: IPosition, startPo: IPosition, id?: string) => {\n        const {\n            data: { nodes, lines }\n        } = this.props;\n        const impactNode = nodes.find((item) => {\n            if (!this.nodeSizeCache[item.id]) {\n                this.nodeSizeCache[item.id] = getNodeSize(item.id);\n            }\n            return (\n                this.nodeSizeCache[item.id]\n                && impactCheck(\n                    endPo,\n                    this.nodeSizeCache[item.id],\n                    item.position as IPosition\n                )\n            );\n        });\n        // 起点和终点是同一节点\n        if (\n            impactNode\n            && impactCheck(\n                startPo,\n                this.nodeSizeCache[impactNode.id],\n                impactNode.position as IPosition\n            )\n        ) {\n            return null;\n        }\n\n        // 线已存在情况下\n        const hasExistSameLine = impactNode && lines.find(item => item.start === id && item.end === impactNode.id);\n        if (hasExistSameLine) return null;\n\n        // 节点不可被连接\n        if (impactNode && impactNode.canConnect === false) return null;\n\n        return impactNode ? impactNode.id : null;\n    };\n\n    clearSelectData = () => {\n        const {\n            nodes, lines\n        } = this.state.context.selectedData;\n        if (nodes?.length === 0 && lines?.length === 0) return;\n        this.setContext({ selectedData: { nodes: [], lines: [], }}, () => {\n            const { onSelect } = this.props;\n            if (onSelect) {\n                onSelect(this.state.context.selectedData);\n            }\n        });\n\n    }\n\n    autoLayout = () => {\n        const { data, sortChildren } = this.props;\n        this.resetScale();\n        this.onChange(\n            {\n                ...data,\n                nodes: computeLayout(data, { sortChildren })\n            },\n            ChangeType.LAYOUT\n        );\n        this.clearSelectData(); // refresh\n    };\n\n    initDomEvents = () => {\n        window.addEventListener(\"keydown\", this.handleKeydown);\n    };\n\n    removeDomEvents = () => {\n        window.removeEventListener(\"keydown\", this.handleKeydown);\n    };\n\n    getBoundary = (elements: Element[]) => {\n        let minX = Infinity;\n        let minY = Infinity;\n        let maxX = -Infinity;\n        let maxY = -Infinity;\n        elements.forEach(e => {\n            const { x, y, height, width } = e.getBoundingClientRect();\n            minX = Math.min(x, minX);\n            minY = Math.min(y, minY);\n            maxX = Math.max(x + width, maxX);\n            maxY = Math.max(y + height, maxY);\n        });\n        return {\n            minX,\n            minY,\n            maxX,\n            maxY\n        }\n    }\n\n    getRealNodeDomByIdList = (ids: string[]) => {\n        return ids.map(getRealNodeDom)\n    }\n\n\n\n    generateBoxByRealSelectedNodeDom = (elements: Element[] | null, offset=3) => {\n        const boundary = this.getBoundary(elements || this.state.realDragNodeDomList);\n        setTimeout(() => {\n            this.generateBoxByBoundary(boundary, offset)\n        }, 0)\n    }\n\n    generateBoxByBoundary = (boundary: { minX: number; minY: number; maxX: number; maxY: number }, offset=3) => {\n        const { minX, minY, maxX, maxY } = boundary;\n        this.setState({\n            boxSelectionInfo: {\n                initX: minX - offset,\n                initY: minY - offset,\n                x: maxX + offset,\n                y: maxY + offset,\n                status: 'static',\n            }\n        })\n    }\n\n    generateBoxBySelectedNode = (nodes?: ITopologyNode[], offset?: number) => {\n        nodes = nodes || this.state.context.selectedData.nodes;\n        offset = offset || 3;\n        if (nodes.length === 0) {\n            this.setState({\n                boxSelectionInfo: null\n            })\n            return;\n        }\n        this.generateBoxByRealSelectedNodeDom(this.getRealNodeDomByIdList(nodes.map(n => n.id)), offset);\n    }\n\n    handleKeydown = (e: KeyboardEvent) => {\n        // eslint-disable-next-line\n        const { classList = [] } = e.target as any;\n        // 左侧的搜索输入框回删事件不触发话术更改\n        if (classList[0] === \"ant-input\") {\n            return;\n        }\n        switch (e.keyCode) {\n            case KeyCode.BACKSPACE:\n            case KeyCode.DELETE:\n                this.deleteItem();\n                break;\n            default:\n                break;\n        }\n    };\n\n    deleteItem = () => {\n        const { data } = this.props;\n        const { selectedData } = this.state.context;\n        this.onChange(\n            deleteSelectedData(data, selectedData),\n            ChangeType.DELETE\n        );\n        this.closeBoxSelection();\n    };\n\n    setDraggingId = (id) => {\n        this.setState({\n            draggingId: id,\n        });\n    }\n\n    setContext = (values: ValuesOf<ITopologyContext>, callback?: Function) => {\n        const { context } = this.state;\n        this.setState({ context: { ...context, ...values } }, () => {\n            if (callback) {\n                callback();\n            }\n        });\n    };\n\n    refreshSelectNode = (data: ITopologyData) => {\n        const {\n            context: { selectedData }\n        } = this.state;\n        const onSelect = this.props.onSelect;\n        const idSet = new Set(selectedData.nodes.map(item => item.id));\n        const newNodeInfo = data.nodes.filter(n => idSet.has(n.id));\n        const newInfo = {\n            nodes: newNodeInfo,\n            lines: selectedData.lines,\n        };\n        this.setContext({\n            selectedData: newInfo,\n        }, () => {\n            if (onSelect) {\n                onSelect(newInfo);\n            }\n        })\n    }\n\n    selectNode = (node: ITopologyNode, mode: SelectMode) => {\n        const { data, onSelect } = this.props;\n        const {\n            context: { selectedData }\n        } = this.state;\n        const selectNodesId = selectedData.nodes.map(item => item.id);\n        if (\n            mode === SelectMode.RIGHT_NORMAL\n            && selectNodesId.indexOf(node.id) !== -1\n        ) {\n            onSelect(selectedData);\n            return selectedData;\n        }\n        const selectData = selectNodes({ data, selectedData })({\n            node,\n            mode\n        });\n        this.setContext(\n            {\n                selectedData: selectData,\n            },\n            () => {\n                if (mode === SelectMode.BOX_SELECTION) {\n                    this.generateBoxBySelectedNode(this.state.context.selectedData.nodes);\n                }\n                if (onSelect) {\n                    onSelect(this.state.context.selectedData);\n                }\n            }\n        );\n        return selectData;\n    };\n\n    selectNodesForSelection = () => {\n\n    }\n\n    selectLine = (data: ITopologyData) => {\n        this.setContext(\n            {\n                selectedData: data\n            },\n            () => {\n                const { onSelect } = this.props;\n                if (onSelect) {\n                    onSelect(this.state.context.selectedData);\n                }\n            }\n        );\n    };\n\n    dragCanvas = (clientX: number, clientY: number) => {\n        if (!this.$wrapper) {\n            return;\n        }\n        const dX = this.dragCanvasPo!.x - clientX;\n        const dY = this.dragCanvasPo!.y - clientY;\n        this.dragCanvasPo = { x: clientX, y: clientY };\n        this.$wrapper.scrollTop = this.$wrapper.scrollTop + dY;\n        this.$wrapper.scrollLeft = this.$wrapper.scrollLeft + dX;\n    };\n\n    editLine = (clientX: number, clientY: number) => {\n        const { activeLine } = this.state.context;\n        if (!this.$wrapper || !activeLine) {\n            return;\n        }\n\n        const clientPo = computeCanvasPo(\n            {\n                x: clientX,\n                y: clientY,\n            },\n            this.$wrapper\n        );\n        const impactNode = this.impactCheck(\n            clientPo,\n            activeLine![\n                activeLine.type === LineEditType.EDIT_START ? \"end\" : \"start\"\n            ]\n        );\n        this.setContext({\n            impactNode,\n            activeLine: {\n                ...activeLine,\n                [activeLine.type]: clientPo\n            }\n        });\n    };\n\n    handleHoverCurrentNode = (node) => {\n        this.setContext({\n            hoverCurrentNode: node\n        });\n    }\n\n    isSelected = (id: string) => {\n        const {\n            context: { selectedData }\n        } = this.state;\n        return selectedData.nodes.some(item => item.id === id);\n    }\n\n    clearHoverCurrentNode = () => {\n        this.setContext({\n            hoverCurrentNode: null\n        });\n    }\n\n\n    handleMouseDown = (\n        e: React.MouseEvent<HTMLDivElement | SVGCircleElement>\n    ) => {\n        if (e.button === 2) { // 检查是否右键\n            this.setState({\n                boxSelectionInfo: {\n                    initX: e.clientX,\n                    initY: e.clientY,\n                    x: e.clientX,\n                    y: e.clientY,\n                    status: 'drag',\n                }\n            });\n            return;\n        }\n        // @ts-ignore\n        const itemType = e.target.getAttribute(\"data-type\");\n        // @ts-ignore\n        const { className } = e.target;\n        const getClickType = () => {\n            // @ts-ignore\n            if (\n                // @ts-ignore\n                [LineEditType.EDIT_START, LineEditType.EDIT_END].includes(\n                    itemType || \"\"\n                )\n            ) {\n                return \"CLICK_LINE_POINT\";\n            } else if (\n                typeof className === \"string\"\n                && className.includes(\"topology-canvas\")\n            ) {\n                return \"CLICK_CANVAS\";\n            }\n            return \"\";\n        };\n        switch (getClickType()) {\n            case \"CLICK_CANVAS\":\n                this.dragCanvasPo = { x: e.clientX, y: e.clientY };\n                // this.$topology\n                this.$canvas.classList.add(DRAG_CLASS);\n                break;\n            case \"CLICK_LINE_POINT\":\n                if (this.props.readOnly) {\n                    break;\n                }\n                try {\n                    // @ts-ignore\n                    const jsonStr = e.target.getAttribute(\"data-json\");\n                    if (typeof jsonStr !== \"string\" || !jsonStr) {\n                        throw new Error(\"线段起点无数据\");\n                    }\n                    const { origin, po } = JSON.parse(jsonStr);\n                    this.setContext({\n                        linking: true,\n                        activeLine: {\n                            origin,\n                            start: po.start,\n                            end: po.end,\n                            type: itemType\n                        }\n                    });\n                } catch (err) {\n                    // eslint-disable-next-line no-console\n                    console.log(err);\n                }\n                break;\n            default:\n                break;\n        }\n    };\n\n    handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\n        e.persist();\n        if (!!this.state.boxSelectionInfo && this.state.boxSelectionInfo.status === 'drag') {\n            this.setState((prev) => {\n                return {\n                    boxSelectionInfo: {\n                        ...prev.boxSelectionInfo,\n                        x: e.clientX,\n                        y: e.clientY,\n                    }\n                }\n            });\n            return;\n        }\n        const { activeLine } = this.state.context;\n        // @ts-ignore\n        const isEditingLine = activeLine\n            // @ts-ignore\n            && [LineEditType.EDIT_START, LineEditType.EDIT_END].includes(\n                activeLine.type\n            );\n        const isDraggingCanvas = this.dragCanvasPo;\n        if (!isDraggingCanvas) {\n            this.$canvas.classList.remove(DRAG_CLASS);\n        }\n        if (!isEditingLine && !isDraggingCanvas) {\n            return;\n        }\n        if (isDraggingCanvas) {\n            this.dragCanvas(e.clientX, e.clientY);\n        }\n        if (isEditingLine && !this.props.readOnly) {\n            this.editLine(e.clientX, e.clientY);\n        }\n    };\n\n    samePostionLinesLength = (curLine: ITopologyLine): number => {\n        const {\n            data: { lines },\n        } = this.props;\n        return lines && lines.filter(item => item.start.split('-')[0] === curLine.start.split('-')[0] && item.end === curLine.end).length;\n    }\n\n    getLineRepeatIndex = (curLine): {\n        index?: number;\n    } => {\n        const {\n            startPointAnchorId,\n        } = this.props;\n        // 所有线条起始点与 startPointAnchorId 线条一致情况下，增加线条位置重复次数属性\n        const index = startPointAnchorId !== undefined && this.samePostionLinesLength(curLine) ? { index: this.samePostionLinesLength(curLine) } : {};\n        return index;\n    }\n\n    inSelection = (selectionPositionGroup: [IPosition, IPosition], nodePositionGroup: [IPosition, IPosition]) => {\n        const [selectionLeftTopPosition, selectionRightBottomPosition] = selectionPositionGroup;\n        const [nodeLeftTopPosition, nodeRightBottomPosition] = nodePositionGroup;\n        return (\n            nodeLeftTopPosition.x > selectionLeftTopPosition.x\n            && nodeLeftTopPosition.y > selectionLeftTopPosition.y\n            && nodeRightBottomPosition.x < selectionRightBottomPosition.x\n            && nodeRightBottomPosition.y < selectionRightBottomPosition.y\n        );\n    }\n\n    getBoxPositionGroup = () => {\n        if (!this.state.boxSelectionInfo) {\n            return undefined;\n        }\n        const {\n            boxSelectionInfo: {\n                initX,\n                initY,\n                x,\n                y\n            }\n        } = this.state;\n        const selectionLeftTopPosition = {\n            x: Math.min(initX, x),\n            y: Math.min(initY, y),\n        }\n        const selectionRightBottomPosition = {\n            x: Math.max(initX, x),\n            y: Math.max(initY, y),\n        }\n        return [selectionLeftTopPosition, selectionRightBottomPosition] as [IPosition, IPosition];\n    }\n\n    getNodeDomList = () => {\n        return [...(this.$canvas.querySelectorAll('[id^=\"topology-node-\"]') as any)] as Element[];\n    }\n\n    getCombineNode = (combineId: string) => {\n        if (!combineId) {\n            return [];\n        }\n        return this.props.data.nodes.filter(item => item.combineId === combineId);\n    }\n\n    // getShouldSelectedNodeList函数：获取框选中的节点列表\n    getShouldSelectedNodeList = () => {\n        // Step 1: 获取box(矩形选择框)的位置信息(boxPositionGroup)和需要筛选的DOM列表(nodeList)\n        const boxPositionGroup = this.getBoxPositionGroup();\n        const ret = {\n            nativeNodeList: [] as Element[],\n            selectedNodeList: [] as ITopologyNode[],\n            boxPositionGroup,\n        }\n\n        // 如果没有筛选框的位置信息，则直接返回空；否则，获取框选中的节点列表进行下一步处理\n        if (!boxPositionGroup) {\n            return ret;\n        }\n        const nodeList: Element[] = this.getNodeDomList();\n\n        // Step 2: 筛选出所有与box相交的节点(nativeNodeList)，以及属于这些节点所属的整合组合的集合(combineIdSet)\n        const nativeNodeList = nodeList.filter(node => {\n            const info = node.getBoundingClientRect();\n            const nodePositionLeftTop: IPosition = {\n                x: info.x,\n                y: info.y,\n            }\n            const nodePositionRightBottom = {\n                x: info.x + info.width,\n                y: info.y + info.height,\n            }\n            const nodePositionGroup: [IPosition, IPosition] = [nodePositionLeftTop, nodePositionRightBottom];\n            return this.inSelection(boxPositionGroup, nodePositionGroup);\n        }) as HTMLElement [];\n        const combineIdSet = new Set(nativeNodeList.map(node => node.dataset.combineId).filter(id => !!id)); // 把每个有'data-combine-id'属性的HTML节点转化为数组后，筛选出仅由combileId的(无重复)集合combineIdSet\n\n        // Step 3: 将筛选后的结果flat化、去重和拼接之后，以id形式存储在shouldSelectedNodeIdList中\n        const combineIdList = [];\n        combineIdSet.forEach(id => {\n            combineIdList.push(id);\n        });\n        const shouldSelectedNodeIdList = nativeNodeList.map(n => (n.firstChild as HTMLElement)).map(node => node.dataset.id); // 把所有HTML节点的第一个子元素，即头部节点的'data-id'属性放进shouldSelectedNodeIdList中\n        this.props.data.nodes.forEach(node => { // 筛选出每个整合组合的'data-id', 拼接到shouldSelectedNodeIdList里面\n            if (combineIdSet.has(node.combineId)) {\n                shouldSelectedNodeIdList.push(node.id);\n            }\n        });\n\n        // Step 4: 把结果与props.data.nodes中的节点进行比较并存储下来(selectedNodeList是把筛选过的节点的详细信息添加到一个新对象(IWidgetNode)构成的列表里)\n        const idSet = new Set(shouldSelectedNodeIdList);\n\n        const selectedNodeList: ITopologyNode[] = [];\n\n        // 找到所有被选中的节点子节点\n        this.props.data.nodes.forEach(node => {\n            if (idSet.has(node.id) && isMatchKeyValue(node, 'dragChild', true)) {\n                this.props.data.lines.forEach(line => {\n                    if (line.start.split('-')[0] === node.id) {\n                        idSet.add(line.end);\n                    }\n                })\n            }\n        })\n        this.props.data.nodes.forEach(node => {\n            if (idSet.has(node.id)) {\n                selectedNodeList.push(node);\n            }\n        })\n\n        // Step 5: 返回所有需要返回的信息(nativeNodeList, selectedNodeList, boxPositionGroup)，其中nativeNodeList中是从nodeList-filter-domNodeList里面经过box筛选后得到的HTML节点，selectedNodeList则是把选中节点详细存储到一个对象构成的列表里\n        ret.nativeNodeList = nodeList.filter(node => idSet.has((node.firstChild as HTMLElement).dataset.id));\n        ret.selectedNodeList = selectedNodeList;\n        return ret;\n    }\n\n\n    couldDispatchContextMenuEvent = (e: React.MouseEvent<HTMLDivElement>) => {\n        if (e.button !== 2) {\n            return false;\n        }\n        if (this.state.boxSelectionInfo && (Math.abs(this.state.boxSelectionInfo.initX - e.clientX) > 3 || Math.abs(this.state.boxSelectionInfo.initY - e.clientY) > 3)) {\n            return false;\n        }\n        return true;\n    }\n\n    closeBoxSelection = () => {\n        this.setState(this.state.boxSelectionInfo ? { boxVisibleFlag: true, boxSelectionInfo: null } : {boxSelectionInfo: null});\n    }\n\n    showBoxSelection = () => {\n        if (this.state.boxVisibleFlag) {\n            this.setState({\n                boxVisibleFlag: false\n            });\n            this.generateBoxBySelectedNode();\n        }\n    }\n\n    handleMouseUp = (e: React.MouseEvent<HTMLDivElement>) => {\n        const {\n            data: { lines },\n            readOnly\n        } = this.props;\n        const { clientX, clientY, screenX, screenY, button, buttons } = e;\n        this.$canvas.classList.remove(DRAG_CLASS);\n        const {\n            boxSelectionInfo\n        } = this.state;\n        const shouldOpenContextMenuFlag = this.couldDispatchContextMenuEvent(e);\n        const isMultiClick = e.ctrlKey || e.metaKey || e.shiftKey;\n        const isDragBox = boxSelectionInfo && boxSelectionInfo.status === 'drag' && !shouldOpenContextMenuFlag;\n        const isEmitByNodeWrapper = () => {\n        let target = e.target as HTMLElement;\n            while(target.className !== e.currentTarget.className && target !== document.body) {\n                if (target.className.indexOf('topology-node-content') > -1) {\n                    return true;\n                }\n                target = target.parentElement;\n            }\n            return false;\n        }\n\n        // 允许打开右键菜单\n        if (shouldOpenContextMenuFlag && !isEmitByNodeWrapper()) {\n            const mouseEvent = new MouseEvent('contextmenu', {\n                bubbles: true,\n                cancelable: true,\n                clientX,\n                clientY,\n                screenX,\n                screenY,\n                button,\n                buttons\n            });\n            this.$wrapper.dispatchEvent(mouseEvent);\n        }\n        // 单击且没有按住ctrl/meta/shift键时，清空框选框\n        if (!isMultiClick) {\n            this.setState({\n                boxSelectionInfo: undefined\n            })\n        }\n\n        // 拖动框选box结束时\n        if (isDragBox) {\n            const { selectedNodeList: nodeList, nativeNodeList } = this.getShouldSelectedNodeList();\n            if (nodeList.length === 0) { // 没有选中任何节点\n                this.setState({\n                    boxSelectionInfo: undefined\n                });\n                return;\n            } else {\n                this.generateBoxByRealSelectedNodeDom(nativeNodeList);\n            }\n            const lineList = getLinesFromNode(lines, nodeList);\n            this.setContext({ selectedData: { nodes: nodeList, lines: lineList } }, () => {\n                const { onSelect } = this.props;\n                if (onSelect) {\n                    onSelect(this.state.context.selectedData);\n                }\n            });\n            this.setState({\n                boxSelectionInfo: {...this.state.boxSelectionInfo, status: 'none' as const}\n            });\n            return;\n        }\n\n        const { activeLine, impactNode } = this.state.context;\n        const isLineEdit = activeLine && activeLine.type !== LineEditType.ADD;\n        if (isLineEdit && impactNode && !readOnly) {\n            const { type, origin } = activeLine!;\n            if (type === LineEditType.EDIT_END) {\n                const editLine = { start: origin.start, end: impactNode };\n                const repeatIndex = this.getLineRepeatIndex(editLine) || {};\n                const getNewline = (item: ITopologyLine) => {\n                    if (!this.samePostionLinesLength(editLine)) {\n                        // eslint-disable-next-line no-param-reassign\n                        delete item.index;\n                    }\n                    return { ...item, end: impactNode, ...repeatIndex };\n                };\n\n                this.onChange(\n                    {\n                        ...this.props.data,\n                        lines: lines.map(item => (_.isEqual(item, origin!)\n                            ? getNewline(item)\n                            : item))\n                    },\n                    ChangeType.EDIT_LINE\n                );\n            }\n        }\n        this.clearMouseEventData();\n    };\n\n    clearMouseEventData = () => {\n        this.dragCanvasPo = null;\n        this.setContext({ activeLine: null, linking: false, impactNode: null });\n    };\n\n    handleLineDraw = (startId: string) => {\n        const { data, lineColor } = this.props;\n        const { lines } = this.props.data;\n        const {\n            context: { impactNode }\n        } = this.state;\n        if (impactNode) {\n            const newLine = { start: startId, end: impactNode };\n            const alreadyExist = lines.find(item => _.isEqual(item, newLine));\n            const anchor = startId.split(\"-\")[1] || \"\";\n            if (!alreadyExist) {\n                const colorMap = lineColor ? { color: lineColor[anchor] } : {};\n                const repeatIndex = this.getLineRepeatIndex(newLine) || {};\n                this.onChange(\n                    {\n                        ...data,\n                        lines: [\n                            ...data.lines,\n                            { ...newLine, ...colorMap, ...repeatIndex }\n                        ]\n                    },\n                    ChangeType.ADD_LINE\n                );\n            }\n        }\n        this.clearMouseEventData();\n    };\n\n    handleNodeDraw = (nodeInfoList: [string, IPosition][], childPosMap?: {\n        [key: string]: {\n            x: number;\n            y: number;\n        };\n    }) => {\n        const { data } = this.props;\n        const posMaps = {\n            ...nodeInfoList.reduce((prev, curr) => {\n                const [nodeId, position] = curr;\n                return {\n                    ...prev,\n                    [nodeId]: position\n                }\n            }, {}),\n            ...childPosMap\n        };\n        this.onChange(\n            {\n                ...data,\n                // @ts-ignore\n                nodes: data.nodes.map(item => (Object.keys(posMaps).includes(item.id) ? { ...item, position: posMaps[item.id] } : item))\n            },\n            ChangeType.LAYOUT\n        );\n    };\n\n    handleCanvasClick = (e: React.MouseEvent<HTMLDivElement>) => {\n        // @ts-ignore\n        const { className } = e.target;\n        if (\n            typeof className === \"string\"\n            && className.includes(\"topology-canvas\")\n        ) {\n            // 当按住cmd或者ctrl的时候，左键点击背景图层的时候，不会清楚选中的数据。\n            if (e.ctrlKey || e.metaKey) {\n                return;\n            }\n            this.clearSelectData();\n        }\n        this.setDraggingId(null);\n    };\n\n    renderNodes = () => {\n        const {\n            data: { nodes, lines },\n            renderTreeNode,\n            readOnly,\n            isReduceRender,\n            prevNodeStyle,\n        } = this.props;\n        const { context } = this.state;\n        const selectedNodes = context.selectedData.nodes || [];\n        const {\n            scaleNum,\n            draggingId,\n        } = this.state;\n        if (!renderTreeNode) {\n            return null;\n        }\n        const lineHash = lines.reduce((pre, cur) => {\n            const { start, end } = cur;\n            const [parent] = start.split(\"-\");\n            return { ...pre, [parent]: true, [end]: true };\n        }, {}) as { [id: string]: ITopologyLine };\n\n        return nodes.map(item => (\n            <NodeWrapper\n                onMouseEnter={this.handleHoverCurrentNode}\n                onMouseLeave={this.clearHoverCurrentNode}\n                key={item.id}\n                id={`${item.id}`}\n                data={item}\n                scaleNum={scaleNum}\n                draggingId={draggingId}\n                isSelected={this.isSelected(item.id)}\n                combineId={item.combineId}\n                getBoundary={this.getBoundary}\n                selectedNodes={selectedNodes}\n                setDraggingId={this.setDraggingId}\n                isReduceRender={isReduceRender}\n                closeBoxSelection={this.closeBoxSelection}\n                readOnly={readOnly}\n                prevNodeStyle={prevNodeStyle}\n                isolated={!lineHash[item.id]}\n                onSelect={this.selectNode}\n            >\n                {(wrapperOptions: IWrapperOptions) =>\n                    /* eslint-disable */\n                    renderTreeNode(item, wrapperOptions)\n                }\n            </NodeWrapper>\n        ));\n    };\n\n    renderDomMap = (props: ITopologyProps = this.props) => {\n        const {\n            data: { nodes },\n            renderTreeNode\n        } = props;\n        if (!renderTreeNode) {\n            return;\n        }\n        let domMap = document.querySelector(\"#topology-dom-map\");\n        if (!domMap) {\n            domMap = document.createElement(\"div\");\n            domMap.setAttribute(\"id\", \"topology-dom-map\");\n        }\n        domMap.innerHTML = renderToStaticMarkup(\n            <div>\n                {nodes.map(item => (\n                    <div\n                        key={item.id}\n                        id={`dom-map-${item.id}`}\n                        className=\"dom-map-wrapper\"\n                    >\n                        {renderTreeNode(item, {\n                            anchorDecorator: ({ anchorId }) => (\n                                _item: React.ReactNode\n                            ) => (\n                                <div\n                                    id={`dom-map-${item.id}-${anchorId}`}\n                                    key={anchorId}\n                                    className=\"dom-map-wrapper\"\n                                >\n                                    {_item}\n                                </div>\n                            )\n                        })}\n                    </div>\n                ))}\n            </div>\n        );\n        document.body.appendChild(domMap);\n        setTimeout(this.cacheNodeSize, 1000);\n    };\n\n    renderLines = () => {\n        const {\n            data: { lines, nodes },\n            startPointAnchorId,\n            lineTextMap,\n            lineOffsetY,\n            readOnly,\n            lineTextColor,\n            lineLinkageHighlight,\n            lineTextDecorator,\n            showText,\n            isReduceRender\n        } = this.props;\n        const { activeLine, selectedData, hoverCurrentNode } = this.state.context;\n        const nodeHash = createHashFromObjectArray(nodes, \"id\") as {\n            [id: string]: ITopologyNode;\n        };\n\n        const isEditing = (line: ITopologyLine) =>\n            activeLine &&\n            activeLine.origin &&\n            _.isEqual(line, activeLine.origin);\n        const isSelected = (line: ITopologyLine) =>\n            isEditing(line) || _.some(selectedData.lines, line);\n\n        // @ts-ignore\n        const isHighLight = (line: ITopologyLine) => {\n            if (!hoverCurrentNode || !lineLinkageHighlight) return false;\n            const { id } = hoverCurrentNode;\n            if (line.start.split(\"-\")[0] === id || line.end === id) return true;\n        }\n\n        const getLineStartPo = (line: ITopologyLine) => {\n            if (\n                isEditing(line) &&\n                activeLine.type === LineEditType.EDIT_START\n            ) {\n                return activeLine.start;\n            }\n\n            // 这里特殊处理下，目的是保持所有锚点的起始点位置与 startPointAnchorId 锚点位置一致\n            return computeAnchorPo(\n                // `dom-map-${line.start}`,\n                `dom-map-${startPointAnchorId === undefined ? line.start : `${line.start.split(\"-\")[0]}-${startPointAnchorId}`}`,\n                nodeHash[line.start.split(\"-\")[0]]\n            );\n        };\n        const getLineEndPo = (line: ITopologyLine) => {\n            if (isEditing(line) && activeLine.type === LineEditType.EDIT_END) {\n                return activeLine.end;\n            }\n            return computeNodeInputPo(nodeHash[line.end]);\n        };\n\n        return (\n            <svg className=\"topology-svg\">\n                {lines.map((line, index) => {\n                    const start = getLineStartPo(line);\n                    const end = getLineEndPo(line);\n                    if (!start || !end) {\n                        return null;\n                    }\n\n                    const key = `${line.start}-${line.end}`;\n                    const anchorId = line.start.split(\"-\")[1];\n                    const getTextXY = () => {\n                        const minX = Math.min(start.x, end.x);\n                        const minY = Math.min(start.y, end.y);\n                        const x = minX + Math.abs((start.x - end.x) / 2);\n                        const y = minY + Math.abs((start.y - end.y) / 2)\n                        return {\n                            x,\n                            y\n                        }\n                    }\n\n                    const defaultTextEl = lineTextColor && (\n                        <text x={getTextXY().x} y={getTextXY().y} key={index} style={{\n                            fill: lineTextColor[anchorId]\n                        }}>{anchorId === startPointAnchorId && !showText(line.start.split(\"-\")[0]) ? null : lineTextMap[anchorId]}</text>);\n\n                    return (\n                        <>\n                            <Line\n                                isReduceRender={isReduceRender}\n                                scaleNum={this.state.scaleNum}\n                                key={key}\n                                lineOffsetY={lineOffsetY}\n                                data={line}\n                                start={start}\n                                end={end}\n                                onSelect={this.selectLine}\n                                selected={isSelected(line)}\n                                highLight={isHighLight(line)}\n                                readOnly={readOnly}\n                            />\n                            {\n                                lineTextDecorator ? <LineText data={this.props.data} lineTextDecorator={lineTextDecorator} position={getTextXY()} line={line} /> : defaultTextEl\n                            }\n                        </>\n\n                    );\n                })}\n                {/* 拖动效果的线条 */}\n                {activeLine && activeLine.type === LineEditType.ADD && (\n                    <Line {...activeLine} scaleNum={this.state.scaleNum} />\n                )}\n            </svg>\n        );\n    };\n\n    // TODO：系统计算设置一个合适的 scale，使所有节点均在可视化区域内\n    findScale = async (clonegraph) => {\n        const { scaleNum } = this.state;\n        let downloadScale: number = Number(scaleNum && scaleNum.toFixed(1));\n\n        let canvasEle = clonegraph.querySelector('#topology-canvas');\n        canvasEle.style.transform = `scale(${downloadScale})`;\n        const { minXId, maxXId, minYId, maxYId } = getMaxAndMinNodeId(this.props.data.nodes);\n        let minYIdElement = clonegraph.querySelector(`#topology-node-${minYId}`);\n\n        minYIdElement.scrollIntoView({ block: \"start\" });\n\n        const isAllView = () => {\n            let minxIdView = isInViewPort(minXId, document);\n            let maxxIdView = isInViewPort(maxXId, document);\n            let minYIdView = isInViewPort(minYId, document);\n            let maxYIdView = isInViewPort(maxYId, document);\n            return minxIdView && maxxIdView && minYIdView && maxYIdView\n        }\n\n        let isViw = isAllView();\n        if (isViw) return downloadScale;\n\n        // scale 从 1 => 0.1，寻找一个能完全展示所有内容的值\n        for (let i = 1; i <= 10; i++) {\n            downloadScale = Number((downloadScale - 0.1).toFixed(1));\n            canvasEle.style.transform = `scale(${downloadScale})`;\n            minYIdElement.scrollIntoView({ block: \"start\" });\n            isViw = isAllView();\n            if(isViw || downloadScale === 0.1) {\n                break;\n            }\n        }\n        return downloadScale;\n    }\n\n    /**\n     * @param scopeType 下载区域类型（整个画布数据|选中的数据）\n     * @param openDownload 是否开启下载\n     * @param imgName 图片名称\n     * @returns\n     */\n\n    downloadImg = async (scopeType?: 'global' | 'selected', openDownload?: boolean, imgName?: string) => {\n        // openDownload && this.setState({ loading: true, })\n         const {\n            context: { selectedData },\n            scaleNum\n        } = this.state;\n\n        const isGlobal = scopeType === 'global';\n        const nodes = isGlobal ? this.props.data.nodes : selectedData && selectedData.nodes;\n\n        const graphEl: any = document.querySelector(\".topology-canvas\");\n        let imgBase64 = '';\n\n        const { minX, maxX, minY, maxY } = computeMaxAndMin(nodes)\n        const imgPadding = isGlobal ? 50 : 0;\n        const imgMinSize = 200;\n        return html2canvas(graphEl, {\n            onclone: function(documentClone){\n                // 背景色置为透明色\n\n                const nodeContentEls: HTMLCollectionOf<Element> = documentClone.getElementsByClassName('topology-node-content');\n                nodeContentEls && Array.from(nodeContentEls).forEach((node: HTMLElement) => {\n                    const childNode: any = node.childNodes && node.childNodes[0];\n                    const grandsonChildNode: any = childNode && childNode.childNodes[0];\n                    node.style.backgroundColor = 'transparent';\n                    node.style.border = '1px solid #fff';\n                    childNode.style.backgroundColor = 'white';\n                    grandsonChildNode.style.boxShadow = 'none';\n                })\n                const {  minYId } = getMaxAndMinNodeId(nodes);\n                // 定位画布中最顶层的节点，让其滚动在浏览器顶部，尽可能的多展示其它节点\n                let minYIdElement = documentClone.getElementById(`topology-node-${minYId}`);\n                minYIdElement.scrollIntoView({\n                    block: \"start\",\n                    inline: 'center'\n                });\n            },\n            backgroundColor: 'white',\n            useCORS: true, //支持图片跨域\n            scale: 1 / scaleNum,\n            x: (minX - imgPadding) * scaleNum,\n            y: (minY - imgPadding) * scaleNum,\n            width: maxX - minX + imgMinSize,\n            height: maxY - minY + imgMinSize,\n        }).then((canvas) => {\n            imgBase64 = canvas.toDataURL('image/png');\n            // 生成图片导出\n            if (openDownload) {\n                const a = document.createElement('a');\n                a.href = imgBase64;\n                a.download = imgName || '图片';\n                a.click();\n            }\n            this.setState({ loading: false })\n            return Promise.resolve(imgBase64);\n        })\n    }\n\n    /**\n     * 整个画布截图\n     */\n    getImageBase64Url = async () => {\n        const url = await this.downloadImg('global', false);\n        return url;\n    }\n\n    /**\n     * 选中数据截图\n     */\n    getImageBase64UrlWithSelectedData = async () => {\n        const url = await this.downloadImg('selected', false);\n        return url;\n    }\n\n    // 定位节点\n    locateNodeById = (id) => {\n\n        const { nodes } =  this.props.data;\n        const curNode = nodes && nodes.find(n => n.id === id)\n        const ele = document.getElementById(`topology-node-${id}`);\n        if (ele) {\n            // 如果已选中，则不做处理\n            this.selectNode(curNode, SelectMode.SINGLE)\n            ele.scrollIntoView({\n                block: \"center\",\n                inline: 'center'\n            });\n        }\n    }\n\n    renderToolBars = () => {\n        const { scaleNum, loading } = this.state;\n        const { showCenter, showLayout, showDownload, downloadImg, customToolboxList } = this.props;\n        /* eslint-disable */\n        // @ts-ignore\n        const zoomPercent = `${parseInt(String((scaleNum ? scaleNum : 1).toFixed(1) * 100))}%`;\n\n        const exportStyle: React.CSSProperties = loading ? {\n            backgroundColor: 'rgba(0,0,0,.04)',\n            cursor: 'not-allowed',\n        } : {}\n\n        return (\n            <div className=\"topology-tools\" data-html2canvas-ignore={false}>\n                {showCenter !== false && <div\n                    className=\"topology-tools-btn\"\n                    id=\"scroll-canvas-to-center\"\n                    onClick={this.props.customPostionHeight ? this.scrollCanvasToPositionY : this.scrollCanvasToCenter}\n                >\n                    <img\n                        src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYwMzI3NjY4NDk5IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjExMzciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTEzLjc5OTY0OSAyOTUuNzQyMjM4Yy0xMTguMTc2OTE5IDAtMjE0LjE1ODE3MiA5Ni4xODEyMTUtMjE0LjE1ODE3MyAyMTQuMTU4MTcyIDAgMTE4LjE3NjkxOSA5Ni4xODEyMTUgMjE0LjE1ODE3MiAyMTQuMTU4MTczIDIxNC4xNTgxNzIgMTE3Ljk3Njk1OCAwIDIxNC4xNTgxNzItOTUuNzgxMjkzIDIxNC4xNTgxNzItMjEzLjk1ODIxMXMtOTYuMTgxMjE1LTIxNC4zNTgxMzMtMjE0LjE1ODE3Mi0yMTQuMzU4MTMzeiBtMCAzNjcuMzI4MjU2Yy04NC4zODM1MTkgMC0xNTIuOTcwMTIzLTY4LjU4NjYwNC0xNTIuOTcwMTI0LTE1Mi45NzAxMjNzNjguNTg2NjA0LTE1Mi45NzAxMjMgMTUyLjk3MDEyNC0xNTIuOTcwMTIzIDE1Mi45NzAxMjMgNjguNTg2NjA0IDE1Mi45NzAxMjMgMTUyLjk3MDEyMy02OC41ODY2MDQgMTUyLjk3MDEyMy0xNTIuOTcwMTIzIDE1Mi45NzAxMjN6IiBmaWxsPSIjMzMzMzMzIiBwLWlkPSIxMTM4Ij48L3BhdGg+PHBhdGggZD0iTTk5MS4zMDYzODUgNDgwLjUwNjE1MUg5MTMuOTIxNWMtNy4xOTg1OTQtOTYuNTgxMTM2LTQ4LjE5MDU4OC0xODYuMzYzNjAxLTExNy4zNzcwNzUtMjU1LjU1MDA4OHMtMTU4Ljk2ODk1MS0xMTAuMTc4NDgxLTI1NS41NTAwODgtMTE3LjM3NzA3NVYzMC41OTQwMjVjMC0xNi43OTY3MTktMTMuNzk3MzA1LTMwLjU5NDAyNS0zMC41OTQwMjUtMzAuNTk0MDI1cy0zMC41OTQwMjUgMTMuNzk3MzA1LTMwLjU5NDAyNCAzMC41OTQwMjV2NzYuOTg0OTYzYy05Ni4zODExNzYgNy4xOTg1OTQtMTg2LjM2MzYwMSA0OC4xOTA1ODgtMjU1LjU1MDA4OCAxMTcuMzc3MDc1UzExNC4wNzc3MTkgMzgzLjcyNTA1NCAxMDYuODc5MTI1IDQ4MC41MDYxNTFIMzAuNjk0MDA1Yy0xNi43OTY3MTkgMC0zMC41OTQwMjUgMTMuNzk3MzA1LTMwLjU5NDAyNSAzMC41OTQwMjVzMTMuNzk3MzA1IDMwLjU5NDAyNSAzMC41OTQwMjUgMzAuNTk0MDI0aDc2LjE4NTEyYzcuMTk4NTk0IDk2LjU4MTEzNiA0OC4xOTA1ODggMTg2LjM2MzYwMSAxMTcuMzc3MDc1IDI1NS41NTAwODhzMTU4Ljk2ODk1MSAxMTAuMTc4NDgxIDI1NS41NTAwODggMTE3LjM3NzA3NXY3OC43ODQ2MTJjMCAxNi43OTY3MTkgMTMuNzk3MzA1IDMwLjU5NDAyNSAzMC41OTQwMjQgMzAuNTk0MDI1czMwLjU5NDAyNS0xMy43OTczMDUgMzAuNTk0MDI1LTMwLjU5NDAyNXYtNzguNzg0NjEyYzk2LjM4MTE3Ni03LjE5ODU5NCAxODYuMzYzNjAxLTQ4LjE5MDU4OCAyNTUuNTUwMDg4LTExNy4zNzcwNzVzMTEwLjE3ODQ4MS0xNTguOTY4OTUxIDExNy4zNzcwNzUtMjU1LjU1MDA4OGg3Ny4zODQ4ODVjMTYuNzk2NzE5IDAgMzAuNTk0MDI1LTEzLjc5NzMwNSAzMC41OTQwMjUtMzAuNTk0MDI0IDAtMTYuOTk2NjgtMTMuNzk3MzA1LTMwLjU5NDAyNS0zMC41OTQwMjUtMzAuNTk0MDI1ek03NTMuMTUyOSA3NTMuODUyNzYzYy02NC43ODczNDYgNjQuNzg3MzQ2LTE1MS4xNzA0NzUgMTAwLjU4MDM1NS0yNDIuNzUyNTg4IDEwMC41ODAzNTYtOTEuNzgyMDc0IDAtMTc3Ljk2NTI0MS0zNS43OTMwMDktMjQyLjc1MjU4Ny0xMDAuNTgwMzU2LTY0Ljc4NzM0Ni02NC43ODczNDYtMTAwLjU4MDM1NS0xNTEuMTcwNDc1LTEwMC41ODAzNTUtMjQyLjc1MjU4N3MzNS43OTMwMDktMTc3Ljk2NTI0MSAxMDAuNTgwMzU1LTI0Mi43NTI1ODhjNjQuNzg3MzQ2LTY0Ljc4NzM0NiAxNTEuMTcwNDc1LTEwMC41ODAzNTUgMjQyLjc1MjU4Ny0xMDAuNTgwMzU1IDkxLjc4MjA3NCAwIDE3Ny45NjUyNDEgMzUuNzkzMDA5IDI0Mi43NTI1ODggMTAwLjU4MDM1NSA2NC43ODczNDYgNjQuNzg3MzQ2IDEwMC41ODAzNTUgMTUxLjE3MDQ3NSAxMDAuNTgwMzU1IDI0Mi43NTI1ODhzLTM1LjU5MzA0OCAxNzcuOTY1MjQxLTEwMC41ODAzNTUgMjQyLjc1MjU4N3oiIGZpbGw9IiMzMzMzMzMiIHAtaWQ9IjExMzkiPjwvcGF0aD48L3N2Zz4=\"\n                        alt=\"\"\n                    />\n                    <div className=\"tooltip\">定位中心</div>\n                </div>}\n\n                {showLayout !== false && <div\n                    className=\"topology-tools-btn\"\n                    id=\"auto-layout\"\n                    onClick={this.autoLayout}\n                >\n                    <img\n                        src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTYwMzI3NjU0MDc4IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwMjIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNODg1LjkyNzYxNyA2NzQuMzAwMTMyVjQ5Ny42NDYxMTNINTQwLjc3MTIyVjM1My44Mjk5MjRoMzQ1LjE1NzQyMVYxMjMuNjk3MDA2SDEzOC4wNzAzMzZ2MjMwLjEzMjkxOGgzNDUuMTU3NDIxdjE0My44MTYxODlIMTM4LjA3MDMzNnYxNzYuNjU0MDE5Yy00OS40Nzc3NzkgMTIuODYyOTMzLTg2LjI4ODA3NiA1Ny40OTc0MTQtODYuMjg4MDc2IDExMC45NTA3MjkgMCA2My40NTMwNDQgNTEuNTk4MDY1IDExNS4wNTIxMzMgMTE1LjA1NDE3OSAxMTUuMDUyMTMzIDYzLjQ1MjAyMSAwIDExNS4wNTAwODYtNTEuNTk5MDg5IDExNS4wNTAwODYtMTE1LjA1MjEzMyAwLTUzLjQ1MzMxNi0zNi44MTAyOTctOTguMDg3Nzk2LTg2LjI4ODA3Ni0xMTAuOTUwNzI5VjU1NS4xNDQ1NWgyODcuNjMwMzMxdjExOS4xNTQ1NTljLTQ5LjQ5MTA4MiAxMi44NjI5MzMtODYuMjg4MDc2IDU3LjQ5NzQxNC04Ni4yODgwNzYgMTEwLjk1MDcyOSAwIDYzLjQ1MzA0NCA1MS41OTkwODkgMTE1LjA1MjEzMyAxMTUuMDY2NDU5IDExNS4wNTIxMzMgNjMuNDI1NDE1IDAgMTE1LjA1NDE3OS01MS41OTkwODkgMTE1LjA1NDE3OS0xMTUuMDUyMTMzIDAtNTMuNDUzMzE2LTM2Ljc5ODAxNy05OC4wODc3OTYtODYuMjg5MDk5LTExMC45NTA3MjlWNTU1LjE0NDU1aDI4Ny42MzAzMzF2MTE5LjE1NDU1OWMtNDkuNDkzMTI5IDEyLjg2MjkzMy04Ni4yODcwNTMgNTcuNDk3NDE0LTg2LjI4NzA1MyAxMTAuOTUwNzI5IDAgNjMuNDUzMDQ0IDUxLjU2OTQxMyAxMTUuMDUyMTMzIDExNS4wNTExMSAxMTUuMDUyMTMzIDYzLjQyNDM5MSAwIDExNS4wNTMxNTYtNTEuNTk5MDg5IDExNS4wNTMxNTYtMTE1LjA1MjEzMy0wLjAwMjA0Ny01My40NTMzMTYtMzYuODAwMDY0LTk4LjA4Njc3My04Ni4yOTIxNy0xMTAuOTQ5NzA2ek0xOTUuNTk3NDI2IDE4MS4yMjQwOTZoNjMyLjgwNDEyNXYxMTUuMDUyMTMySDE5NS41OTc0MjZWMTgxLjIyNDA5NnogbTI4Ljc2NDA1NiA2MDQuMDI2NzY1YzAgMzEuNzEyMTk2LTI1LjgxNDg5NCA1Ny41NTQ3MTktNTcuNTI2MDY2IDU3LjU1NDcxOS0zMS43MTQyNDIgMC01Ny41MjcwOS0yNS44NDI1MjMtNTcuNTI3MDktNTcuNTU0NzE5IDAtMzEuNzE0MjQyIDI1LjgxMjg0Ny01Ny40OTg0MzcgNTcuNTI3MDktNTcuNDk4NDM3IDMxLjcxMjE5Ni0wLjAwMTAyMyA1Ny41MjYwNjYgMjUuNzgzMTcxIDU3LjUyNjA2NiA1Ny40OTg0Mzd6IG0zNDUuMTcxNzQ3IDBjMCAzMS43MTIxOTYtMjUuODQxNSA1Ny41NTQ3MTktNTcuNTI3MDg5IDU3LjU1NDcxOS0zMS43MjQ0NzUgMC01Ny41MzkzNjktMjUuODQyNTIzLTU3LjUzOTM2OS01Ny41NTQ3MTkgMC0zMS43MTQyNDIgMjUuODE1OTE3LTU3LjQ5ODQzNyA1Ny41MzkzNjktNTcuNDk4NDM3IDMxLjY4NTU5LTAuMDAxMDIzIDU3LjUyNzA5IDI1Ljc4MzE3MSA1Ny41MjcwODkgNTcuNDk4NDM3eiBtMjg3LjYzMTM1NSA1Ny41NTQ3MTljLTMxLjc0MTg3MiAwLTU3LjUyODExMy0yNS44NDI1MjMtNTcuNTI4MTEzLTU3LjU1NDcxOSAwLTMxLjcxNDI0MiAyNS43ODYyNDEtNTcuNDk4NDM3IDU3LjUyODExMy01Ny40OTg0MzcgMzEuNjg1NTkgMCA1Ny41MjcwOSAyNS43ODQxOTUgNTcuNTI3MDkgNTcuNDk4NDM3IDAgMzEuNzEyMTk2LTI1Ljg0MTUgNTcuNTU0NzE5LTU3LjUyNzA5IDU3LjU1NDcxOXoiIGZpbGw9IiMyYzJjMmMiIHAtaWQ9IjEwMjMiPjwvcGF0aD48L3N2Zz4=\"\n                        alt=\"\"\n                    />\n                    <div className=\"tooltip\">自动布局</div>\n                </div>}\n\n                {showDownload && <div\n                    className=\"topology-tools-btn\"\n                    id=\"export-img\"\n                    style={exportStyle}\n                    onClick={async () => {\n                        if (loading) return;\n                        // 截图之前需要重置 scaleNum 为 1，避免坐标错位\n                        this.setState({\n                            scaleNum: 1,\n                            loading: true,\n                        }, () => {\n                            downloadImg ? downloadImg() : this.downloadImg('global', true);\n                        })\n\n                    }}\n                >\n                    <img alt='' src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGZpbGw9IiM2MTYxNjEiIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiPjxwYXRoIGQ9Ik01MTIgNjJsNS42LjRDNTM5LjggNjUuMSA1NTcgODQuMSA1NTcgMTA3YzAgMjQuOS0yMC4xIDQ1LTQ1IDQ1SDE3NC41bC00LjUuNWMtMTAuMyAyLjEtMTggMTEuMi0xOCAyMnY0OTcuOWwxNzIuOC0xNTguM2MyNy41LTI1LjIgNjguNy0yNy41IDk4LjYtNi4zbDUuOCA0LjUgMTUxLjkgMTMwLjIgMTA0LjQtMTA0LjNjMjYtMjYgNjYuMi0zMC4zIDk2LjktMTEuNGw2IDQuMSA4My41IDYyLjZWNTEyaDkwdjMzNy41bC0uMyA4LjRDOTU3LjQgOTE2LjEgOTA4LjggOTYyIDg0OS41IDk2MmgtNjc1bC04LjQtLjNDMTA3LjkgOTU3LjQgNjIgOTA4LjggNjIgODQ5LjV2LTY3NWwuMy04LjRDNjYuNiAxMDcuOSAxMTUuMiA2MiAxNzQuNSA2Mkg1MTJ6TTM3My4xIDU2MmwtMi43IDEuOUwxNTIgNzY0djg1LjVsLjUgNC41YzIuMSAxMC4zIDExLjIgMTggMjIgMThoNjc1YzEyLjQgMCAyMi41LTEwLjEgMjIuNS0yMi41VjY3Ny45bC0xMjQtOTNjLTMuNi0yLjctOC4zLTIuOS0xMi4xLS45bC0yLjYgMi0xMDAuNyAxMDAuNiA4MS40IDY5LjhjMTQuMiAxMi4xIDE1LjggMzMuNCAzLjcgNDcuNi0xMSAxMi45LTI5LjYgMTUuNC00My42IDYuNmwtNC0zLTI4NC43LTI0NGMtMy41LTMtOC4zLTMuNS0xMi4zLTEuNnpNOTE3IDQ2N2MyNC45IDAgNDUgMjAuMSA0NSA0NWgtOTBjMC0yNC45IDIwLjEtNDUgNDUtNDV6TTgwNC41IDczLjJjMTcuMSAwIDMxLjIgMTIuNyAzMy40IDI5LjJsLjMgNC42djE4OC41bDU0LjktNTQuOWMxMi0xMiAzMC43LTEzLjEgNDMuOS0zLjNsMy44IDMuM2MxMiAxMiAxMy4xIDMwLjcgMy4zIDQzLjlsLTMuMyAzLjgtMTEyLjQgMTEyLjYtMS44IDEuNi0uMy4yLS43LjctLjMuMi0uNS41LjQtLjQtMi42IDEuOWMtLjkuNi0xLjkgMS4xLTIuOSAxLjYtLjMuMS0uNi4zLS44LjQtMS4zLjYtMi42IDEuMS00IDEuNS0uNi4yLTEuMS4zLTEuNi41LTEuMS4zLTIuMy42LTMuNS43bC0uOS4xYy0xLjQuMi0yLjguMy00LjIuM2wtMi4zLS4xYy0yLjgtLjItNS42LS43LTguMi0xLjYtMS0uMy0xLjctLjYtMi4zLS45LTIuNS0xLTQuOS0yLjQtNy4yLTQuMS0uNy0uNS0xLjMtMS0xLjgtMS40bC0yLTEuOC0xMTIuOC0xMTIuNGMtMTMuMi0xMy4yLTEzLjItMzQuNSAwLTQ3LjcgMTItMTIgMzAuNy0xMy4xIDQzLjktMy4zbDMuOCAzLjMgNTQuOSA1NC45VjEwNy4xYy4xLTE4LjcgMTUuMi0zMy45IDMzLjgtMzMuOXoiLz48L3N2Zz4=' />\n                    <div className=\"tooltip\">{loading? '导出中...' : '导出图片'}</div>\n                </div>}\n                {Array.isArray(customToolboxList) &&\n                    customToolboxList.map(({wrapperProps={}, content, tooltip}) => {\n                        return (\n                            <div\n                                className=\"topology-tools-btn\"\n                                {...wrapperProps}\n\n                            >\n                                {content}\n                                <div className=\"tooltip\">{tooltip}</div>\n                            </div>\n                        );\n                    })\n                }\n                <div className=\"topology-tools-zoom\" onClick={this.zoomIn}>\n                    <img\n                        src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxOTIzNzE5OTI0IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjEwOTIwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjEyOCIgaGVpZ2h0PSIxMjgiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTUxMi42MTY5NDIgNjQuMTg2NjczYzYxLjcyMDU1MyAwIDExOS43OTA3ODIgMTEuNzc5ODEzIDE3NC4yMTEwODUgMzUuMzM5NDRzMTAxLjcwNjA0MyA1NS40MTU0MjggMTQxLjg1NzQyMSA5NS41Njc0MDVjNDAuMTUxMzc3IDQwLjE1MTk3NyA3Mi4wMDcxNzkgODcuMjcxODMgOTUuNTY3NDA1IDE0MS4zNTk3NTggMjMuNTYwMjI2IDU0LjA4NzcyOSAzNS4zNDAwMzkgMTExLjk5MjI2OSAzNS4zMzk0NCAxNzMuNzEzNDIyLTAuMDAwNiA2MS43MjA5NTMtMTEuNzgwMjEzIDExOS43OTEzODEtMzUuMzM5NDQgMTc0LjIxMTA4NS0yMy41NTkwMjcgNTQuNDE5NzAzLTU1LjQxNTAyOSAxMDEuNzA1NDQ0LTk1LjU2NzQwNSAxNDEuODU3NDIxLTQwLjE1MjU3NyA0MC4xNTE5NzctODcuNDM4MzE3IDcyLjAwNzc3OS0xNDEuODU3NDIxIDk1LjU2NzQwNS01NC40MTkxMDQgMjMuNTU5NjI3LTExMi40ODkzMzIgMzUuMzM5NDQtMTc0LjIxMTA4NSAzNS4zMzk0NHMtMTE5LjYyNjA5NC0xMS43Nzk4MTMtMTczLjcxMzQyMi0zNS4zMzk0NGMtNTQuMDg3MzI5LTIzLjU1OTYyNy0xMDEuMjA3MTgyLTU1LjQxNTQyOC0xNDEuMzU5NzU4LTk1LjU2NzQwNS00MC4xNTI1NzctNDAuMTUxOTc3LTcyLjAwODM3OC04Ny40Mzc3MTctOTUuNTY3NDA1LTE0MS44NTc0MjFzLTM1LjMzODg0LTExMi40ODk5MzItMzUuMzM5NDQtMTc0LjIxMTA4NWMtMC4wMDA2LTYxLjcyMTE1MyAxMS43NzkyMTQtMTE5LjYyNTQ5NCAzNS4zMzk0NC0xNzMuNzEzNDIyczU1LjQxNjAyOC0xMDEuMjA3NzgxIDk1LjU2NzQwNS0xNDEuMzU5NzU4IDg3LjI3MTIzLTcyLjAwNzc3OSAxNDEuMzU5NzU4LTk1LjU2NzQwNVM0NTAuODk2NTg4IDY0LjE4Njg3MyA1MTIuNjE2OTQyIDY0LjE4NjY3M3pNNzM0LjYxMDgzIDU3MC44OTEzMjhjMTkuOTA5NzAxIDAgMzcuODI4NTUyLTUuMTQzMzEzIDUzLjc1NjE1My0xNS40Mjk5MzkgMTUuOTI3NjAxLTEwLjI4NjYyNiAyMy44OTE0MDItMjUuNzE2NTY0IDIzLjg5MTQwMi00Ni4yODk4MTYgMC0xOS45MDk3MDEtNy45NjM4MDEtMzQuNjc2Mjg5LTIzLjg5MTQwMi00NC4yOTkzNjUtMTUuOTI3NjAxLTkuNjIzMDc2LTMzLjg0NjI1Mi0xNC40MzQ2MTMtNTMuNzU2MTUzLTE0LjQzNDgxM0wyOTQuNjA0MTU0IDQ1MC40MzczOTVjLTE5LjkwOTcwMSAwLTM4LjE2MDUyNyA0LjgxMTUzOC01NC43NTIyNzggMTQuNDM0ODEzLTE2LjU5MTc1MSA5LjYyMzA3Ni0yNC44ODc1MjYgMjQuMzg5NjY0LTI0Ljg4NzUyNiA0NC4yOTkzNjUgMCAyMC41NzMyNTEgOC4yOTU3NzUgMzYuMDAzMTkgMjQuODg3NTI2IDQ2LjI4OTgxNiAxNi41OTE3NTEgMTAuMjg2NjI2IDM0Ljg0MjM3NyAxNS40Mjk5MzkgNTQuNzUyMjc4IDE1LjQyOTkzOUw3MzQuNjEwODMgNTcwLjg5MTMyOCA3MzQuNjEwODMgNTcwLjg5MTMyOHoiIHAtaWQ9IjEwOTIxIiBmaWxsPSIjOUZBMkE4Ij48L3BhdGg+PC9zdmc+\"\n                        alt=\"\"\n                    />\n                </div>\n\n                <div className=\"topology-tools-percent\">{zoomPercent}</div>\n                <div className=\"topology-tools-zoom\" onClick={this.zoomOut}>\n                    <img\n                        src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNjIxOTIzNDA4MzQyIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjgwNSIgZGF0YS1zcG0tYW5jaG9yLWlkPSJhMzEzeC43NzgxMDY5LjAuaTIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48L3N0eWxlPjwvZGVmcz48cGF0aCBkPSJNNTE3LjEyIDQzLjkxOTM2Yy0yNTguNzM0MDggMC00NjguNDggMjA5Ljc0NTkyLTQ2OC40OCA0NjguNDhzMjA5Ljc0NTkyIDQ2OC40OCA0NjguNDggNDY4LjQ4IDQ2OC40OC0yMDkuNzQ1OTIgNDY4LjQ4LTQ2OC40OC0yMDkuNzQ1OTItNDY4LjQ4LTQ2OC40OC00NjguNDh6TTc0Mi4yMzg3MiA1NjUuNzZINTcwLjg4djE3MS43OTkwNGMwIDI5LjU2OC0yNC4xOTIgNTMuNzYtNTMuNzYgNTMuNzZzLTUzLjc2LTI0LjE5Mi01My43Ni01My43NlY1NjUuNzZoLTE3MS40MzgwOGMtMjkuNTY4IDAtNTMuNzYtMjQuMTkyLTUzLjc2LTUzLjc2czI0LjE5Mi01My43NiA1My43Ni01My43Nkg0NjMuMzZ2LTE3MC45OTc3NmMwLTI5LjU2OCAyNC4xOTItNTMuNzYgNTMuNzYtNTMuNzZzNTMuNzYgMjQuMTkyIDUzLjc2IDUzLjc2VjQ1OC4yNGgxNzEuMzU4NzJjMjkuNTY4IDAgNTMuNzYgMjQuMTkyIDUzLjc2IDUzLjc2cy0yNC4xOTIgNTMuNzYtNTMuNzYgNTMuNzZ6IiBwLWlkPSI4MDYiIGZpbGw9IiM5RkEyQTgiPjwvcGF0aD48L3N2Zz4=\"\n                        alt=\"\"\n                    />\n                </div>\n            </div>\n        );\n    };\n\n    handleSelectAll = () => {\n        const { data, onSelect } = this.props;\n        this.setContext(\n            {\n                selectedData: data\n            },\n            () => {\n                if (onSelect) {\n                    onSelect(this.state.context.selectedData);\n                }\n            }\n        );\n    };\n\n    handleDeselectAll = () => {\n        const { onSelect } = this.props;\n        this.setContext(\n            {\n                selectedData: { nodes: [], lines: [] }\n            },\n            () => {\n                if (onSelect) {\n                    onSelect(this.state.context.selectedData);\n                }\n            }\n        );\n    };\n\n    /**\n     * Check whether the drag node overlaps\n     * @param nodeInfo [string, IPosition][]\n     * @returns\n     */\n    validateIsOverlap = (nodeInfo: [string, IPosition][]): boolean => {\n        const {\n            data: { nodes },\n            overlap,\n            overlapOffset = {}\n        } = this.props;\n\n        if (!overlap) return false;\n        const nodePosMap = new Map<string, IPosition>();\n        nodeInfo.forEach(([id, pos]) => {\n            nodePosMap.set(id, pos);\n        });\n\n        const getNodeOffsetPos = (position: IPosition, id: string): IPosition => {\n            return {\n                x: position.x + getNodeSize(id).width + overlapOffset.offsetX || 0,\n                y: position.y + getNodeSize(id).height + overlapOffset.offsetY || 0,\n            }\n        }\n\n\n        const posMap: IPosMap[] = nodes && nodes.filter(n => !nodePosMap.has(n.id) && !n.filterOverlap).map(n => {\n            // const pos = nodePosMap.get(n.id);\n\n            return {\n                T1: {\n                    x: n.position.x,\n                    y: n.position.y,\n                },\n                T2: getNodeOffsetPos(n.position, n.id)\n            }\n        })\n        const isOverlap = Array.from(nodePosMap).some(([id, pos]) => {\n            const S1 = {\n                x: pos.x,\n                y: pos.y\n            }\n            const S2 = getNodeOffsetPos(pos, id);\n            return posMap.some((p: IPosMap) => !(S2.y < p.T1.y || S1.y > p.T2.y || S2.x < p.T1.x || S1.x > p.T2.x) === true);\n        });\n        return isOverlap;\n    }\n\n    multiValidateIsOverlap = (drawId, pos): boolean => {\n        return false;\n    }\n\n    setRealDragNodeDomList = (element?: Element[] | null) => {\n        this.setState({\n            realDragNodeDomList: element\n        })\n    }\n\n    setAlignmentLines = (alignmentLines) => {\n        this.setState({\n            alignmentLines,\n        })\n    }\n\n    // 获取 drag 时节点坐标\n    getNodePosition = (monitor, nodeDom, isChild?) => {\n        if (!monitor) return {};\n        const { scaleNum } = this.state;\n        const clientOffset = monitor.getDifferenceFromInitialOffset() || {};\n        const nodePosition = {\n            top: nodeDom.style.top,\n            left: nodeDom.style.left\n        };\n\n        const scalePosition = {\n            x:\n                Number(nodePosition.left.replace(/[px]+/g, \"\")) +\n                clientOffset.x / scaleNum || 0,\n            y:\n                Number(nodePosition.top.replace(/[px]+/g, \"\")) +\n                clientOffset.y / scaleNum || 0\n        };\n        const scrollPosition = computeCanvasPo(\n            monitor.getSourceClientOffset() || {},\n            this.$wrapper\n        )\n        /**\n         * TODO： scaleNum 缩放与窗口滚动时有冲突, isChild 为子节点联动时使用 scalePosition 定位\n         */\n        const position = scaleNum === 1 ? (\n            isChild ? scalePosition : scrollPosition\n        ) : scalePosition\n        return position;\n    }\n\n    render() {\n        const { connectDropTarget, showBar, snapline } = this.props;\n        const { context, scaleNum, boxSelectionInfo, alignmentLines } = this.state;\n        const xPos = boxSelectionInfo ? `${boxSelectionInfo.x},${boxSelectionInfo.initX}` : '';\n        const yPos = boxSelectionInfo ? `${boxSelectionInfo.y},${boxSelectionInfo.initY}` : '';\n\n        return connectDropTarget!(\n            <div className=\"byai-topology\"\n                ref={r => {\n                    this.$topology = r;\n                }}\n            >\n                <div\n                    ref={r => {\n                        this.$wrapper = r;\n                    }}\n                    className={classnames({\n                        \"topology-wrapper\": true,\n                        \"topology-linking\": context.linking,\n                    })}\n                    onContextMenu={(e) => {\n                        if (e.isTrusted) {\n                            e.stopPropagation();\n                            e.preventDefault();\n                        }\n                    }}\n                    onMouseDown={this.handleMouseDown}\n                    onMouseMove={this.handleMouseMove}\n                    onMouseUp={this.handleMouseUp}\n                    onMouseLeave={this.clearMouseEventData}\n                >\n                    <div\n                        ref={r => {\n                            this.$canvas = r;\n                        }}\n                        id='topology-canvas'\n                        className=\"topology-canvas topology-zoom\"\n                        // @ts-ignore\n                        style={{\n                            width: config.canvas.width,\n                            height: config.canvas.height,\n                            // @ts-ignore\n                            \"--scaleNum\": scaleNum\n                        }}\n                        onClick={this.handleCanvasClick}\n                    >\n                        <Provider value={context}>\n                            {this.renderNodes()}\n                            {this.renderLines()}\n                            <Selection onClick={e => {\n                                e.stopPropagation();\n                                this.setState({\n                                    boxSelectionInfo: null\n                                })\n                            }} renderTool={typeof this.props.renderBoxSelectionTool === 'function' ? this.props.renderBoxSelectionTool : undefined} toolVisible={this.state.boxSelectionInfo && this.state.boxSelectionInfo.status === 'static'} xPos={xPos} yPos={yPos} wrapper={this.$wrapper} visible={!!boxSelectionInfo} />\n                            {snapline !== false && <SnapLine alignmentLines={alignmentLines}/>}\n                        </Provider>\n                    </div>\n                </div>\n                {showBar !== false && this.renderToolBars()}\n            </div>\n        );\n    }\n}\n\nfunction hover(props: ITopologyProps, monitor, component: Topology) {\n    if (!monitor.getItem()) {\n        return;\n    }\n\n    const { context } = component.state;\n    const clientOffset = monitor.getClientOffset();\n    const { id } = monitor.getItem();\n    const type = monitor.getItemType();\n    switch (type) {\n        case NodeTypes.ANCHOR:\n            if (clientOffset) {\n                const nodeId = id.split('-')[0];\n                const parentNode = props.data.nodes.find(item => item.id === nodeId);\n                const hasAnchorExistLine = !props.canConnectMultiLines && props.data.lines.find(item => item.start === id);\n                if (hasAnchorExistLine || !parentNode || !component.$wrapper) { return; }\n\n                const startPo = context.activeLine ? context.activeLine.start : computeAnchorPo(`dom-map-${id}`, parentNode);\n                const endPo = computeCanvasPo(\n                    clientOffset,\n                    component.$wrapper\n                );\n                if (!startPo || !endPo) {\n                    return;\n                }\n                const impactNode = component.impactCheck(endPo, startPo, id);\n                component.setContext({\n                    impactNode,\n                    linking: true,\n                    activeLine: {\n                        type: LineEditType.ADD,\n                        origin: null,\n                        start: startPo,\n                        end: endPo\n                    }\n                });\n            }\n            break;\n\n        case NodeTypes.TEMPLATE_NODE:\n        case NodeTypes.NORMAL_NODE: {\n            const { nodes } = props.data;\n            const nodeDom: HTMLElement = document.getElementById(`topology-node-${id}`);\n\n            const ALIGNMENT_THRESHOLD = 2;\n\n            // 计算两个节点之间的距离\n            const getDistance = (node1, node2) => {\n                const dx = Math.abs(node1.position.x - node2.position.x);\n                const dy = Math.abs(node1.position.y - node2.position.y);\n                return { dx, dy };\n            };\n\n            // 根据两个节点之间的距离信息，判断它们是否在水平或垂直方向上对齐\n            const getAlignment = (node1, node2) => {\n                const distance = getDistance(node1, node2);\n\n                if (distance.dx < ALIGNMENT_THRESHOLD) {\n                    return { vertical: true, x: node2.position.x };\n                }\n\n                if (distance.dy < ALIGNMENT_THRESHOLD) {\n                    return { horizontal: true, y: node2.position.y };\n                }\n\n                return null;\n            };\n\n            const position = type === NodeTypes.TEMPLATE_NODE ? computeCanvasPo(\n                    monitor.getSourceClientOffset(),\n                    component.$wrapper\n                ) : component.getNodePosition(monitor, nodeDom)\n            const draggedNode = {\n                id,\n                position\n            }\n\n            // 计算所有节点之间的对齐关系，并更新对齐线的位置信息\n            const newAlignmentLines = {};\n            // 过滤掉当前拖动的节点\n            nodes?.filter(n => n.id !== id)?.forEach((node) => {\n                const alignment = getAlignment(draggedNode, node);\n                if (alignment) {\n                    // 过滤掉因为设置了 ALIGNMENT_THRESHOLD，而重复的辅助线\n                    if (alignment.vertical && !Object.keys(newAlignmentLines).some(key => key.includes(\"line-vertical\"))) {\n                        // 垂直线\n                        newAlignmentLines[`line-vertical-${node.id}`] = {\n                            left: alignment.x,\n                            top: 0,\n                            height: \"100%\"\n                        };\n                    }\n\n                    // 水平线\n                    if (alignment.horizontal && !Object.keys(newAlignmentLines).some(key => key.includes(\"line-horizontal\"))) {\n                        newAlignmentLines[`line-horizontal-${node.id}`] = {\n                            left: 0,\n                            top: alignment.y,\n                            width: \"100%\"\n                        };\n                    }\n                }\n            })\n\n            component.setAlignmentLines(newAlignmentLines)\n\n            component.setContext({\n                dragging: true,\n            });\n            break;\n        }\n\n        default:\n            break;\n    }\n}\n\n\nexport default DropTarget(\n    [NodeTypes.NORMAL_NODE, NodeTypes.TEMPLATE_NODE, NodeTypes.ANCHOR],\n    {\n        canDrop(props: ITopologyProps) {\n            return !props.readOnly;\n        },\n        hover: _.throttle(hover, 40),\n        drop(props: ITopologyProps, monitor, component: Topology) {\n            if (monitor.didDrop() || !component.$wrapper) {\n                return;\n            }\n            const item = monitor.getItem();\n            const type = monitor.getItemType();\n            const clientOffset = monitor.getDifferenceFromInitialOffset();\n            if (!clientOffset) {\n                return;\n            }\n\n            /**\n             * Get the mapping relationship between the id and position of all child nodes of the current dragging node\n             * @returns\n             */\n            const getChildPosMap = (idList: string[]) => {\n                const { lines, nodes } = props.data;\n                const curNodeList = nodes.filter(n => idList.indexOf(n.id) > -1);\n                let childPosMap = {};\n                curNodeList.forEach(curNode => {\n                    const dragChild = curNode.dragChild || isMatchKeyValue(curNode, 'dragChild', true);\n                    if (!dragChild) return null;\n                    const childIds = lines.filter(n => n.start.split('-')[0] === curNode.id).map(n => n.end);\n                    for (let childId of childIds) {\n                        let childNodeDom: HTMLElement = document.getElementById(`topology-node-${childId}`);\n                        if (!childNodeDom) return null;\n                        childPosMap[childId] = component.getNodePosition(monitor, childNodeDom, true);\n                    }\n                })\n                return childPosMap;\n            }\n\n            let position;\n            let nodeDom: HTMLElement = document.getElementById(`topology-node-${item.id}`);\n            if (nodeDom) {\n                position = component.getNodePosition(monitor, nodeDom);\n            } else {\n                position = computeCanvasPo(\n                    monitor.getSourceClientOffset(),\n                    component.$wrapper\n                )\n            }\n            let nodeProps: [string, IPosition][] = [[(item as ITopologyNode).id || item && item.data && item.data.id, position]];\n            const isOverlap = (nodeInfo: [string, IPosition][]) => {\n                return component.validateIsOverlap(nodeInfo);\n            }\n\n            switch (type) {\n                case NodeTypes.TEMPLATE_NODE:\n                    if (!item.data) {\n                        return;\n                    }\n                    const isMultiInfo = item.data.nodes && Array.isArray(item.data.nodes) && item.data.lines && Array.isArray(item.data.lines);\n                    /**\n                     * TODO：Here first render the newly added node, if it overlaps, delete the node\n                     * The main reason is that there is currently no good unified method to get the default width and height of the newly added nodes in the upper layer.\n                     */\n                    if (isMultiInfo) {\n                        nodeProps = [];\n                        const minX = Math.min(...item.data.nodes.map(n => n.position.x));\n                        const minY = Math.min(...item.data.nodes.map(n => n.position.y));\n                        const offset = {\n                            x: position.x - minX,\n                            y: position.y - minY\n                        }\n                        const selectedPositionList: [string, IPosition][] = [];\n                        item.data.nodes.forEach(n => {\n                            const newPosition = {\n                                x: n.position.x + offset.x,\n                                y: n.position.y + offset.y\n                            }\n                            selectedPositionList.push([n.id, newPosition]);\n                        })\n                        nodeProps = [...selectedPositionList, ...nodeProps];\n                        const positionMap = new Map(nodeProps);\n                        component.onChange({\n                            ...props.data,\n                            nodes: [...props.data.nodes, ...item.data.nodes.map(n => {\n                                const newPosition = positionMap.get(n.id);\n                                const p = newPosition ? newPosition : n.position;\n                                return { ...n, position: p  }\n                            })],\n                            lines: [...props.data.lines, ...item.data.lines ]\n                        }, ChangeType.ADD_NODE);\n                    } else {\n                        component.onChange({\n                            ...props.data,\n                            nodes: [...props.data.nodes, { ...item.data, position }],\n                        }, ChangeType.ADD_NODE);\n                    }\n                    if (isOverlap(nodeProps)) {\n                        component.onChange({\n                            ...props.data,\n                            nodes: [...props.data.nodes],\n                            lines: [...props.data.lines]\n                        }, ChangeType.ADD_NODE);\n                        props.overlapCallback && props.overlapCallback();\n                    };\n                    component.setAlignmentLines({});\n                    component.setContext({\n                        dragging: false,\n                    });\n                    break;\n                case NodeTypes.NORMAL_NODE:\n                    const targetNodeInfo = props.data.nodes.find(node => {\n                        return node.id === item.id;\n                    });\n                    const targetPosition = targetNodeInfo ? targetNodeInfo.position : null;\n                    if (targetPosition) {\n                        const offset = {\n                            x: position.x - targetPosition.x,\n                            y: position.y - targetPosition.y\n                        };\n                        const selectedIdSet = new Set(component.state.context.selectedData.nodes.map(n => n.id));\n                        const selectedPositionList: [string, IPosition][] = [];\n                        props.data.nodes.forEach(n => {\n                            if (selectedIdSet.has(n.id)) {\n                                const newPosition = {\n                                    x: n.position.x + offset.x,\n                                    y: n.position.y + offset.y\n                                }\n                                selectedPositionList.push([n.id, newPosition]);\n                            }\n                        });\n                        nodeProps = [...selectedPositionList, ...nodeProps]\n                    }\n                    if (isOverlap(nodeProps)) {\n                        props.overlapCallback && props.overlapCallback();\n                        component.showBoxSelection();\n                        return;\n                    };\n                    component.handleNodeDraw(nodeProps, getChildPosMap(nodeProps.map(n => n[0])));\n                    component.setAlignmentLines({});\n                    component.setContext({\n                        dragging: false,\n                    });\n                    // 存在移动动画时间\n                    setTimeout(() => {\n                        component.showBoxSelection();\n                    }, 210);\n                    break;\n                case NodeTypes.ANCHOR:\n                    component.handleLineDraw((item as { id: string }).id);\n                    break;\n                default:\n                    break;\n            }\n        },\n    },\n    connect => ({ connectDropTarget: connect.dropTarget() }),\n)(Topology);\n"],"mappings":"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"}]}