{"remainingRequest":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js??ref--6-oneOf-1-1!/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js??ref--6-oneOf-1-2!/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js??ref--5-0!/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/selection/index.tsx","dependencies":[{"path":"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/selection/index.tsx","mtime":1685428338212},{"path":"/Users/zhangtengjin/Desktop/byai/topology/package.json","mtime":1686043348216},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/cache-loader/dist/cjs.js","mtime":1684841559863},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js","mtime":1684841570187},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js","mtime":1684835071408},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js","mtime":1684841566493}],"contextDependencies":[],"result":["import _classCallCheck from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import classNames from'classnames';import React,{PureComponent}from'react';import{computeCanvasPo}from'../../utils';// import scrollIntoViewIfNeeded from 'scroll-into-view-if-needed';\nimport'./index.less';var Selection=/*#__PURE__*/function(_PureComponent){_inherits(Selection,_PureComponent);var _super=_createSuper(Selection);function Selection(props){var _this;_classCallCheck(this,Selection);_this=_super.call(this,props);_this.computeSize=function(){var _this$props=_this.props,xPos=_this$props.xPos,yPos=_this$props.yPos,wrapper=_this$props.wrapper;if(!xPos||!yPos||!wrapper){return;}var xPosList=xPos.split(',').map(function(d){return+d;});var yPosList=yPos.split(',').map(function(d){return+d;});var _computeCanvasPo=computeCanvasPo({x:xPosList[0],y:yPosList[0]},wrapper),initX=_computeCanvasPo.x,initY=_computeCanvasPo.y;var _computeCanvasPo2=computeCanvasPo({x:xPosList[1],y:yPosList[1]},wrapper),x=_computeCanvasPo2.x,y=_computeCanvasPo2.y;var minX=Math.min(initX,x);var minY=Math.min(initY,y);var width=Math.abs(x-initX);var height=Math.abs(y-initY);_this.setState({minX:minX,minY:minY,width:width,height:height});};_this.state={minX:0,minY:0,width:0,height:0};return _this;}_createClass(Selection,[{key:\"componentDidMount\",value:function componentDidMount(){this.computeSize();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.xPos!==this.props.xPos||prevProps.yPos!==this.props.yPos||prevProps.wrapper!==this.props.wrapper){this.computeSize();}}},{key:\"render\",value:function render(){var visible=this.props.visible;var _this$state=this.state,minX=_this$state.minX,minY=_this$state.minY,width=_this$state.width,height=_this$state.height;return/*#__PURE__*/React.createElement(\"div\",{className:classNames('byai-topology-selection',{visible:visible}),style:{left:\"\".concat(minX,\"px\"),top:\"\".concat(minY,\"px\"),width:\"\".concat(width,\"px\"),height:\"\".concat(height,\"px\")}},this.props.toolVisible&&this.props.renderTool&&/*#__PURE__*/React.createElement(\"div\",{key:\"box-selection\",ref:function ref(){// TODO: 还有点bug, 悬浮到其他节点时会触发\n// setTimeout(() => {\n//     node && scrollIntoViewIfNeeded(node, { behavior: 'smooth', scrollMode: 'if-needed', block: 'start'  })\n// }, 0)\n},onClick:this.props.onClick,className:classNames(\"byai-topology-selection-tool\"),onMouseUp:function onMouseUp(e){return e.stopPropagation();}},this.props.renderTool()));}}]);return Selection;}(PureComponent);export default Selection;",{"version":3,"names":["classNames","React","PureComponent","computeCanvasPo","Selection","_PureComponent","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","computeSize","_this$props","xPos","yPos","wrapper","xPosList","split","map","d","yPosList","_computeCanvasPo","x","y","initX","initY","_computeCanvasPo2","minX","Math","min","minY","width","abs","height","setState","state","_createClass","key","value","componentDidMount","componentDidUpdate","prevProps","render","visible","_this$state","createElement","className","style","left","concat","top","toolVisible","renderTool","ref","onClick","onMouseUp","e","stopPropagation"],"sources":["/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/selection/index.tsx"],"sourcesContent":["import classNames from 'classnames';\nimport React, { PureComponent } from 'react';\nimport { computeCanvasPo } from '../../utils';\n// import scrollIntoViewIfNeeded from 'scroll-into-view-if-needed';\nimport './index.less';\n\nexport interface ISelectionProps {\n    xPos?: string;\n    yPos?: string;\n    wrapper?: HTMLDivElement;\n    visible?: boolean;\n    renderTool?: () => React.ReactNode;\n    toolVisible?: boolean;\n    onClick?: React.MouseEventHandler<HTMLDivElement>;\n}\n\ninterface ISelectionState {\n    minX: number;\n    minY: number;\n    width: number;\n    height: number;\n}\n\nclass Selection extends PureComponent<ISelectionProps, ISelectionState> {\n    constructor(props: ISelectionProps) {\n        super(props);\n        this.state = {\n            minX: 0,\n            minY: 0,\n            width: 0,\n            height: 0,\n        };\n    }\n\n    componentDidMount() {\n        this.computeSize();\n    }\n\n    componentDidUpdate(prevProps: ISelectionProps) {\n        if (prevProps.xPos !== this.props.xPos || prevProps.yPos !== this.props.yPos || prevProps.wrapper !== this.props.wrapper) {\n            this.computeSize();\n        }\n    }\n\n    computeSize = () => {\n        const { xPos, yPos, wrapper } = this.props;\n        if (!xPos || !yPos || !wrapper) {\n            return;\n        }\n\n        const xPosList = xPos.split(',').map(d => +d);\n        const yPosList = yPos.split(',').map(d => +d);\n        const { x: initX, y: initY } = computeCanvasPo({ x: xPosList[0], y: yPosList[0] }, wrapper);\n        const { x, y } = computeCanvasPo({ x: xPosList[1], y: yPosList[1] }, wrapper);\n\n        const minX = Math.min(initX, x);\n        const minY = Math.min(initY, y);\n        const width = Math.abs(x - initX);\n        const height = Math.abs(y - initY);\n\n        this.setState({\n            minX,\n            minY,\n            width,\n            height,\n        });\n    }\n\n    render() {\n        const { visible } = this.props;\n        const {\n            minX, minY, width, height\n        } = this.state;\n        return (\n            <div\n                className={classNames('byai-topology-selection', {\n                    visible\n                })}\n                style={{\n                    left: `${minX}px`, top: `${minY}px`, width: `${width}px`, height: `${height}px`\n                }}\n            >\n                {this.props.toolVisible && this.props.renderTool\n            && (\n                <div\n                    key=\"box-selection\"\n                    ref={() => {\n                        // TODO: 还有点bug, 悬浮到其他节点时会触发\n                        // setTimeout(() => {\n                        //     node && scrollIntoViewIfNeeded(node, { behavior: 'smooth', scrollMode: 'if-needed', block: 'start'  })\n                        // }, 0)\n                    }}\n                    onClick={this.props.onClick}\n                    className={classNames(\"byai-topology-selection-tool\")}\n                    onMouseUp={e => e.stopPropagation()}\n                >\n                    {this.props.renderTool()}\n                </div>\n            )\n                }\n            </div>\n        );\n    }\n}\n\nexport default Selection;\n"],"mappings":"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"}]}